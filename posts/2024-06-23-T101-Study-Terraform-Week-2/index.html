<!DOCTYPE html>
<html lang="ko"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>[T101 4기] 테라폼 기본 사용법 2/3 | Sweet Little Bird</title>
<meta name="generator" content="Jekyll v4.3.3" />
<meta property="og:title" content="[T101 4기] 테라폼 기본 사용법 2/3" />
<meta property="og:locale" content="ko" />
<meta name="description" content="테라폼 기초 입문 실습 스터디 2주차 입니다. 1주차에 이어 테라폼의 기본 사용법에 대해 실습해보려 합니다. 이번 주에도 “테라폼으로 시작하는 IaC” 책을 기준으로 정리하였습니다." />
<meta property="og:description" content="테라폼 기초 입문 실습 스터디 2주차 입니다. 1주차에 이어 테라폼의 기본 사용법에 대해 실습해보려 합니다. 이번 주에도 “테라폼으로 시작하는 IaC” 책을 기준으로 정리하였습니다." />
<link rel="canonical" href="https://sweetlittlebird.github.io/posts/2024-06-23-T101-Study-Terraform-Week-2/" />
<meta property="og:url" content="https://sweetlittlebird.github.io/posts/2024-06-23-T101-Study-Terraform-Week-2/" />
<meta property="og:site_name" content="Sweet Little Bird" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-06-23T00:52:00+09:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="[T101 4기] 테라폼 기본 사용법 2/3" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-06-23T00:52:00+09:00","datePublished":"2024-06-23T00:52:00+09:00","description":"테라폼 기초 입문 실습 스터디 2주차 입니다. 1주차에 이어 테라폼의 기본 사용법에 대해 실습해보려 합니다. 이번 주에도 “테라폼으로 시작하는 IaC” 책을 기준으로 정리하였습니다.","headline":"[T101 4기] 테라폼 기본 사용법 2/3","mainEntityOfPage":{"@type":"WebPage","@id":"https://sweetlittlebird.github.io/posts/2024-06-23-T101-Study-Terraform-Week-2/"},"url":"https://sweetlittlebird.github.io/posts/2024-06-23-T101-Study-Terraform-Week-2/"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css">
  <link rel="stylesheet" href="/assets/main_dark.css" media="(prefers-color-scheme: dark)">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pretendard/1.3.9/static/pretendard.css" integrity="sha512-NzqTHTrO48HsIamogmIaVhTXoSgRF24Cn+ynrNYrFuKrY0AdDbmcNieiOHsQARS/r0Gax9VwV3/rVMHs3ipUlg==" crossorigin="anonymous" referrerpolicy="no-referrer" /><link type="application/atom+xml" rel="alternate" href="https://sweetlittlebird.github.io/feed.xml" title="Sweet Little Bird" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper">
<a class="site-title" rel="author" href="/">Sweet Little Bird</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger">
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewbox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"></path>
            </svg>
          </span>
        </label>

        <div class="trigger">
<a class="page-link" href="/about/">소개</a><a class="page-link" href="/posts/">글 목록</a>
</div>
      </nav>
</div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">[T101 4기] 테라폼 기본 사용법 2/3</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2024-06-23T00:52:00+09:00" itemprop="datePublished">2024년 06월 23일에 작성
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <div>
      목차
      <ul id="toc" class="section-nav">
<li class="toc-entry toc-h1"><a href="#%EB%93%A4%EC%96%B4%EA%B0%80%EB%A9%B0">들어가며</a></li>
<li class="toc-entry toc-h1">
<a href="#hcl-%EA%B3%84%EC%86%8D">HCL (계속)</a>
<ul>
<li class="toc-entry toc-h2">
<a href="#%ED%85%8C%EB%9D%BC%ED%8F%BC-%EB%B8%94%EB%A1%9D">테라폼 블록</a>
<ul>
<li class="toc-entry toc-h3"><a href="#data-%EB%B8%94%EB%A1%9D">data 블록</a></li>
<li class="toc-entry toc-h3"><a href="#variable-%EB%B8%94%EB%A1%9D">variable 블록</a></li>
<li class="toc-entry toc-h3"><a href="#locals-%EC%A7%80%EC%97%AD-%EA%B0%92-%EB%B8%94%EB%A1%9D">locals 지역 값 블록</a></li>
<li class="toc-entry toc-h3"><a href="#output-%EC%B6%9C%EB%A0%A5-%EA%B0%92-%EB%B8%94%EB%A1%9D">output 출력 값 블록</a></li>
</ul>
</li>
<li class="toc-entry toc-h2">
<a href="#%EB%B0%98%EB%B3%B5%EB%AC%B8-12">반복문 (1/2)</a>
<ul>
<li class="toc-entry toc-h3"><a href="#count-%EB%B0%98%EB%B3%B5%EB%AC%B8">count 반복문</a></li>
</ul>
</li>
<li class="toc-entry toc-h2">
<a href="#%EB%8F%84%EC%A0%84%EA%B3%BC%EC%A0%9C">도전과제</a>
<ul>
<li class="toc-entry toc-h3"><a href="#%EB%8F%84%EC%A0%84%EA%B3%BC%EC%A0%9C-1-%EB%A6%AC%EC%A0%84-%EB%82%B4%EC%97%90%EC%84%9C-%EC%82%AC%EC%9A%A9-%EA%B0%80%EB%8A%A5%ED%95%9C-%EA%B0%80%EC%9A%A9%EC%98%81%EC%97%AD-%EB%AA%A9%EB%A1%9D-%EA%B0%80%EC%A0%B8%EC%98%A4%EA%B8%B0%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%9C-vpc-%EB%A6%AC%EC%86%8C%EC%8A%A4-%EC%83%9D%EC%84%B1-%EC%8B%A4%EC%8A%B5-%EC%A7%84%ED%96%89">도전과제 1. 리전 내에서 사용 가능한 가용영역 목록 가져오기를 사용한 VPC 리소스 생성 실습 진행</a></li>
<li class="toc-entry toc-h3"><a href="#%EB%8F%84%EC%A0%84%EA%B3%BC%EC%A0%9C-2-%EC%9C%84-3%EA%B0%9C-%EC%BD%94%EB%93%9C-%ED%8C%8C%EC%9D%BC-%EB%82%B4%EC%9A%A9%EC%97%90-%EB%A6%AC%EC%86%8C%EC%8A%A4%EC%9D%98-%EC%9D%B4%EB%A6%84myvpc-mysubnet1-%EB%93%B1%EC%9D%84-%EB%B0%98%EB%93%9C%EC%8B%9C-%EA%BC%AD-%EC%9E%90%EC%8B%A0%EC%9D%98-%EB%8B%89%EB%84%A4%EC%9E%84%EC%9C%BC%EB%A1%9C-%EB%B3%80%EA%B2%BD%ED%95%B4%EC%84%9C-%EB%B0%B0%ED%8F%AC-%EC%8B%A4%EC%8A%B5%ED%95%B4%EB%B3%B4%EC%84%B8%EC%9A%94">도전과제 2. 위 3개 코드 파일 내용에 리소스의 이름(myvpc, mysubnet1 등)을 반드시! 꼭! 자신의 닉네임으로 변경해서 배포 실습해보세요!</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-entry toc-h1"><a href="#%EB%A7%88%EC%B9%98%EB%A9%B0">마치며</a></li>
</ul>
    </div>
    <ul id="toc" class="section-nav">
</ul>

<h1 id="들어가며">들어가며</h1>

<p>테라폼 기초 입문 실습 스터디 2주차 입니다.
1주차에 이어 테라폼의 기본 사용법에 대해 실습해보려 합니다.
이번 주에도 “테라폼으로 시작하는 IaC” 책을 기준으로 정리하였습니다.</p>

<blockquote>
  <p><img src="/assets/2024/20240614_terraform_book.jpg" alt="테라폼으로 시작하는 IaC"></p>

  <p><a href="https://product.kyobobook.co.kr/detail/S000202478097">테라폼으로 시작하는 IaC</a></p>
</blockquote>

<h1 id="hcl-계속">HCL (계속)</h1>

<p>지난주에 이어서 HCL(HashiCorp Configuration Language) 의 문법에 대해 알아보겠습니다.</p>

<h2 id="테라폼-블록">테라폼 블록</h2>

<h3 id="data-블록">data 블록</h3>

<ul>
  <li>데이터 소스는 테라폼으로 정의되지 않은 외부 리소스와 저장된 정보를 참조할때 사용합니다.</li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">data</code> 블록 선언 방법</p>

    <div class="language-tf highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>  <span class="k">data</span> <span class="s2">"&lt;프로바이더이름_리소스유형&gt;"</span> <span class="s2">"&lt;이름&gt;"</span> <span class="p">{</span>
      <span class="err">&lt;인수&gt;</span> <span class="p">=</span> <span class="err">&lt;값&gt;</span>
  <span class="p">}</span>
</code></pre></div>    </div>

    <p>이때 인수는 데이터 소스를 참조할때 사용할 인수이며 아래의 “데이터 소스 참조 방법”에서의 속성과는 다른 값입니다.
  이 인수로 참조된 데이터의 속성 값을 아래의 방법으로 가져올 수 있습니다.</p>
  </li>
  <li>
    <p>데이터 소스 참조 방법</p>

    <div class="language-tf highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>  <span class="c1"># 데이터 소스 참조</span>
  <span class="k">data</span><span class="err">.&lt;프로바이더이름</span><span class="nx">_</span><span class="err">리소스유형&gt;.&lt;이름&gt;.&lt;속성&gt;</span>  
</code></pre></div>    </div>
  </li>
  <li>
<code class="language-plaintext highlighter-rouge">data</code> 블록 사용 예시
    <ol>
      <li>현재 region에서 사용가능한 availability zone 정보를 가져오기
        <ul>
          <li>main.tf</li>
        </ul>

        <div class="language-tf highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> <span class="c1"># main.tf</span>
 <span class="k">data</span> <span class="s2">"aws_availability_zones"</span> <span class="s2">"available_zones"</span> <span class="p">{</span>
     <span class="nx">state</span> <span class="p">=</span> <span class="s2">"available"</span>   <span class="c1"># 현재 region에서 사용가능한 availability zone 정보를 가져오기</span>
 <span class="p">}</span>
</code></pre></div>        </div>

        <ul>
          <li>실행 결과 확인</li>
        </ul>

        <div class="language-sh highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> <span class="c"># main.tf 적용</span>
 <span class="nv">$ </span>terraform init <span class="o">&amp;&amp;</span> terraform plan <span class="o">&amp;&amp;</span> terraform apply <span class="nt">-auto-approve</span>
      
 <span class="c"># state 확인</span>
 <span class="nv">$ </span>terraform state list      
 <span class="c"># =&gt; data.aws_availability_zones.available_zones</span>
      
 <span class="c"># 테라폼 콘솔에서 확인</span>
 <span class="nv">$ </span>terraform console
 <span class="o">&gt;</span> <span class="c"># &lt;확인하고 싶은 속성&gt; </span>
 <span class="o">&gt;</span> data.aws_availability_zones.available_zones       <span class="c"># =&gt; ...</span>
 <span class="o">&gt;</span> data.aws_availability_zones.available_zones.id    <span class="c"># =&gt; "ap-northeast-2"</span>
 <span class="o">&gt;</span> data.aws_availability_zones.available_zones.names <span class="c"># =&gt; AZ 이름 목록...</span>
 <span class="o">&gt;</span> data.aws_availability_zones.available_zones.zone_ids <span class="c"># =&gt; AZ ID 목록...</span>
      
 <span class="c"># tip. echo &lt;확인하고 싶은 속성&gt; || terraform console 로 값 확인</span>
 <span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"data.aws_availability_zones.available_zones"</span> | terraform console     <span class="c"># =&gt; ...</span>
 <span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"data.aws_availability_zones.available_zones.id"</span> | terraform console   <span class="c"># =&gt; "ap-northeast-2"</span>
 <span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"data.aws_availability_zones.available_zones.names"</span> | terraform console <span class="c"># =&gt; AZ 이름 목록...</span>
 <span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"data.aws_availability_zones.available_zones.zone_ids"</span> | terraform console <span class="c"># =&gt; AZ ID 목록...</span>
 <span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"data.aws_availability_zones.available_zones.zone_ids[0]"</span> | terraform console <span class="c"># =&gt; "apne2-az1"</span>
</code></pre></div>        </div>
      </li>
      <li>로컬 파일의 내용 읽기
        <ul>
          <li>main.tf</li>
        </ul>

        <div class="language-tf highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> <span class="c1"># main.tf</span>
 <span class="k">resource</span> <span class="s2">"local_file"</span> <span class="s2">"abc"</span> <span class="p">{</span>
     <span class="nx">content</span>  <span class="p">=</span> <span class="s2">"Hello world!!"</span>
     <span class="nx">filename</span> <span class="p">=</span> <span class="s2">"</span><span class="k">${</span><span class="nx">path</span><span class="p">.</span><span class="k">module}</span><span class="s2">/abc.txt"</span>
 <span class="p">}</span>
        
 <span class="k">data</span> <span class="s2">"local_file"</span> <span class="s2">"abc"</span> <span class="p">{</span>
     <span class="nx">filename</span> <span class="p">=</span> <span class="nx">local_file</span><span class="p">.</span><span class="nx">abc</span><span class="p">.</span><span class="nx">filename</span>
 <span class="p">}</span>
        
 <span class="k">resource</span> <span class="s2">"local_file"</span> <span class="s2">"def"</span> <span class="p">{</span>
     <span class="nx">content</span>  <span class="p">=</span> <span class="k">data</span><span class="p">.</span><span class="nx">local_file</span><span class="p">.</span><span class="nx">abc</span><span class="p">.</span><span class="nx">content</span>
     <span class="nx">filename</span> <span class="p">=</span> <span class="s2">"</span><span class="k">${</span><span class="nx">path</span><span class="p">.</span><span class="k">module}</span><span class="s2">/def.txt"</span>
 <span class="p">}</span>
</code></pre></div>        </div>

        <ul>
          <li>
            <p>실행 결과 확인</p>

            <svg width="389pt" height="44pt" viewbox="0.00 0.00 389.00 44.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 40)">
  <title>G</title>
  <polygon fill="white" stroke="none" points="-4,4 -4,-40 385,-40 385,4 -4,4"></polygon>
  <!-- data.local_file.abc -->
  <g id="node1" class="node">
  <title>data.local_file.abc</title>
  <polygon fill="none" stroke="black" points="254,-36 130,-36 130,0 254,0 254,-36"></polygon>
  <text text-anchor="middle" x="192" y="-12.2" font-family="sans-serif" font-size="14.00">data.local_file.abc</text>
  </g>
  <!-- local_file.abc -->
  <g id="node2" class="node">
  <title>local_file.abc</title>
  <polygon fill="none" stroke="black" points="94,-36 0,-36 0,0 94,0 94,-36"></polygon>
  <text text-anchor="middle" x="47" y="-12.2" font-family="sans-serif" font-size="14.00">local_file.abc</text>
  </g>
  <!-- data.local_file.abc&#45;&gt;local_file.abc -->
  <g id="edge1" class="edge">
  <title>data.local_file.abc-&gt;local_file.abc</title>
  <path fill="none" stroke="black" d="M129.53,-18C121.59,-18 113.49,-18 105.62,-18"></path>
  <polygon fill="black" stroke="black" points="105.82,-14.5 95.82,-18 105.82,-21.5 105.82,-14.5"></polygon>
  </g>
  <!-- local_file.def -->
  <g id="node3" class="node">
  <title>local_file.def</title>
  <polygon fill="none" stroke="black" points="381,-36 290,-36 290,0 381,0 381,-36"></polygon>
  <text text-anchor="middle" x="335.5" y="-12.2" font-family="sans-serif" font-size="14.00">local_file.def</text>
  </g>
  <!-- local_file.def&#45;&gt;data.local_file.abc -->
  <g id="edge2" class="edge">
  <title>local_file.def-&gt;data.local_file.abc</title>
  <path fill="none" stroke="black" d="M289.73,-18C282.08,-18 273.96,-18 265.8,-18"></path>
  <polygon fill="black" stroke="black" points="265.81,-14.5 255.81,-18 265.81,-21.5 265.81,-14.5"></polygon>
  </g>
  </g>
  </svg>
          </li>
        </ul>

        <div class="language-sh highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> <span class="c"># main.tf 적용</span>
 <span class="nv">$ </span>terraform init <span class="o">&amp;&amp;</span> terraform plan <span class="o">&amp;&amp;</span> terraform apply <span class="nt">-auto-approve</span>
        
 <span class="c"># state 확인</span>
 <span class="nv">$ </span>terraform state list      
 <span class="c"># =&gt; data.local_file.abc</span>
 <span class="c">#    local_file.abc</span>
 <span class="c">#    local_file.def</span>
        
 <span class="c"># graph 확인</span>
 <span class="nv">$ </span>terraform graph <span class="o">&gt;</span> graph.dot
       
 <span class="c"># 데이터 소스 참조 확인</span>
 <span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"data.local_file.abc.content"</span> | terraform console
</code></pre></div>        </div>
      </li>
    </ol>
  </li>
</ul>

<h3 id="variable-블록">variable 블록</h3>

<ul>
  <li>변수(variable)블록은 인프라를 구성하는데 필요한 속성 값을 정의해 코드의 변경 없이 여러 인프라를 생성하는데 사용합니다.</li>
  <li>테라폼에서의 variable 블록을 입력 변수, 즉 input variable라 합니다.</li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">variable</code> 블록 선언 방법</p>

    <div class="language-tf highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>  <span class="k">variable</span> <span class="s2">"&lt;이름&gt;"</span> <span class="p">{</span>
      <span class="err">&lt;인수&gt;</span> <span class="p">=</span> <span class="err">&lt;값&gt;</span>
      <span class="err">&lt;메타변수&gt;</span> <span class="p">=</span> <span class="err">&lt;메타변수</span> <span class="err">값&gt;</span>
  <span class="p">}</span>
</code></pre></div>    </div>

    <ul>
      <li>
<code class="language-plaintext highlighter-rouge">source</code>, <code class="language-plaintext highlighter-rouge">version</code>, <code class="language-plaintext highlighter-rouge">providers</code> 등의 예약어는 변수이름으로 사용할 수 없습니다.</li>
    </ul>
  </li>
  <li>
    <p>변수 참조 방법</p>

    <div class="language-tf highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>  <span class="c1"># 변수 참조</span>
  <span class="kd">var</span><span class="err">.&lt;이름&gt;</span>
  
  <span class="c1"># 배열인 경우 [&lt;인덱스&gt;] 로 참조</span>
  <span class="kd">var</span><span class="err">.&lt;이름&gt;</span><span class="p">[</span><span class="err">&lt;인덱스&gt;</span><span class="p">]</span>
  
  <span class="c1"># 배열의 10번째 항목 참조 예시</span>
  <span class="kd">var</span><span class="err">.&lt;이름&gt;</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span>  
</code></pre></div>    </div>
  </li>
</ul>

<h4 id="variable-블록에서-사용-가능한-메타변수">variable 블록에서 사용 가능한 메타변수</h4>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">variable</code> 블록에서는 다음의 메타변수를 사용 가능합니다.</li>
</ul>

<table>
  <thead>
    <tr>
      <th>메타변수</th>
      <th>설명</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>default</td>
      <td>기본값을 지정합니다. 기본값도 없고, 다른 방법들로 지정되지 않으면 대화식으로 사용자에게 묻습니다.</td>
    </tr>
    <tr>
      <td>type</td>
      <td>변수 유형을 지정합니다.</td>
    </tr>
    <tr>
      <td>description</td>
      <td>입력변수의 설명을 기입합니다.</td>
    </tr>
    <tr>
      <td>validation</td>
      <td>변수의 제약 조건을 부여하고 유효성 검사 규칙을 정의합니다. <a href="https://honglab.tistory.com/217">참고</a>
</td>
    </tr>
    <tr>
      <td>sensitive</td>
      <td>비밀번호 등의 민감한 변수임을 표시하고 출력문에서 값 노출을 제한합니다. <a href="https://daaa0555.tistory.com/371">참고</a>
</td>
    </tr>
    <tr>
      <td>nullable</td>
      <td>변수에 값이 없어도 됨을 지정합니다.</td>
    </tr>
  </tbody>
</table>

<h4 id="입력-변수-유형">입력 변수 유형</h4>

<table>
  <thead>
    <tr>
      <th>유형</th>
      <th>설명</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>string</td>
      <td>문자열을 나타냅니다.</td>
    </tr>
    <tr>
      <td>number</td>
      <td>숫자를 나타냅니다.</td>
    </tr>
    <tr>
      <td>bool</td>
      <td>true, false의 불리언 값을 나타냅니다.</td>
    </tr>
    <tr>
      <td>list(&lt;유형&gt;)유형&gt;</td>
      <td>리스트를 나타냅니다.</td>
    </tr>
    <tr>
      <td>map(&lt;유형&gt;)유형&gt;</td>
      <td>맵을 나타냅니다.</td>
    </tr>
    <tr>
      <td>set(&lt;유형&gt;)유형&gt;</td>
      <td>집합을 나타냅니다.</td>
    </tr>
    <tr>
      <td>object({&lt;인수 이름=""&gt;=&lt;유형&gt;, ...})유형&gt;인수&gt;</td>
      <td>객체를 나타냅니다.</td>
    </tr>
    <tr>
      <td>tuple([&lt;유형&gt;, ...])유형&gt;</td>
      <td>튜플을 나타냅니다.</td>
    </tr>
  </tbody>
</table>

<ul>
  <li>입력 변수 사용 예시
    <ol>
      <li>
<code class="language-plaintext highlighter-rouge">number</code> 변수 예시
        <div class="language-tf highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>  <span class="k">variable</span> <span class="s2">"number"</span> <span class="p">{</span>
   <span class="nx">type</span>    <span class="p">=</span> <span class="nx">number</span>
   <span class="nx">default</span> <span class="p">=</span> <span class="mi">10</span>
  <span class="p">}</span>
</code></pre></div>        </div>
      </li>
      <li>
<code class="language-plaintext highlighter-rouge">list</code> 변수 예시
        <div class="language-tf highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>  <span class="k">variable</span> <span class="s2">"list"</span> <span class="p">{</span>
   <span class="nx">type</span>    <span class="p">=</span> <span class="nx">list</span>
   <span class="nx">default</span> <span class="p">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s2">"two"</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
  <span class="p">}</span>
</code></pre></div>        </div>
      </li>
      <li>
<code class="language-plaintext highlighter-rouge">list</code>의 값으로 number로 받는 조건 결합 예시
        <div class="language-tf highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>  <span class="k">variable</span> <span class="s2">"list"</span> <span class="p">{</span>
   <span class="nx">type</span>        <span class="p">=</span> <span class="nx">list</span><span class="p">(</span><span class="nx">number</span><span class="p">)</span>
   <span class="nx">default</span>     <span class="p">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
   <span class="c1"># default = [1, "two", 3] 과 같이 지정된 number 타입이 아닌 경우 오류 발생       </span>
  <span class="p">}</span>
</code></pre></div>        </div>
      </li>
      <li>모든 값이 string 인 map 예시
        <div class="language-tf highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>  <span class="k">variable</span> <span class="s2">"map"</span> <span class="p">{</span>
   <span class="nx">type</span>    <span class="p">=</span> <span class="nx">map</span><span class="p">(</span><span class="nx">string</span><span class="p">)</span>
   <span class="nx">default</span> <span class="p">=</span> <span class="p">{</span>
       <span class="nx">key1</span> <span class="p">=</span> <span class="s2">"value1"</span>
       <span class="nx">key2</span> <span class="p">=</span> <span class="s2">"value2"</span>
   <span class="p">}</span>
  <span class="p">}</span>
</code></pre></div>        </div>
      </li>
      <li>
<code class="language-plaintext highlighter-rouge">object</code> 변수를 사용하여 복잡한 구조적 유형 (structural type) 작성 예시
        <div class="language-tf highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>  <span class="k">variable</span> <span class="s2">"object_example"</span> <span class="p">{</span>
   <span class="nx">type</span> <span class="p">=</span> <span class="nx">object</span><span class="p">({</span>
       <span class="nx">name</span>    <span class="p">=</span> <span class="nx">string</span>
       <span class="nx">age</span>     <span class="p">=</span> <span class="nx">number</span>
       <span class="nx">tags</span>    <span class="p">=</span> <span class="nx">list</span><span class="p">(</span><span class="nx">string</span><span class="p">)</span>
       <span class="nx">enabled</span> <span class="p">=</span> <span class="nx">bool</span>
   <span class="p">})</span>
        
   <span class="nx">default</span> <span class="p">=</span> <span class="p">{</span>
       <span class="nx">name</span>    <span class="p">=</span> <span class="s2">"value1"</span>
       <span class="nx">age</span>     <span class="p">=</span> <span class="mi">42</span>
       <span class="nx">tags</span>    <span class="p">=</span> <span class="p">[</span><span class="s2">"a"</span><span class="p">,</span> <span class="s2">"b"</span><span class="p">,</span> <span class="s2">"c"</span><span class="p">]</span>
       <span class="nx">enabled</span> <span class="p">=</span> <span class="kc">true</span>
   <span class="p">}</span>
  <span class="p">}</span> 
</code></pre></div>        </div>
      </li>
    </ol>
  </li>
</ul>

<h4 id="유효성-검사">유효성 검사</h4>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">variable</code> 선언시 변수 타입 이외에도 사용자 지정 유효성 검사를 추가할 수 있습니다.</li>
  <li>
    <p>유효성 검사 작성 방법</p>

    <div class="language-tf highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>  <span class="k">variable</span> <span class="s2">"image_id"</span> <span class="p">{</span>
    <span class="nx">type</span>        <span class="p">=</span> <span class="nx">string</span>
    <span class="nx">description</span> <span class="p">=</span> <span class="s2">"The id of the machine image (AMI) to use for the server."</span>
    
    <span class="nx">validation</span> <span class="p">{</span>
      <span class="nx">condition</span>     <span class="p">=</span> <span class="nx">length</span><span class="p">(</span><span class="kd">var</span><span class="p">.</span><span class="nx">image_id</span><span class="p">)</span> <span class="err">&gt;</span> <span class="mi">4</span>    <span class="c1"># true 또는 false를 반환하는 규칙 </span>
      <span class="nx">error_message</span> <span class="p">=</span> <span class="s2">"The image_id value must exceed 4."</span> <span class="c1"># false일 때 출력할 오류 메시지</span>
    <span class="p">}</span>
    
    <span class="nx">validation</span> <span class="p">{</span>
      <span class="nx">condition</span>     <span class="p">=</span> <span class="nx">can</span><span class="p">(</span><span class="nx">regex</span><span class="p">(</span><span class="s2">"^ami-"</span><span class="p">,</span> <span class="kd">var</span><span class="p">.</span><span class="nx">image_id</span><span class="p">))</span>  <span class="c1"># 정규 표현식을 사용한 예시</span>
      <span class="nx">error_message</span> <span class="p">=</span> <span class="s2">"The image_id value must starting with </span><span class="se">\"</span><span class="s2">ami-</span><span class="se">\"</span><span class="s2">."</span>
    <span class="p">}</span>
  <span class="p">}</span>
</code></pre></div>    </div>

    <ul>
      <li>
<code class="language-plaintext highlighter-rouge">variable</code> 블록 내부에 <code class="language-plaintext highlighter-rouge">validation</code> 블록을 넣고, 그 안에 <code class="language-plaintext highlighter-rouge">condition</code>과 <code class="language-plaintext highlighter-rouge">error_message</code>를 지정합니다.</li>
      <li>
<code class="language-plaintext highlighter-rouge">condition</code> : 유효성 검사 조건을 지정합니다.</li>
      <li>
<code class="language-plaintext highlighter-rouge">error_message</code> : 조건이 만족하지 않을 때 출력할 오류 메시지를 지정합니다.</li>
      <li>확인
        <ul>
          <li>아래와 같이 조건에 맞지 않는 ami 입력시 유효성 검사를 만족하지 못하여 오류 메시지가 출력되는것을 확인할 수 있습니다.
            <div class="language-sh highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>  <span class="nv">$ </span>terraform plan
  <span class="c"># =&gt; var.image_id</span>
  <span class="c">#      The id of the machine image (AMI) to use for the server.</span>
  <span class="c">#    </span>
  <span class="c">#      Enter a value: ami</span>
  <span class="c">#    ...</span>
  <span class="c">#    </span>
  <span class="c">#    The image_id value must exceed 4.</span>
  <span class="c">#    </span>
  <span class="c">#    This was checked by the validation rule at main.tf:5,7-17.</span>
  <span class="c">#</span>
  <span class="c">#    ...    </span>
  <span class="c">#    </span>
  <span class="c">#    The image_id value must starting with "ami-".</span>
  <span class="c">#    </span>
  <span class="c">#    This was checked by the validation rule at main.tf:10,7-17.</span>
</code></pre></div>            </div>
          </li>
          <li>유효성 검사 조건을 만족하는 ami-1234 입력시 정상적으로 실행됩니다.
            <div class="language-sh highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>  <span class="nv">$ </span>terraform plan
  <span class="c"># =&gt; var.image_id</span>
  <span class="c">#    The id of the machine image (AMI) to use for the server.</span>
  <span class="c">#    </span>
  <span class="c">#    Enter a value: ami-1234</span>
  <span class="c">#    </span>
  <span class="c">#    local_file.abc: Refreshing state... [id=3ee66cf7a43f216ff7060c2bd85758424f7f18b3]</span>
  <span class="c">#    </span>
  <span class="c">#    No changes. Your infrastructure matches the configuration.</span>
  <span class="c">#    </span>
  <span class="c">#    Terraform has compared your real infrastructure against your configuration and found no differences, so no changes are needed.        </span>
</code></pre></div>            </div>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h4 id="sensitive-메타변수를-사용한-민감한-변수값-처리">sensitive 메타변수를 사용한 민감한 변수값 처리</h4>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">sensitive = true</code>를 <code class="language-plaintext highlighter-rouge">variable</code> 블록에 넣어서 해당 변수가 민감한 값을 갖고 있음을 지정할 수 있습니다.</li>
  <li>
    <p>민감한 변수값은 출력문에서 노출되지 않고 <code class="language-plaintext highlighter-rouge">(sensitive value)</code> 라는 내용으로 감춰집니다.</p>

    <div class="language-tf highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>  <span class="c1"># main.tf</span>
  <span class="k">variable</span> <span class="s2">"my_password"</span> <span class="p">{</span>
      <span class="nx">default</span> <span class="p">=</span> <span class="s2">"supersecret"</span>
      <span class="nx">sensitive</span> <span class="p">=</span> <span class="kc">true</span>
  <span class="p">}</span> 
    
  <span class="k">resource</span> <span class="s2">"local_file"</span> <span class="s2">"abc"</span> <span class="p">{</span>
    <span class="nx">content</span>  <span class="p">=</span> <span class="kd">var</span><span class="p">.</span><span class="nx">my_password</span>
    <span class="nx">filename</span> <span class="p">=</span> <span class="s2">"</span><span class="k">${</span><span class="nx">path</span><span class="p">.</span><span class="k">module}</span><span class="s2">/abc.txt"</span>
  <span class="p">}</span>
</code></pre></div>    </div>

    <ul>
      <li>확인
        <div class="language-sh highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>  <span class="c"># 1. terraform apply 실행시 my_password 변수값이 민감한 값으로 처리되어 출력됩니다.</span>
  <span class="nv">$ </span>terraform apply <span class="nt">--auto-approve</span>
  <span class="c"># =&gt; ...</span>
  <span class="c">#          + content              = (sensitive value)</span>
  <span class="c">#    ...</span>
      
  <span class="c"># 2. terraform console로 확인시에도 민감한 값으로 필터링 되어 출력됩니다.</span>
  <span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"local_file.abc.content"</span> | terraform console
  <span class="c"># =&gt; (sensitive value)</span>
      
  <span class="c"># 3. 파일 내용은 실제 값으로 들어갑니다.</span>
  <span class="nv">$ </span><span class="nb">cat </span>abc.txt 
  <span class="c"># =&gt; supersecret</span>
      
  <span class="c"># 4. terraform.tfstate 파일은 실제값이 들어가 있습니다. .tfstate 파일을 안전하게 관리해야 할 필요가 있습니다.</span>
  <span class="nv">$ </span><span class="nb">cat </span>terraform.tfstate| <span class="nb">grep</span> <span class="s2">"content"</span>
  <span class="c"># =&gt; "content": "supersecret",</span>
</code></pre></div>        </div>
        <ul>
          <li>
<code class="language-plaintext highlighter-rouge">terraform.tfstate</code> 에서는 sensitive 값이 노출되므로 주의해야 합니다. <code class="language-plaintext highlighter-rouge">terraform.tfstate</code> 파일을 안전하게 관리하는 방법은 다음의 방법 등이 있습니다.
            <ol>
              <li>AWS S3 등의 외부 스토리지에 저장하고, 권한을 제한</li>
              <li>민감한 정보를 <code class="language-plaintext highlighter-rouge">variable</code>를 사용하지 않고 다른 방법으로 (예) 파일 등) 넘기거나, 일시적으로 사용하고 즉시 변경할 수 있는 경우 사용</li>
              <li>민감한 정보는 Terraform에 넘길때 암호화 하여 사용하고, provisioning시 복호화하여 사용</li>
            </ol>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h4 id="변수-입력-방식과-우선-순위">변수 입력 방식과 우선 순위</h4>

<ul>
  <li>변수 입력 방식은 다음과 같습니다. 아래로 갈 수록 우선순위가 높아집니다.
    <ol>
      <li>실행 후 대화식 입력
        <div class="language-sh highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> <span class="nv">$ </span>terraform apply <span class="nt">-auto-approve</span>
 <span class="c"># =&gt; var.my_var</span>
 <span class="c">#    Enter a value: abcd</span>
      
 <span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"local_file.abc.content"</span> | terraform console
 <span class="c"># =&gt; "abcd"</span>
</code></pre></div>        </div>
      </li>
      <li>
<code class="language-plaintext highlighter-rouge">variable</code> 블록에 <code class="language-plaintext highlighter-rouge">default</code>로 지정된 값
        <ul>
          <li>
<code class="language-plaintext highlighter-rouge">main.tf</code> 작성
            <div class="language-tf highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>  <span class="c1"># main.tf</span>
  <span class="k">variable</span> <span class="s2">"my_var"</span> <span class="p">{</span>
      <span class="nx">default</span> <span class="p">=</span> <span class="s2">"default value"</span>
  <span class="p">}</span>
</code></pre></div>            </div>
          </li>
          <li>실행
            <div class="language-sh highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>  <span class="nv">$ </span>terraform apply <span class="nt">-auto-approve</span>
  <span class="c"># =&gt; ...</span>
  <span class="c"># =&gt; Apply complete! Resources: 1 added, 0 changed, 1 destroyed.</span>
         
  <span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"local_file.abc.content"</span> | terraform console
  <span class="c"># =&gt; "default value"</span>
</code></pre></div>            </div>
          </li>
        </ul>
      </li>
      <li>환경 변수로 입력
        <div class="language-sh highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> <span class="nv">$ </span><span class="nb">export </span><span class="nv">TF_VAR_my_var</span><span class="o">=</span><span class="s2">"환경변수"</span>
 <span class="nv">$ </span>terraform apply <span class="nt">-auto-approve</span>
 <span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"local_file.abc.content"</span> | terraform console
 <span class="c"># =&gt; "환경변수"</span>
</code></pre></div>        </div>
      </li>
      <li>
<code class="language-plaintext highlighter-rouge">terraform.tfvars</code> 파일을 통해 변수 파일로 입력
        <div class="language-sh highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> <span class="nv">$ </span><span class="nb">echo</span> <span class="s1">'my_var = "terraform.tfvars 값"'</span> <span class="o">&gt;</span> terraform.tfvars
 <span class="nv">$ </span>terraform apply <span class="nt">-auto-approve</span>
 <span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"local_file.abc.content"</span> | terraform console
 <span class="c"># =&gt; "terraform.tfvars 값"</span>
</code></pre></div>        </div>
      </li>
      <li>
<code class="language-plaintext highlighter-rouge">terraform.tfvars.json</code> 파일을 통해 변수 파일로 입력
        <div class="language-sh highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> <span class="nv">$ </span><span class="nb">echo</span> <span class="s1">'{ "my_var": "terraform.tfvars.json 값" }'</span> <span class="o">&gt;</span> terraform.tfvars.json
 <span class="nv">$ </span>terraform apply <span class="nt">-auto-approve</span>
 <span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"local_file.abc.content"</span> | terraform console
 <span class="c"># =&gt; "terraform.tfvars.json 값"</span>
</code></pre></div>        </div>
      </li>
      <li>
<code class="language-plaintext highlighter-rouge">*.auto.tfvars</code> 또는 <code class="language-plaintext highlighter-rouge">*.auto.tfvars.json</code> 을 통해 변수 파일로 입력
        <ul>
          <li>단, 파일명의 정렬 순서에 따라 <code class="language-plaintext highlighter-rouge">*.auto.tfvars</code> 파일간의 우선순위기 적용됩니다.</li>
        </ul>

        <div class="language-sh highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> <span class="nv">$ </span><span class="nb">echo</span> <span class="s1">'my_var = "eeee.auto.tfvars 값"'</span> <span class="o">&gt;</span> eeee.auto.tfvars
 <span class="nv">$ </span>terraform apply <span class="nt">-auto-approve</span>
 <span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"local_file.abc.content"</span> | terraform console
 <span class="c"># =&gt; "eeee.auto.tfvars 값"</span>

 <span class="nv">$ </span><span class="nb">echo</span> <span class="s1">'my_var = "zzzz.auto.tfvars 값"'</span> <span class="o">&gt;</span> zzzz.auto.tfvars
 <span class="nv">$ </span>terraform apply <span class="nt">-auto-approve</span>
 <span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"local_file.abc.content"</span> | terraform console
 <span class="c"># =&gt; "zzzz.auto.tfvars 값"</span>

 <span class="nv">$ </span><span class="nb">echo</span> <span class="s1">'my_var = "aaaa.auto.tfvars 값"'</span> <span class="o">&gt;</span> aaaa.auto.tfvars
 <span class="nv">$ </span>terraform apply <span class="nt">-auto-approve</span>
 <span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"local_file.abc.content"</span> | terraform console
 <span class="c"># =&gt; "zzzz.auto.tfvars 값"</span>
</code></pre></div>        </div>
        <ul>
          <li>위의 예제에서 보는것과 같이 정렬 순서에서 뒤로 갈 수록 우선순위가 높아집니다. z가 a나 e 보다 뒤이기 때문에 zzzz.auto.tfvars 값이 우선하게 적용됩니다.</li>
        </ul>
      </li>
      <li>
<code class="language-plaintext highlighter-rouge">terraform apply</code> 시 <code class="language-plaintext highlighter-rouge">-var</code> 또는 <code class="language-plaintext highlighter-rouge">-var-file</code>로 파일 지정 명령행 인수 사용
        <div class="language-sh highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> <span class="nv">$ </span>terraform apply <span class="nt">-auto-approve</span> <span class="nt">-var</span><span class="o">=</span><span class="s1">'my_var=명령행 인수 값'</span> <span class="nt">-var</span><span class="o">=</span><span class="s2">"addtional_var=추가 변수 값"</span>
 <span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"local_file.abc.content"</span> | terraform console
 <span class="c"># =&gt; "명령행 인수 값"</span>
     
 <span class="nv">$ </span><span class="nb">echo</span> <span class="s1">'my_var="-var-file 값"'</span> <span class="o">&gt;</span> varfiletest.txt
 <span class="nv">$ </span>terraform apply <span class="nt">-auto-approve</span> <span class="nt">-var-file</span><span class="o">=</span>varfiletest.txt
 <span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"local_file.abc.content"</span> | terraform console
 <span class="c"># =&gt; "-var-file 값"</span>
</code></pre></div>        </div>
      </li>
    </ol>
  </li>
</ul>

<h3 id="locals-지역-값-블록">locals 지역 값 블록</h3>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">locals</code> 블록은 테라폼 코드 내에서 재사용 가능한 지역 변수를 정의할 때 사용합니다.</li>
  <li>
<code class="language-plaintext highlighter-rouge">variable</code> 과는 달리 선언된 모듈 내에서만 사용 가능하며, 실행시에 입력받을 수 없습니다.</li>
  <li>단점으로는 실제 값에 대한 추적이 어려워 질 수 있다는 점입니다.</li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">locals</code> 블록 선언 방법</p>

    <div class="language-tf highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>  <span class="nx">locals</span> <span class="p">{</span>
      <span class="err">&lt;인수&gt;</span> <span class="p">=</span> <span class="err">&lt;값&gt;</span>
  <span class="p">}</span>
</code></pre></div>    </div>

    <ul>
      <li>
<code class="language-plaintext highlighter-rouge">source</code>, <code class="language-plaintext highlighter-rouge">version</code>, <code class="language-plaintext highlighter-rouge">providers</code> 등의 예약어는 변수이름으로 사용할 수 없습니다.</li>
    </ul>
  </li>
  <li>
    <p>참조 방법</p>

    <div class="language-tf highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>  <span class="c1"># 변수 참조</span>
  <span class="kd">local</span><span class="err">.&lt;이름&gt;</span>
  
  <span class="c1"># 배열인 경우 [&lt;인덱스&gt;] 로 참조</span>
  <span class="kd">local</span><span class="err">.&lt;이름&gt;</span><span class="p">[</span><span class="err">&lt;인덱스&gt;</span><span class="p">]</span>
  
  <span class="c1"># 배열의 10번째 항목 참조 예시</span>
  <span class="kd">local</span><span class="err">.&lt;이름&gt;</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span>  
</code></pre></div>    </div>
  </li>
  <li>
<code class="language-plaintext highlighter-rouge">locals</code> 블록 사용 예시
    <ul>
      <li>
<code class="language-plaintext highlighter-rouge">main.tf</code> 작성
        <div class="language-tf highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>  <span class="c1"># main.tf</span>
  <span class="k">variable</span> <span class="s2">"prefix"</span> <span class="p">{</span>
      <span class="nx">type</span>    <span class="p">=</span> <span class="nx">string</span>
      <span class="nx">default</span> <span class="p">=</span> <span class="s2">"hello"</span>
  <span class="p">}</span>
    
  <span class="nx">locals</span> <span class="p">{</span>
      <span class="nx">name</span> <span class="p">=</span> <span class="s2">"terraform"</span>
      <span class="nx">content</span> <span class="p">=</span> <span class="s2">"</span><span class="k">${</span><span class="kd">var</span><span class="p">.</span><span class="nx">prefix</span><span class="k">}</span><span class="s2"> </span><span class="k">${</span><span class="kd">local</span><span class="p">.</span><span class="nx">name</span><span class="k">}</span><span class="s2">"</span>
      <span class="nx">my_info</span> <span class="p">=</span> <span class="p">{</span>
          <span class="nx">age</span> <span class="p">=</span> <span class="mi">20</span>
          <span class="nx">region</span> <span class="p">=</span> <span class="s2">"KR"</span>
      <span class="p">}</span>
      <span class="nx">my_nums</span> <span class="p">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
  <span class="p">}</span>
    
  <span class="nx">locals</span> <span class="p">{</span>
      <span class="nx">my_string</span> <span class="p">=</span> <span class="s2">"string </span><span class="k">${</span><span class="kd">local</span><span class="p">.</span><span class="nx">content</span><span class="k">}</span><span class="s2">"</span>
      <span class="c1"># content = "content2" # 위의 locals에 등록되어서 로컬변수명이 중복되어 오류가 발생합니다.    </span>
  <span class="p">}</span>
      
  <span class="k">resource</span> <span class="s2">"local_file"</span> <span class="s2">"abc"</span> <span class="p">{</span>
      <span class="nx">content</span>  <span class="p">=</span> <span class="kd">local</span><span class="p">.</span><span class="nx">content</span>
      <span class="nx">filename</span> <span class="p">=</span> <span class="s2">"</span><span class="k">${</span><span class="nx">path</span><span class="p">.</span><span class="k">module}</span><span class="s2">/abc.txt"</span>
  <span class="p">}</span>
</code></pre></div>        </div>
      </li>
      <li>실행 결과 확인
        <div class="language-sh highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>  <span class="nv">$ </span>terraform apply <span class="nt">-auto-approve</span>
        
  <span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"local_file.abc.content"</span> | terraform console
  <span class="c"># =&gt; "hello terraform"</span>
    
  <span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"local.my_string"</span> | terraform console
  <span class="c"># =&gt; "string hello terraform"</span>
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
</ul>

<h3 id="output-출력-값-블록">output 출력 값 블록</h3>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">output</code> 블록은 테라폼 코드 프로비저닝 수행 후 결과 속성 값을 확인하는 용도로 사용합니다.</li>
  <li>출력 값은 다음의 용도로 사용할 수 있습니다.
    <ul>
      <li>루트 모듈에서 사용자가 확인하고자 하는 특정 속성 출력</li>
      <li>자식 모듈의 특정값을 정의하고 루트 모듈에서 결과를 참조</li>
      <li>루트 모듈 간의 결과를 원격으로 읽기 위한 접근 요소</li>
    </ul>
  </li>
  <li>output 블록 선언 방법
    <div class="language-tf highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>  <span class="k">output</span> <span class="s2">"&lt;이름&gt;"</span> <span class="p">{</span>
      <span class="nx">value</span> <span class="p">=</span> <span class="err">&lt;값&gt;</span>
      <span class="err">&lt;메타변수&gt;</span> <span class="p">=</span> <span class="err">&lt;메타변수</span> <span class="err">값&gt;</span>
  <span class="p">}</span>
</code></pre></div>    </div>
  </li>
</ul>

<h4 id="output-블록에서-사용-가능한-메타변수">output 블록에서 사용 가능한 메타변수</h4>

<ul>
  <li>
    <p><code class="language-plaintext highlighter-rouge">output</code> 블록에서는 다음의 메타변수를 사용 가능합니다.</p>

    <table>
      <thead>
        <tr>
          <th>메타변수</th>
          <th>설명</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>description</td>
          <td>출력값의 설명을 기입합니다.</td>
        </tr>
        <tr>
          <td>sensitive</td>
          <td>비밀번호 등의 민감한 값임을 표시하고 출력문에서 값 노출을 제한합니다.</td>
        </tr>
        <tr>
          <td>depends_on</td>
          <td>value에 담길 값이 종속성이 있는 경우 지정하면 생성 순서가 조정됩니다.</td>
        </tr>
        <tr>
          <td>precondition</td>
          <td>출력전에 지정된 조건을 검증합니다.</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>
    <p>출력 값 사용 예시</p>
    <div class="language-tf highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>  <span class="c1"># main.tf</span>
  <span class="nx">locals</span> <span class="p">{</span>
    <span class="nx">content</span> <span class="p">=</span> <span class="s2">"local content"</span>
  <span class="p">}</span>
    
  <span class="k">resource</span> <span class="s2">"local_file"</span> <span class="s2">"abc"</span> <span class="p">{</span>
    <span class="nx">content</span>  <span class="p">=</span> <span class="s2">"</span><span class="k">${</span><span class="kd">local</span><span class="p">.</span><span class="nx">content</span><span class="k">}</span><span class="s2">"</span>
    <span class="nx">filename</span> <span class="p">=</span> <span class="s2">"</span><span class="k">${</span><span class="nx">path</span><span class="p">.</span><span class="k">module}</span><span class="s2">/abc.txt"</span>
  <span class="p">}</span>
    
  <span class="k">output</span> <span class="s2">"file_id"</span> <span class="p">{</span>
    <span class="nx">value</span> <span class="p">=</span> <span class="nx">local_file</span><span class="p">.</span><span class="nx">abc</span><span class="p">.</span><span class="nx">id</span>
    <span class="nx">depends_on</span> <span class="p">=</span> <span class="p">[</span> <span class="nx">local_file</span><span class="p">.</span><span class="nx">abc</span> <span class="p">]</span>
  <span class="p">}</span>
    
  <span class="k">output</span> <span class="s2">"file_abspath"</span> <span class="p">{</span>
    <span class="nx">value</span> <span class="p">=</span> <span class="nx">abspath</span><span class="p">(</span><span class="nx">local_file</span><span class="p">.</span><span class="nx">abc</span><span class="p">.</span><span class="nx">filename</span><span class="p">)</span>
    <span class="nx">description</span> <span class="p">=</span> <span class="s2">"파일의 절대 경로"</span>
  <span class="p">}</span>
    
  <span class="k">output</span> <span class="s2">"local_content"</span> <span class="p">{</span>
    <span class="nx">value</span> <span class="p">=</span> <span class="kd">local</span><span class="p">.</span><span class="nx">content</span>
    <span class="nx">sensitive</span> <span class="p">=</span> <span class="kc">true</span>
  <span class="p">}</span>
</code></pre></div>    </div>

    <ul>
      <li>실행 결과</li>
    </ul>

    <div class="language-tf highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>  <span class="nx">$</span> <span class="k">terraform</span> <span class="nx">apply</span> <span class="nx">-auto-approve</span>
  <span class="c1"># =&gt; ...</span>
  <span class="c1">#    Outputs:</span>
  <span class="c1">#    </span>
  <span class="c1">#    file_abspath = ".../week-2/mytest7-output/abc.txt"</span>
  <span class="c1">#    file_id = "094f587b52451d1d5f3ef42a921fc877d8b18c1b"</span>
  <span class="c1">#    local_content = &lt;sensitive&gt;</span>
</code></pre></div>    </div>
  </li>
</ul>

<hr>

<h2 id="반복문-12">반복문 (1/2)</h2>

<ul>
  <li>list 형태의 값 목록이나 Key-Value 형태의 맵을 항목 만큼 반복하여 인프라 구성 정의를 항목 개수만큼 반복적으로 작성하지 않고,
  반복문을 사용하여 간단하게 작성할 수 있습니다.</li>
  <li>테라폼의 HCL에는 <code class="language-plaintext highlighter-rouge">count</code>와 <code class="language-plaintext highlighter-rouge">for_each</code> 두 가지 반복문이 있습니다.</li>
  <li>이번 주차에는 <code class="language-plaintext highlighter-rouge">count</code> 반복문에 대해 알아보았습니다.</li>
</ul>

<h3 id="count-반복문">count 반복문</h3>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">count</code>는 프로그래밍 언어의 <code class="language-plaintext highlighter-rouge">for</code>문 처럼 정수값만큼 반복합니다.</li>
  <li>기본 적인 사용법은 아래와 같습니다.</li>
</ul>

<div class="language-tf highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">resource</span> <span class="s2">"&lt;프로바이더이름_리소스유형&gt;"</span> <span class="s2">"&lt;이름&gt;"</span> <span class="p">{</span>
    <span class="nx">count</span> <span class="p">=</span> <span class="err">&lt;반복횟수&gt;</span>
    <span class="nx">content</span> <span class="p">=</span> <span class="s2">"Index = </span><span class="k">${</span><span class="nx">count</span><span class="p">.</span><span class="nx">index</span><span class="k">}</span><span class="s2">"</span> <span class="c1"># count.index 로 현재 반복 인덱스를 참조</span>
<span class="p">}</span>
</code></pre></div></div>

<ul>
  <li>위의 코드에서 <code class="language-plaintext highlighter-rouge">count</code> 횟수 만큼 반복해서 resource나 모듈을 생성합니다.</li>
  <li>
<code class="language-plaintext highlighter-rouge">count</code>의 반복횟수 참고값은 <code class="language-plaintext highlighter-rouge">count.index</code>를 통해 확인할 수 있으며, 0부터 시작해서 1씩 증가합니다.</li>
  <li>사용 예제
    <div class="language-tf highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="c1"># main.tf</span>
<span class="k">variable</span> <span class="s2">"fruits"</span> <span class="p">{</span>
  <span class="nx">type</span> <span class="p">=</span> <span class="nx">list</span>
  <span class="nx">default</span> <span class="p">=</span> <span class="p">[</span><span class="s2">"apple"</span><span class="p">,</span> <span class="s2">"banana"</span><span class="p">,</span> <span class="s2">"kiwi"</span><span class="p">]</span>
<span class="p">}</span>
    
<span class="k">resource</span> <span class="s2">"local_file"</span> <span class="s2">"fruit_files"</span> <span class="p">{</span>
  <span class="nx">count</span> <span class="p">=</span> <span class="nx">length</span><span class="p">(</span><span class="kd">var</span><span class="p">.</span><span class="nx">fruits</span><span class="p">)</span>
  <span class="nx">filename</span> <span class="p">=</span> <span class="s2">"</span><span class="k">${</span><span class="nx">path</span><span class="p">.</span><span class="k">module}</span><span class="s2">/i_love_</span><span class="k">${</span><span class="kd">var</span><span class="p">.</span><span class="nx">fruits</span><span class="p">[</span><span class="nx">count</span><span class="p">.</span><span class="nx">index</span><span class="p">]</span><span class="k">}</span><span class="s2">.txt"</span>
  <span class="nx">content</span> <span class="p">=</span> <span class="s2">"I love </span><span class="k">${</span><span class="kd">var</span><span class="p">.</span><span class="nx">fruits</span><span class="p">[</span><span class="nx">count</span><span class="p">.</span><span class="nx">index</span><span class="p">]</span><span class="k">}</span><span class="s2">!"</span>
<span class="p">}</span>
</code></pre></div>    </div>
    <ul>
      <li>실행 결과
        <div class="language-tf highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="nx">$</span> <span class="k">terraform</span> <span class="nx">apply</span> <span class="nx">-auto-approve</span>
     
<span class="nx">$</span> <span class="nx">ls</span> <span class="nx">-1</span>
<span class="c1"># =&gt; i_love_apple.txt</span>
<span class="c1">#    i_love_banana.txt</span>
<span class="c1">#    i_love_kiwi.txt</span>
    
<span class="nx">$</span> <span class="nx">cat</span> <span class="nx">i_love_apple</span><span class="err">.</span><span class="nx">txt</span>
<span class="c1"># =&gt; I love apple!</span>
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
</ul>

<hr>

<h2 id="도전과제">도전과제</h2>

<h3 id="도전과제-1-리전-내에서-사용-가능한-가용영역-목록-가져오기를-사용한-vpc-리소스-생성-실습-진행">도전과제 1. 리전 내에서 사용 가능한 가용영역 목록 가져오기를 사용한 VPC 리소스 생성 실습 진행</h3>
<ul>
  <li>가용영역 목록을 가져와서 VPC를 만들고, 사용 가능한 첫번째 가용영역에 subnet을 만드는 실습을 진행하였습니다.</li>
  <li>소스
    <div class="language-tf highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="c1"># main.tf</span>
<span class="k">data</span> <span class="s2">"aws_availability_zones"</span> <span class="s2">"available"</span> <span class="p">{</span>
  <span class="nx">state</span> <span class="p">=</span> <span class="s2">"available"</span>
<span class="p">}</span>
  
<span class="k">resource</span> <span class="s2">"aws_vpc"</span> <span class="s2">"peter_vpc"</span> <span class="p">{</span>
  <span class="nx">cidr_block</span> <span class="p">=</span> <span class="s2">"10.0.0.0/16"</span>
  <span class="nx">tags</span> <span class="p">=</span> <span class="p">{</span>
    <span class="nx">Name</span> <span class="p">=</span> <span class="s2">"challenge1 vpc"</span>
  <span class="p">}</span>
<span class="p">}</span>
  
<span class="k">resource</span> <span class="s2">"aws_subnet"</span> <span class="s2">"peter_subnet"</span> <span class="p">{</span>
  <span class="nx">vpc_id</span> <span class="p">=</span> <span class="nx">aws_vpc</span><span class="p">.</span><span class="nx">peter_vpc</span><span class="p">.</span><span class="nx">id</span>
  <span class="nx">availability_zone</span> <span class="p">=</span> <span class="k">data</span><span class="p">.</span><span class="nx">aws_availability_zones</span><span class="p">.</span><span class="nx">available</span><span class="p">.</span><span class="nx">names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
  <span class="nx">cidr_block</span> <span class="p">=</span> <span class="s2">"10.0.1.0/24"</span>
  <span class="nx">tags</span> <span class="p">=</span> <span class="p">{</span>
    <span class="nx">Name</span> <span class="p">=</span> <span class="s2">"challenge1 subnet"</span>
  <span class="p">}</span>
<span class="p">}</span>
  
</code></pre></div>    </div>
  </li>
  <li>실행 결과
    <div class="language-sh highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>terraform apply <span class="nt">-auto-approve</span>
<span class="c"># =&gt; ...</span>
<span class="c">#    aws_vpc.peter_vpc: Creating...</span>
<span class="c">#    aws_vpc.peter_vpc: Creation complete after 1s [id=vpc-0e6762235c588581b]</span>
<span class="c">#    aws_subnet.peter_subnet: Creating...</span>
<span class="c">#    aws_subnet.peter_subnet: Creation complete after 0s [id=subnet-06888df37bc01ab4c]</span>
  
<span class="c"># 결과 확인</span>
<span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"aws_vpc.peter_vpc.id"</span> | terraform console
<span class="c"># =&gt; "vpc-0e6762235c588581b"</span>
<span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"aws_subnet.peter_subnet.id"</span> | terraform console
<span class="c"># =&gt; "subnet-06888df37bc01ab4c"</span>
</code></pre></div>    </div>
    <ul>
      <li>AWS 콘솔에서 VPC 생성 확인
<img src="/assets/2024/20240622_terraform_w2_vpc.png" alt="20240622_terraform_w2_vpc.png">
</li>
      <li>AWS 콘솔에서 Subnet 생성 확인
<img src="/assets/2024/20240622_terraform_w2_subnet.png" alt="20240622_terraform_w2_subnet.png">
</li>
    </ul>
  </li>
  <li>
    <p>그래프</p>

    <svg width="455pt" height="98pt" viewbox="0.00 0.00 454.75 98.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 94)">
<title>G</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-94 450.75,-94 450.75,4 -4,4"></polygon>
<!-- data.aws_availability_zones.available -->
<g id="node1" class="node">
<title>data.aws_availability_zones.available</title>
<polygon fill="none" stroke="black" points="240.25,-90 0,-90 0,-54 240.25,-54 240.25,-90"></polygon>
<text text-anchor="middle" x="120.12" y="-66.2" font-family="sans-serif" font-size="14.00">data.aws_availability_zones.available</text>
</g>
<!-- aws_subnet.peter_subnet -->
<g id="node2" class="node">
<title>aws_subnet.peter_subnet</title>
<polygon fill="none" stroke="black" points="446.75,-63 276.25,-63 276.25,-27 446.75,-27 446.75,-63"></polygon>
<text text-anchor="middle" x="361.5" y="-39.2" font-family="sans-serif" font-size="14.00">aws_subnet.peter_subnet</text>
</g>
<!-- aws_subnet.peter_subnet&#45;&gt;data.aws_availability_zones.available -->
<g id="edge1" class="edge">
<title>aws_subnet.peter_subnet-&gt;data.aws_availability_zones.available</title>
<path fill="none" stroke="black" d="M275.77,-54.56C268,-55.43 260.01,-56.33 251.96,-57.24"></path>
<polygon fill="black" stroke="black" points="251.59,-53.76 242.05,-58.36 252.38,-60.72 251.59,-53.76"></polygon>
</g>
<!-- aws_vpc.peter_vpc -->
<g id="node3" class="node">
<title>aws_vpc.peter_vpc</title>
<polygon fill="none" stroke="black" points="185.88,-36 54.38,-36 54.38,0 185.88,0 185.88,-36"></polygon>
<text text-anchor="middle" x="120.12" y="-12.2" font-family="sans-serif" font-size="14.00">aws_vpc.peter_vpc</text>
</g>
<!-- aws_subnet.peter_subnet&#45;&gt;aws_vpc.peter_vpc -->
<g id="edge2" class="edge">
<title>aws_subnet.peter_subnet-&gt;aws_vpc.peter_vpc</title>
<path fill="none" stroke="black" d="M275.77,-35.44C250.23,-32.56 222.36,-29.42 197.4,-26.6"></path>
<polygon fill="black" stroke="black" points="197.99,-23.15 187.66,-25.5 197.2,-30.1 197.99,-23.15"></polygon>
</g>
</g>
</svg>
  </li>
</ul>

<h3 id="도전과제-2-위-3개-코드-파일-내용에-리소스의-이름myvpc-mysubnet1-등을-반드시-꼭-자신의-닉네임으로-변경해서-배포-실습해보세요">도전과제 2. 위 3개 코드 파일 내용에 리소스의 이름(myvpc, mysubnet1 등)을 반드시! 꼭! 자신의 닉네임으로 변경해서 배포 실습해보세요!</h3>

<ul>
  <li>vpc.tf 생성
    <div class="language-tf highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="c1"># vpc.tf</span>
<span class="k">provider</span> <span class="s2">"aws"</span> <span class="p">{</span>
    <span class="nx">region</span> <span class="p">=</span> <span class="s2">"ap-northeast-2"</span>
<span class="p">}</span>
  
<span class="k">resource</span> <span class="s2">"aws_vpc"</span> <span class="s2">"peter_vpc"</span> <span class="p">{</span>
  <span class="nx">cidr_block</span> <span class="p">=</span> <span class="s2">"10.10.0.0/16"</span>
  <span class="nx">tags</span> <span class="p">=</span> <span class="p">{</span>
    <span class="nx">name</span> <span class="p">=</span> <span class="s2">"t101-study"</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>    </div>
    <ul>
      <li>실행
        <div class="language-sh highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>terraform init <span class="o">&amp;&amp;</span> terraform plan <span class="o">&amp;&amp;</span> terraform apply <span class="nt">-auto-approve</span>
<span class="c"># =&gt; ...</span>
<span class="c">#    Plan: 1 to add, 0 to change, 0 to destroy.</span>
<span class="c">#    aws_vpc.peter_vpc: Creating...</span>
<span class="c">#    aws_vpc.peter_vpc: Creation complete after 2s [id=vpc-0e1ad43009a8fe8fa]</span>
<span class="c">#    </span>
<span class="c">#    Apply complete! Resources: 1 added, 0 changed, 0 destroyed.</span>
    
<span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"aws_vpc.peter_vpc.id"</span> | terraform console
<span class="c"># =&gt; "vpc-0e1ad43009a8fe8fa"</span>
   
<span class="nv">$ </span>aws ec2 describe-vpcs <span class="nt">--filter</span> <span class="s1">'Name=isDefault,Values=false'</span> | jq
<span class="c"># =&gt; {</span>
<span class="c">#      "Vpcs": [</span>
<span class="c">#        {</span>
<span class="c">#          "CidrBlock": "10.10.0.0/16",</span>
<span class="c">#          "DhcpOptionsId": "dopt-0c264ef627294fd1f",</span>
<span class="c">#          "State": "available",</span>
<span class="c">#          "VpcId": "vpc-0e1ad43009a8fe8fa",</span>
<span class="c">#          "OwnerId": "654654550747",</span>
<span class="c">#          "InstanceTenancy": "default",</span>
<span class="c">#          "CidrBlockAssociationSet": [</span>
<span class="c">#            {</span>
<span class="c">#              "AssociationId": "vpc-cidr-assoc-0e9adafb317c75f4f",</span>
<span class="c">#              "CidrBlock": "10.10.0.0/16",</span>
<span class="c">#              "CidrBlockState": {</span>
<span class="c">#                "State": "associated"</span>
<span class="c">#              }</span>
<span class="c">#            }</span>
<span class="c">#          ],</span>
<span class="c">#          "IsDefault": false,</span>
<span class="c">#          "Tags": [</span>
<span class="c">#            {</span>
<span class="c">#              "Key": "name",</span>
<span class="c">#              "Value": "t101-study"</span>
<span class="c">#            }</span>
<span class="c">#          ]</span>
<span class="c">#        }</span>
<span class="c">#      ]</span>
<span class="c">#    }</span>
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
  <li>AWS 콘솔에서 VPC 생성정보 확인 : DNS 옵션값 확인
    <ul>
      <li>아래의 캡쳐와 같이 DNS hostnames는 Disabled, DNS resolution은 Enabled 된 것을 확인하였습니다.
<img src="/assets/2024/20240622_terraform_w2_c2_p1_1.png" alt="20240622_terraform_w2_c2_p1_1.png">
</li>
    </ul>
  </li>
  <li>vpc.tf의 DNS 옵션을 수정하여 두 DNS 옵션값을 enabled 로 변경
    <div class="language-tf highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="c1"># vpc.tf</span>
<span class="k">provider</span> <span class="s2">"aws"</span> <span class="p">{</span>
  <span class="nx">region</span> <span class="p">=</span> <span class="s2">"ap-northeast-2"</span>
<span class="p">}</span>
  
<span class="k">resource</span> <span class="s2">"aws_vpc"</span> <span class="s2">"peter_vpc"</span> <span class="p">{</span>
  <span class="nx">cidr_block</span> <span class="p">=</span> <span class="s2">"10.10.0.0/16"</span>
  <span class="nx">enable_dns_support</span> <span class="p">=</span> <span class="kc">true</span>   <span class="c1"># 추가</span>
  <span class="nx">enable_dns_hostnames</span> <span class="p">=</span> <span class="kc">true</span> <span class="c1"># 추가</span>
  <span class="nx">tags</span> <span class="p">=</span> <span class="p">{</span>
    <span class="nx">Name</span> <span class="p">=</span> <span class="s2">"t101-study"</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>    </div>
  </li>
  <li>수정된 vpc.tf 적용
    <div class="language-sh highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>terraform apply <span class="nt">-auto-approve</span>
</code></pre></div>    </div>
  </li>
  <li>AWS 콘솔에서 VPC 생성정보 확인 : DNS 옵션값 확인
    <ul>
      <li>아래와 같이 DNS hostnames 도 Enabled 되었습니다.
<img src="/assets/2024/20240622_terraform_w2_c2_p1_2.png" alt="20240622_terraform_w2_c2_p1_2.png">
</li>
    </ul>
  </li>
  <li>vpc.tf 코드 내용 수정 : 서브넷 2개 생성 추가
    <div class="language-tf highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="k">provider</span> <span class="s2">"aws"</span> <span class="p">{</span>
    <span class="nx">region</span> <span class="p">=</span> <span class="s2">"ap-northeast-2"</span>
<span class="p">}</span>
  
<span class="k">resource</span> <span class="s2">"aws_vpc"</span> <span class="s2">"peter_vpc"</span> <span class="p">{</span>
  <span class="nx">cidr_block</span> <span class="p">=</span> <span class="s2">"10.10.0.0/16"</span>
  <span class="nx">enable_dns_support</span> <span class="p">=</span> <span class="kc">true</span>
  <span class="nx">enable_dns_hostnames</span> <span class="p">=</span> <span class="kc">true</span>
  <span class="nx">tags</span> <span class="p">=</span> <span class="p">{</span>
    <span class="nx">Name</span> <span class="p">=</span> <span class="s2">"t101-study"</span>
  <span class="p">}</span>
<span class="p">}</span>
  
<span class="k">resource</span> <span class="s2">"aws_subnet"</span> <span class="s2">"peter_subnet1"</span> <span class="p">{</span>
  <span class="nx">vpc_id</span>     <span class="p">=</span> <span class="nx">aws_vpc</span><span class="p">.</span><span class="nx">peter_vpc</span><span class="p">.</span><span class="nx">id</span>
  <span class="nx">cidr_block</span> <span class="p">=</span> <span class="s2">"10.10.1.0/24"</span>
  
  <span class="nx">availability_zone</span> <span class="p">=</span> <span class="s2">"ap-northeast-2a"</span>
  
  <span class="nx">tags</span> <span class="p">=</span> <span class="p">{</span>
    <span class="nx">Name</span> <span class="p">=</span> <span class="s2">"t101-subnet1"</span>
  <span class="p">}</span>
<span class="p">}</span>
  
<span class="k">resource</span> <span class="s2">"aws_subnet"</span> <span class="s2">"peter_subnet2"</span> <span class="p">{</span>
  <span class="nx">vpc_id</span>     <span class="p">=</span> <span class="nx">aws_vpc</span><span class="p">.</span><span class="nx">peter_vpc</span><span class="p">.</span><span class="nx">id</span>
  <span class="nx">cidr_block</span> <span class="p">=</span> <span class="s2">"10.10.2.0/24"</span>
  
  <span class="nx">availability_zone</span> <span class="p">=</span> <span class="s2">"ap-northeast-2c"</span>
  
  <span class="nx">tags</span> <span class="p">=</span> <span class="p">{</span>
    <span class="nx">Name</span> <span class="p">=</span> <span class="s2">"t101-subnet2"</span>
  <span class="p">}</span>
<span class="p">}</span>
  
<span class="k">output</span> <span class="s2">"aws_vpc_id"</span> <span class="p">{</span>
  <span class="nx">value</span> <span class="p">=</span> <span class="nx">aws_vpc</span><span class="p">.</span><span class="nx">peter_vpc</span><span class="p">.</span><span class="nx">id</span>
<span class="p">}</span>
</code></pre></div>    </div>
    <ul>
      <li>실행 결과 확인
        <div class="language-sh highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>terraform apply <span class="nt">-auto-approve</span>
    
<span class="nv">$ </span>terraform state list
<span class="c"># =&gt; aws_subnet.peter_subnet1</span>
<span class="c">#    aws_subnet.peter_subnet2</span>
<span class="c">#    aws_vpc.peter_vpc</span>
    
<span class="nv">$ </span>terraform output
<span class="c"># =&gt; aws_vpc_id = "vpc-0e1ad43009a8fe8fa"</span>
    
<span class="nv">$ </span>terraform output aws_vpc_id
<span class="c"># =&gt; "vpc-0e1ad43009a8fe8fa"</span>
    
<span class="nv">$ </span>terraform output <span class="nt">-raw</span> aws_vpc_id
<span class="c"># =&gt; vpc-0e1ad43009a8fe8fa</span>
    
<span class="nv">$ VPCID</span><span class="o">=</span><span class="si">$(</span>terraform output <span class="nt">-raw</span> aws_vpc_id<span class="si">)</span>
    
<span class="nv">$ </span>aws ec2 describe-subnets <span class="nt">--filters</span> <span class="s2">"Name=vpc-id,Values=</span><span class="nv">$VPCID</span><span class="s2">"</span> <span class="nt">--output</span> table
</code></pre></div>        </div>
        <p><img src="/assets/2024/20240622_terraform_w2_c2_p1_3.png" alt="20240622_terraform_w2_c2_p1_3.png"></p>

        <p><code class="language-plaintext highlighter-rouge">terraform output</code> 시 <code class="language-plaintext highlighter-rouge">-raw</code> 옵션을 사용하면 “(따옴표) 없이 출력값만을 확인할 수 있습니다. 스크립트 작성시 유용할듯합니다.</p>
      </li>
      <li>
        <p>그래프</p>

        <svg width="354pt" height="98pt" viewbox="0.00 0.00 353.50 98.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 94)">
<title>G</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-94 349.5,-94 349.5,4 -4,4"></polygon>
<!-- aws_subnet.peter_subnet1 -->
<g id="node1" class="node">
<title>aws_subnet.peter_subnet1</title>
<polygon fill="none" stroke="black" points="345.5,-90 167.5,-90 167.5,-54 345.5,-54 345.5,-90"></polygon>
<text text-anchor="middle" x="256.5" y="-66.2" font-family="sans-serif" font-size="14.00">aws_subnet.peter_subnet1</text>
</g>
<!-- aws_vpc.peter_vpc -->
<g id="node3" class="node">
<title>aws_vpc.peter_vpc</title>
<polygon fill="none" stroke="black" points="131.5,-63 0,-63 0,-27 131.5,-27 131.5,-63"></polygon>
<text text-anchor="middle" x="65.75" y="-39.2" font-family="sans-serif" font-size="14.00">aws_vpc.peter_vpc</text>
</g>
<!-- aws_subnet.peter_subnet1&#45;&gt;aws_vpc.peter_vpc -->
<g id="edge1" class="edge">
<title>aws_subnet.peter_subnet1-&gt;aws_vpc.peter_vpc</title>
<path fill="none" stroke="black" d="M167.2,-59.37C159.21,-58.23 151.16,-57.07 143.28,-55.95"></path>
<polygon fill="black" stroke="black" points="143.78,-52.48 133.38,-54.53 142.79,-59.41 143.78,-52.48"></polygon>
</g>
<!-- aws_subnet.peter_subnet2 -->
<g id="node2" class="node">
<title>aws_subnet.peter_subnet2</title>
<polygon fill="none" stroke="black" points="345.5,-36 167.5,-36 167.5,0 345.5,0 345.5,-36"></polygon>
<text text-anchor="middle" x="256.5" y="-12.2" font-family="sans-serif" font-size="14.00">aws_subnet.peter_subnet2</text>
</g>
<!-- aws_subnet.peter_subnet2&#45;&gt;aws_vpc.peter_vpc -->
<g id="edge2" class="edge">
<title>aws_subnet.peter_subnet2-&gt;aws_vpc.peter_vpc</title>
<path fill="none" stroke="black" d="M167.2,-30.63C159.21,-31.77 151.16,-32.93 143.28,-34.05"></path>
<polygon fill="black" stroke="black" points="142.79,-30.59 133.38,-35.47 143.78,-37.52 142.79,-30.59"></polygon>
</g>
</g>
</svg>
      </li>
    </ul>
  </li>
  <li>이후 다음의 작업을 추가 적용 하였습니다.
    <ul>
      <li>IGW 인터넷 게이트웨이 추가</li>
      <li>IGW 인터넷 게이트웨이로 전달하는 디폴트 라우팅 정보 추가</li>
      <li>보안그룹/EC2 배포</li>
    </ul>
  </li>
  <li>최종 결과는 아래와 같습니다.
    <ul>
      <li>vpc.tf
        <div class="language-tf highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="c1"># vpc.tf</span>
<span class="k">provider</span> <span class="s2">"aws"</span> <span class="p">{</span>
    <span class="nx">region</span> <span class="p">=</span> <span class="s2">"ap-northeast-2"</span>
<span class="p">}</span>
    
<span class="k">resource</span> <span class="s2">"aws_vpc"</span> <span class="s2">"peter_vpc"</span> <span class="p">{</span>
  <span class="nx">cidr_block</span> <span class="p">=</span> <span class="s2">"10.10.0.0/16"</span>
  <span class="nx">enable_dns_support</span> <span class="p">=</span> <span class="kc">true</span>
  <span class="nx">enable_dns_hostnames</span> <span class="p">=</span> <span class="kc">true</span>
  <span class="nx">tags</span> <span class="p">=</span> <span class="p">{</span>
    <span class="nx">Name</span> <span class="p">=</span> <span class="s2">"t101-study"</span>
  <span class="p">}</span>
<span class="p">}</span>
    
<span class="k">resource</span> <span class="s2">"aws_subnet"</span> <span class="s2">"peter_subnet1"</span> <span class="p">{</span>
  <span class="nx">vpc_id</span>     <span class="p">=</span> <span class="nx">aws_vpc</span><span class="p">.</span><span class="nx">peter_vpc</span><span class="p">.</span><span class="nx">id</span>
  <span class="nx">cidr_block</span> <span class="p">=</span> <span class="s2">"10.10.1.0/24"</span>
    
  <span class="nx">availability_zone</span> <span class="p">=</span> <span class="s2">"ap-northeast-2a"</span>
    
  <span class="nx">tags</span> <span class="p">=</span> <span class="p">{</span>
    <span class="nx">Name</span> <span class="p">=</span> <span class="s2">"t101-subnet1"</span>
  <span class="p">}</span>
<span class="p">}</span>
    
<span class="k">resource</span> <span class="s2">"aws_subnet"</span> <span class="s2">"peter_subnet2"</span> <span class="p">{</span>
  <span class="nx">vpc_id</span>     <span class="p">=</span> <span class="nx">aws_vpc</span><span class="p">.</span><span class="nx">peter_vpc</span><span class="p">.</span><span class="nx">id</span>
  <span class="nx">cidr_block</span> <span class="p">=</span> <span class="s2">"10.10.2.0/24"</span>
    
  <span class="nx">availability_zone</span> <span class="p">=</span> <span class="s2">"ap-northeast-2c"</span>
    
  <span class="nx">tags</span> <span class="p">=</span> <span class="p">{</span>
    <span class="nx">Name</span> <span class="p">=</span> <span class="s2">"t101-subnet2"</span>
  <span class="p">}</span>
<span class="p">}</span>
    
<span class="k">resource</span> <span class="s2">"aws_internet_gateway"</span> <span class="s2">"peter_igw"</span> <span class="p">{</span>
  <span class="nx">vpc_id</span> <span class="p">=</span> <span class="nx">aws_vpc</span><span class="p">.</span><span class="nx">peter_vpc</span><span class="p">.</span><span class="nx">id</span>
    
  <span class="nx">tags</span> <span class="p">=</span> <span class="p">{</span>
    <span class="nx">Name</span> <span class="p">=</span> <span class="s2">"t101-igw"</span>
  <span class="p">}</span>
<span class="p">}</span>
    
    
<span class="k">resource</span> <span class="s2">"aws_route_table"</span> <span class="s2">"peter_rt"</span> <span class="p">{</span>
  <span class="nx">vpc_id</span> <span class="p">=</span> <span class="nx">aws_vpc</span><span class="p">.</span><span class="nx">peter_vpc</span><span class="p">.</span><span class="nx">id</span>
    
  <span class="nx">tags</span> <span class="p">=</span> <span class="p">{</span>
    <span class="nx">Name</span> <span class="p">=</span> <span class="s2">"t101-rt"</span>
  <span class="p">}</span>
<span class="p">}</span>
    
<span class="k">resource</span> <span class="s2">"aws_route_table_association"</span> <span class="s2">"peter_rtassociation1"</span> <span class="p">{</span>
  <span class="nx">subnet_id</span>      <span class="p">=</span> <span class="nx">aws_subnet</span><span class="p">.</span><span class="nx">peter_subnet1</span><span class="p">.</span><span class="nx">id</span>
  <span class="nx">route_table_id</span> <span class="p">=</span> <span class="nx">aws_route_table</span><span class="p">.</span><span class="nx">peter_rt</span><span class="p">.</span><span class="nx">id</span>
<span class="p">}</span>
    
<span class="k">resource</span> <span class="s2">"aws_route_table_association"</span> <span class="s2">"peter_rtassociation2"</span> <span class="p">{</span>
  <span class="nx">subnet_id</span>      <span class="p">=</span> <span class="nx">aws_subnet</span><span class="p">.</span><span class="nx">peter_subnet2</span><span class="p">.</span><span class="nx">id</span>
  <span class="nx">route_table_id</span> <span class="p">=</span> <span class="nx">aws_route_table</span><span class="p">.</span><span class="nx">peter_rt</span><span class="p">.</span><span class="nx">id</span>
<span class="p">}</span>
    
<span class="k">resource</span> <span class="s2">"aws_route"</span> <span class="s2">"peter_defaultroute"</span> <span class="p">{</span>
  <span class="nx">route_table_id</span>         <span class="p">=</span> <span class="nx">aws_route_table</span><span class="p">.</span><span class="nx">peter_rt</span><span class="p">.</span><span class="nx">id</span>
  <span class="nx">destination_cidr_block</span> <span class="p">=</span> <span class="s2">"0.0.0.0/0"</span>
  <span class="nx">gateway_id</span>             <span class="p">=</span> <span class="nx">aws_internet_gateway</span><span class="p">.</span><span class="nx">peter_igw</span><span class="p">.</span><span class="nx">id</span>
<span class="p">}</span>
    
<span class="k">output</span> <span class="s2">"aws_vpc_id"</span> <span class="p">{</span>
  <span class="nx">value</span> <span class="p">=</span> <span class="nx">aws_vpc</span><span class="p">.</span><span class="nx">peter_vpc</span><span class="p">.</span><span class="nx">id</span>
<span class="p">}</span>    
</code></pre></div>        </div>
      </li>
      <li>sg.tf
        <div class="language-tf highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="c1"># sg.tf</span>
<span class="k">resource</span> <span class="s2">"aws_security_group"</span> <span class="s2">"peter_sg"</span> <span class="p">{</span>
  <span class="nx">vpc_id</span>      <span class="p">=</span> <span class="nx">aws_vpc</span><span class="p">.</span><span class="nx">peter_vpc</span><span class="p">.</span><span class="nx">id</span>
  <span class="nx">name</span>        <span class="p">=</span> <span class="s2">"T101 SG"</span>
  <span class="nx">description</span> <span class="p">=</span> <span class="s2">"T101 Study SG"</span>
<span class="p">}</span>
    
<span class="k">resource</span> <span class="s2">"aws_security_group_rule"</span> <span class="s2">"peter_sginbound"</span> <span class="p">{</span>
  <span class="nx">type</span>              <span class="p">=</span> <span class="s2">"ingress"</span>
  <span class="nx">from_port</span>         <span class="p">=</span> <span class="mi">80</span>
  <span class="nx">to_port</span>           <span class="p">=</span> <span class="mi">80</span>
  <span class="nx">protocol</span>          <span class="p">=</span> <span class="s2">"tcp"</span>
  <span class="nx">cidr_blocks</span>       <span class="p">=</span> <span class="p">[</span><span class="s2">"0.0.0.0/0"</span><span class="p">]</span>
  <span class="nx">security_group_id</span> <span class="p">=</span> <span class="nx">aws_security_group</span><span class="p">.</span><span class="nx">peter_sg</span><span class="p">.</span><span class="nx">id</span>
<span class="p">}</span>
    
<span class="k">resource</span> <span class="s2">"aws_security_group_rule"</span> <span class="s2">"peter_sgoutbound"</span> <span class="p">{</span>
  <span class="nx">type</span>              <span class="p">=</span> <span class="s2">"egress"</span>
  <span class="nx">from_port</span>         <span class="p">=</span> <span class="mi">0</span>
  <span class="nx">to_port</span>           <span class="p">=</span> <span class="mi">0</span>
  <span class="nx">protocol</span>          <span class="p">=</span> <span class="s2">"-1"</span>
  <span class="nx">cidr_blocks</span>       <span class="p">=</span> <span class="p">[</span><span class="s2">"0.0.0.0/0"</span><span class="p">]</span>
  <span class="nx">security_group_id</span> <span class="p">=</span> <span class="nx">aws_security_group</span><span class="p">.</span><span class="nx">peter_sg</span><span class="p">.</span><span class="nx">id</span>
<span class="p">}</span>
    
<span class="k">output</span> <span class="s2">"aws_security_group_id"</span> <span class="p">{</span>
  <span class="nx">value</span>       <span class="p">=</span> <span class="nx">aws_security_group</span><span class="p">.</span><span class="nx">peter_sg</span><span class="p">.</span><span class="nx">id</span>
<span class="p">}</span>    
</code></pre></div>        </div>
      </li>
      <li>ec2.tf
        <div class="language-tf highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="c1"># ec2.tf</span>
<span class="k">data</span> <span class="s2">"aws_ami"</span> <span class="s2">"peter_amazonlinux2"</span> <span class="p">{</span>
  <span class="nx">most_recent</span> <span class="p">=</span> <span class="kc">true</span>
  <span class="nx">filter</span> <span class="p">{</span>
    <span class="nx">name</span>   <span class="p">=</span> <span class="s2">"owner-alias"</span>
    <span class="nx">values</span> <span class="p">=</span> <span class="p">[</span><span class="s2">"amazon"</span><span class="p">]</span>
  <span class="p">}</span>
    
  <span class="nx">filter</span> <span class="p">{</span>
    <span class="nx">name</span>   <span class="p">=</span> <span class="s2">"name"</span>
    <span class="nx">values</span> <span class="p">=</span> <span class="p">[</span><span class="s2">"amzn2-ami-hvm-*-x86_64-ebs"</span><span class="p">]</span>
  <span class="p">}</span>
    
  <span class="nx">owners</span> <span class="p">=</span> <span class="p">[</span><span class="s2">"amazon"</span><span class="p">]</span>
<span class="p">}</span>
    
<span class="k">resource</span> <span class="s2">"aws_instance"</span> <span class="s2">"peter_ec2"</span> <span class="p">{</span>
    
  <span class="nx">depends_on</span> <span class="p">=</span> <span class="p">[</span>
    <span class="nx">aws_internet_gateway</span><span class="p">.</span><span class="nx">peter_igw</span>
  <span class="p">]</span>
    
  <span class="nx">ami</span>                         <span class="p">=</span> <span class="k">data</span><span class="p">.</span><span class="nx">aws_ami</span><span class="p">.</span><span class="nx">peter_amazonlinux2</span><span class="p">.</span><span class="nx">id</span>
  <span class="nx">associate_public_ip_address</span> <span class="p">=</span> <span class="kc">true</span>
  <span class="nx">instance_type</span>               <span class="p">=</span> <span class="s2">"t2.micro"</span>
  <span class="nx">vpc_security_group_ids</span>      <span class="p">=</span> <span class="p">[</span><span class="s2">"</span><span class="k">${</span><span class="nx">aws_security_group</span><span class="p">.</span><span class="nx">peter_sg</span><span class="p">.</span><span class="nx">id</span><span class="k">}</span><span class="s2">"</span><span class="p">]</span>
  <span class="nx">subnet_id</span>                   <span class="p">=</span> <span class="nx">aws_subnet</span><span class="p">.</span><span class="nx">peter_subnet1</span><span class="p">.</span><span class="nx">id</span>
    
  <span class="nx">user_data</span> <span class="p">=</span> <span class="o">&lt;&lt;-</span><span class="no">EOF</span><span class="sh">
              #!/bin/bash
              wget https://busybox.net/downloads/binaries/1.31.0-defconfig-multiarch-musl/busybox-x86_64
              mv busybox-x86_64 busybox
              chmod +x busybox
              RZAZ=$(curl http://169.254.169.254/latest/meta-data/placement/availability-zone-id)
              IID=$(curl 169.254.169.254/latest/meta-data/instance-id)
              LIP=$(curl 169.254.169.254/latest/meta-data/local-ipv4)
              echo "&lt; h1&gt;RegionAz($RZAZ) : Instance ID($IID) : Private IP($LIP) : Web Server&lt;/h1&gt;&lt;br/&gt;Greetings commander" &gt; index.html
              nohup ./busybox httpd -f -p 80 &amp;
</span><span class="no">              EOF
    
</span>  <span class="nx">user_data_replace_on_change</span> <span class="p">=</span> <span class="kc">true</span>
    
  <span class="nx">tags</span> <span class="p">=</span> <span class="p">{</span>
    <span class="nx">Name</span> <span class="p">=</span> <span class="s2">"t101-peter_ec2"</span>
  <span class="p">}</span>
<span class="p">}</span>
    
<span class="k">output</span> <span class="s2">"peter_ec2_public_ip"</span> <span class="p">{</span>
  <span class="nx">value</span>       <span class="p">=</span> <span class="nx">aws_instance</span><span class="p">.</span><span class="nx">peter_ec2</span><span class="p">.</span><span class="nx">public_ip</span>
  <span class="nx">description</span> <span class="p">=</span> <span class="s2">"The public IP of the Instance"</span>
<span class="p">}</span>    
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
  <li>배포 후 EC2 확인
    <div class="language-sh highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>terraform apply <span class="nt">-auto-approve</span>
<span class="c"># =&gt; ...</span>
<span class="c">#    Outputs:</span>

<span class="c">#    aws_security_group_id = "sg-07761e7b1e39b5af6"</span>
<span class="c">#    aws_vpc_id = "vpc-0e1ad43009a8fe8fa"</span>
<span class="c">#    peter_ec2_public_ip = "54.180.146.116"</span>
  
<span class="c"># ami 데이터 확인</span>
<span class="nv">$ </span>terraform state show data.aws_ami.my_amazonlinux2
  
<span class="c"># EC2 인스턴스 정보 확인</span>
<span class="nv">$ </span>terraform state show aws_instance.myec2
  
<span class="c"># EC2 인스턴스 IP 확인</span>
<span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"aws_instance.peter_ec2.public_ip"</span> | terraform console
<span class="c"># =&gt; "54.180.146.116"</span>
<span class="nv">$ </span>terraform output <span class="nt">-raw</span> peter_ec2_public_ip
<span class="c"># =&gt; 54.180.146.116</span>
  
<span class="c"># curl 로 접속 확인</span>
<span class="nv">$ PETER_EC2_IP</span><span class="o">=</span><span class="si">$(</span>terraform output <span class="nt">-raw</span> peter_ec2_public_ip<span class="si">)</span>
<span class="nv">$ </span>curl <span class="nv">$PETER_EC2_IP</span>                                      
<span class="c"># =&gt; &lt; h1&gt;RegionAz(apne2-az1) : Instance ID(i-0d4b665d1ce7a4b09) : Private IP(10.10.1.41) : Web Server&lt;/h1&gt;&lt;br/&gt;Greetings commander</span>
</code></pre></div>    </div>
  </li>
  <li>브라우저로 접속 확인
<img src="/assets/2024/20240622_terraform_w2_c2_p1_4.png" alt="20240622_terraform_w2_c2_p1_4.png">
</li>
  <li>그래프 확인
    <svg width="753pt" height="341pt" viewbox="0.00 0.00 752.75 341.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 337)">
<title>G</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-337 748.75,-337 748.75,4 -4,4"></polygon>
<!-- data.aws_ami.peter_amazonlinux2 -->
<g id="node1" class="node">
<title>data.aws_ami.peter_amazonlinux2</title>
<polygon fill="none" stroke="black" points="393.5,-252 167.5,-252 167.5,-216 393.5,-216 393.5,-252"></polygon>
<text text-anchor="middle" x="280.5" y="-228.2" font-family="sans-serif" font-size="14.00">data.aws_ami.peter_amazonlinux2</text>
</g>
<!-- aws_instance.peter_ec2 -->
<g id="node2" class="node">
<title>aws_instance.peter_ec2</title>
<polygon fill="none" stroke="black" points="667.88,-198 506.38,-198 506.38,-162 667.88,-162 667.88,-198"></polygon>
<text text-anchor="middle" x="587.12" y="-174.2" font-family="sans-serif" font-size="14.00">aws_instance.peter_ec2</text>
</g>
<!-- aws_instance.peter_ec2&#45;&gt;data.aws_ami.peter_amazonlinux2 -->
<g id="edge1" class="edge">
<title>aws_instance.peter_ec2-&gt;data.aws_ami.peter_amazonlinux2</title>
<path fill="none" stroke="black" d="M506.09,-194.19C472.7,-200.11 433.28,-207.09 396.86,-213.55"></path>
<polygon fill="black" stroke="black" points="396.39,-210.08 387.15,-215.27 397.61,-216.97 396.39,-210.08"></polygon>
</g>
<!-- aws_internet_gateway.peter_igw -->
<g id="node3" class="node">
<title>aws_internet_gateway.peter_igw</title>
<polygon fill="none" stroke="black" points="386.38,-198 174.62,-198 174.62,-162 386.38,-162 386.38,-198"></polygon>
<text text-anchor="middle" x="280.5" y="-174.2" font-family="sans-serif" font-size="14.00">aws_internet_gateway.peter_igw</text>
</g>
<!-- aws_instance.peter_ec2&#45;&gt;aws_internet_gateway.peter_igw -->
<g id="edge2" class="edge">
<title>aws_instance.peter_ec2-&gt;aws_internet_gateway.peter_igw</title>
<path fill="none" stroke="black" d="M506.09,-180C473.02,-180 434.03,-180 397.91,-180"></path>
<polygon fill="black" stroke="black" points="398.31,-176.5 388.31,-180 398.31,-183.5 398.31,-176.5"></polygon>
</g>
<!-- aws_security_group.peter_sg -->
<g id="node8" class="node">
<title>aws_security_group.peter_sg</title>
<polygon fill="none" stroke="black" points="376.62,-306 184.38,-306 184.38,-270 376.62,-270 376.62,-306"></polygon>
<text text-anchor="middle" x="280.5" y="-282.2" font-family="sans-serif" font-size="14.00">aws_security_group.peter_sg</text>
</g>
<!-- aws_instance.peter_ec2&#45;&gt;aws_security_group.peter_sg -->
<g id="edge3" class="edge">
<title>aws_instance.peter_ec2-&gt;aws_security_group.peter_sg</title>
<path fill="none" stroke="black" d="M517.9,-198.43C489.7,-207.34 457.2,-219.31 429.5,-234 411.83,-243.37 411.59,-252.48 393.5,-261 390,-262.65 386.39,-264.2 382.71,-265.66"></path>
<polygon fill="black" stroke="black" points="381.76,-262.28 373.58,-269.03 384.18,-268.85 381.76,-262.28"></polygon>
</g>
<!-- aws_subnet.peter_subnet1 -->
<g id="node11" class="node">
<title>aws_subnet.peter_subnet1</title>
<polygon fill="none" stroke="black" points="369.5,-144 191.5,-144 191.5,-108 369.5,-108 369.5,-144"></polygon>
<text text-anchor="middle" x="280.5" y="-120.2" font-family="sans-serif" font-size="14.00">aws_subnet.peter_subnet1</text>
</g>
<!-- aws_instance.peter_ec2&#45;&gt;aws_subnet.peter_subnet1 -->
<g id="edge4" class="edge">
<title>aws_instance.peter_ec2-&gt;aws_subnet.peter_subnet1</title>
<path fill="none" stroke="black" d="M506.02,-166.35C481.46,-162.12 454.36,-157.41 429.5,-153 413.83,-150.22 397.23,-147.23 381.04,-144.3"></path>
<polygon fill="black" stroke="black" points="381.86,-140.89 371.4,-142.54 380.61,-147.78 381.86,-140.89"></polygon>
</g>
<!-- aws_vpc.peter_vpc -->
<g id="node13" class="node">
<title>aws_vpc.peter_vpc</title>
<polygon fill="none" stroke="black" points="131.5,-144 0,-144 0,-108 131.5,-108 131.5,-144"></polygon>
<text text-anchor="middle" x="65.75" y="-120.2" font-family="sans-serif" font-size="14.00">aws_vpc.peter_vpc</text>
</g>
<!-- aws_internet_gateway.peter_igw&#45;&gt;aws_vpc.peter_vpc -->
<g id="edge5" class="edge">
<title>aws_internet_gateway.peter_igw-&gt;aws_vpc.peter_vpc</title>
<path fill="none" stroke="black" d="M201.71,-161.52C190.23,-158.71 178.55,-155.81 167.5,-153 159.51,-150.97 151.17,-148.8 142.86,-146.62"></path>
<polygon fill="black" stroke="black" points="144.02,-143.3 133.46,-144.13 142.23,-150.07 144.02,-143.3"></polygon>
</g>
<!-- aws_route.peter_defaultroute -->
<g id="node4" class="node">
<title>aws_route.peter_defaultroute</title>
<polygon fill="none" stroke="black" points="682.88,-144 491.38,-144 491.38,-108 682.88,-108 682.88,-144"></polygon>
<text text-anchor="middle" x="587.12" y="-120.2" font-family="sans-serif" font-size="14.00">aws_route.peter_defaultroute</text>
</g>
<!-- aws_route.peter_defaultroute&#45;&gt;aws_internet_gateway.peter_igw -->
<g id="edge6" class="edge">
<title>aws_route.peter_defaultroute-&gt;aws_internet_gateway.peter_igw</title>
<path fill="none" stroke="black" d="M491.26,-142.2C470.88,-145.72 449.47,-149.46 429.5,-153 417.69,-155.1 405.35,-157.31 393.05,-159.53"></path>
<polygon fill="black" stroke="black" points="392.49,-156.07 383.28,-161.3 393.74,-162.96 392.49,-156.07"></polygon>
</g>
<!-- aws_route_table.peter_rt -->
<g id="node5" class="node">
<title>aws_route_table.peter_rt</title>
<polygon fill="none" stroke="black" points="363.12,-90 197.88,-90 197.88,-54 363.12,-54 363.12,-90"></polygon>
<text text-anchor="middle" x="280.5" y="-66.2" font-family="sans-serif" font-size="14.00">aws_route_table.peter_rt</text>
</g>
<!-- aws_route.peter_defaultroute&#45;&gt;aws_route_table.peter_rt -->
<g id="edge7" class="edge">
<title>aws_route.peter_defaultroute-&gt;aws_route_table.peter_rt</title>
<path fill="none" stroke="black" d="M491.26,-109.8C470.88,-106.28 449.47,-102.54 429.5,-99 411.72,-95.85 392.74,-92.42 374.52,-89.11"></path>
<polygon fill="black" stroke="black" points="375.24,-85.69 364.77,-87.34 373.99,-92.57 375.24,-85.69"></polygon>
</g>
<!-- aws_route_table.peter_rt&#45;&gt;aws_vpc.peter_vpc -->
<g id="edge8" class="edge">
<title>aws_route_table.peter_rt-&gt;aws_vpc.peter_vpc</title>
<path fill="none" stroke="black" d="M201.71,-90.48C190.23,-93.29 178.55,-96.19 167.5,-99 159.51,-101.03 151.17,-103.2 142.86,-105.38"></path>
<polygon fill="black" stroke="black" points="142.23,-101.93 133.46,-107.87 144.02,-108.7 142.23,-101.93"></polygon>
</g>
<!-- aws_route_table_association.peter_rtassociation1 -->
<g id="node6" class="node">
<title>aws_route_table_association.peter_rtassociation1</title>
<polygon fill="none" stroke="black" points="744.75,-90 429.5,-90 429.5,-54 744.75,-54 744.75,-90"></polygon>
<text text-anchor="middle" x="587.12" y="-66.2" font-family="sans-serif" font-size="14.00">aws_route_table_association.peter_rtassociation1</text>
</g>
<!-- aws_route_table_association.peter_rtassociation1&#45;&gt;aws_route_table.peter_rt -->
<g id="edge9" class="edge">
<title>aws_route_table_association.peter_rtassociation1-&gt;aws_route_table.peter_rt</title>
<path fill="none" stroke="black" d="M429.35,-72C410.7,-72 392.13,-72 374.77,-72"></path>
<polygon fill="black" stroke="black" points="375.07,-68.5 365.07,-72 375.07,-75.5 375.07,-68.5"></polygon>
</g>
<!-- aws_route_table_association.peter_rtassociation1&#45;&gt;aws_subnet.peter_subnet1 -->
<g id="edge10" class="edge">
<title>aws_route_table_association.peter_rtassociation1-&gt;aws_subnet.peter_subnet1</title>
<path fill="none" stroke="black" d="M478.26,-90.45C461.92,-93.29 445.26,-96.2 429.5,-99 413.83,-101.78 397.23,-104.77 381.04,-107.7"></path>
<polygon fill="black" stroke="black" points="380.61,-104.22 371.4,-109.46 381.86,-111.11 380.61,-104.22"></polygon>
</g>
<!-- aws_route_table_association.peter_rtassociation2 -->
<g id="node7" class="node">
<title>aws_route_table_association.peter_rtassociation2</title>
<polygon fill="none" stroke="black" points="744.75,-36 429.5,-36 429.5,0 744.75,0 744.75,-36"></polygon>
<text text-anchor="middle" x="587.12" y="-12.2" font-family="sans-serif" font-size="14.00">aws_route_table_association.peter_rtassociation2</text>
</g>
<!-- aws_route_table_association.peter_rtassociation2&#45;&gt;aws_route_table.peter_rt -->
<g id="edge11" class="edge">
<title>aws_route_table_association.peter_rtassociation2-&gt;aws_route_table.peter_rt</title>
<path fill="none" stroke="black" d="M478.26,-36.45C461.92,-39.29 445.26,-42.2 429.5,-45 411.72,-48.15 392.74,-51.58 374.52,-54.89"></path>
<polygon fill="black" stroke="black" points="373.99,-51.43 364.77,-56.66 375.24,-58.31 373.99,-51.43"></polygon>
</g>
<!-- aws_subnet.peter_subnet2 -->
<g id="node12" class="node">
<title>aws_subnet.peter_subnet2</title>
<polygon fill="none" stroke="black" points="369.5,-36 191.5,-36 191.5,0 369.5,0 369.5,-36"></polygon>
<text text-anchor="middle" x="280.5" y="-12.2" font-family="sans-serif" font-size="14.00">aws_subnet.peter_subnet2</text>
</g>
<!-- aws_route_table_association.peter_rtassociation2&#45;&gt;aws_subnet.peter_subnet2 -->
<g id="edge12" class="edge">
<title>aws_route_table_association.peter_rtassociation2-&gt;aws_subnet.peter_subnet2</title>
<path fill="none" stroke="black" d="M429.35,-18C412.93,-18 396.57,-18 381.05,-18"></path>
<polygon fill="black" stroke="black" points="381.42,-14.5 371.42,-18 381.42,-21.5 381.42,-14.5"></polygon>
</g>
<!-- aws_security_group.peter_sg&#45;&gt;aws_vpc.peter_vpc -->
<g id="edge13" class="edge">
<title>aws_security_group.peter_sg-&gt;aws_vpc.peter_vpc</title>
<path fill="none" stroke="black" d="M184.02,-270C178.24,-267.4 172.68,-264.41 167.5,-261 126.88,-234.21 96.5,-185.22 80.21,-154.2"></path>
<polygon fill="black" stroke="black" points="83.39,-152.72 75.73,-145.39 77.15,-155.89 83.39,-152.72"></polygon>
</g>
<!-- aws_security_group_rule.peter_sginbound -->
<g id="node9" class="node">
<title>aws_security_group_rule.peter_sginbound</title>
<polygon fill="none" stroke="black" points="722.25,-333 452,-333 452,-297 722.25,-297 722.25,-333"></polygon>
<text text-anchor="middle" x="587.12" y="-309.2" font-family="sans-serif" font-size="14.00">aws_security_group_rule.peter_sginbound</text>
</g>
<!-- aws_security_group_rule.peter_sginbound&#45;&gt;aws_security_group.peter_sg -->
<g id="edge14" class="edge">
<title>aws_security_group_rule.peter_sginbound-&gt;aws_security_group.peter_sg</title>
<path fill="none" stroke="black" d="M451.63,-303.08C430.38,-301.2 408.66,-299.27 388.16,-297.45"></path>
<polygon fill="black" stroke="black" points="388.68,-293.99 378.41,-296.59 388.07,-300.96 388.68,-293.99"></polygon>
</g>
<!-- aws_security_group_rule.peter_sgoutbound -->
<g id="node10" class="node">
<title>aws_security_group_rule.peter_sgoutbound</title>
<polygon fill="none" stroke="black" points="726.38,-279 447.88,-279 447.88,-243 726.38,-243 726.38,-279"></polygon>
<text text-anchor="middle" x="587.12" y="-255.2" font-family="sans-serif" font-size="14.00">aws_security_group_rule.peter_sgoutbound</text>
</g>
<!-- aws_security_group_rule.peter_sgoutbound&#45;&gt;aws_security_group.peter_sg -->
<g id="edge15" class="edge">
<title>aws_security_group_rule.peter_sgoutbound-&gt;aws_security_group.peter_sg</title>
<path fill="none" stroke="black" d="M447.63,-273.28C427.75,-275.04 407.56,-276.83 388.42,-278.52"></path>
<polygon fill="black" stroke="black" points="388.12,-275.04 378.47,-279.4 388.74,-282.01 388.12,-275.04"></polygon>
</g>
<!-- aws_subnet.peter_subnet1&#45;&gt;aws_vpc.peter_vpc -->
<g id="edge16" class="edge">
<title>aws_subnet.peter_subnet1-&gt;aws_vpc.peter_vpc</title>
<path fill="none" stroke="black" d="M191.12,-126C175.14,-126 158.59,-126 142.99,-126"></path>
<polygon fill="black" stroke="black" points="143.34,-122.5 133.34,-126 143.34,-129.5 143.34,-122.5"></polygon>
</g>
<!-- aws_subnet.peter_subnet2&#45;&gt;aws_vpc.peter_vpc -->
<g id="edge17" class="edge">
<title>aws_subnet.peter_subnet2-&gt;aws_vpc.peter_vpc</title>
<path fill="none" stroke="black" d="M191.07,-35.39C182.93,-38.15 174.95,-41.34 167.5,-45 139.2,-58.91 111.62,-81.94 92.49,-99.9"></path>
<polygon fill="black" stroke="black" points="90.21,-97.25 85.42,-106.7 95.06,-102.29 90.21,-97.25"></polygon>
</g>
</g>
</svg>
  </li>
</ul>

<h1 id="마치며">마치며</h1>
<ul>
  <li>실습을 통해 리소스 유형과 리소스 이름의 사용법, 리소스 속성 등에 대해 이해를 높일 수 있었습니다. 
새삼스럽지만 이렇게 쉽게 각종 리소스들이 생성되고, 서비스가 운영된다는게 신기합니다.</li>
  <li>악분님 실습도 해보고 싶었지만 생각보다 여기까지 시간이 많이 소요되어 다음번으로 미루어야겠습니다. <img class="emoji" title=":cry:" alt=":cry:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f622.png" height="20" width="20">
</li>
  <li>따라가기 버거운 만큼 남는것이 많은 스터디가 될것 같습니다. 끝까지 생존해서 완주 할 수 있길 바라며 오늘의 포스팅을 마칩니다.</li>
</ul>

  </div>
<a class="u-url" href="/posts/2024-06-23-T101-Study-Terraform-Week-2/" hidden></a>
</article>



<div class="PageNavigation">
  
  <a class="prev" href="/posts/2024-06-11-T101-Study-Terraform-Week-1/">« [T101 4기] 테라폼 기본 사용법 1/3</a>
  
  
  <a class="next" href="/posts/2024-06-30-T101-Study-Terraform-Week-3/">[T101 4기] 테라폼 기본 사용법 3/3 »</a>
  
</div>

<div id="disqus_thread"></div>
<script>
var disqus_config = function () {
this.page.url = "https://sweetlittlebird.github.io/posts/2024-06-23-T101-Study-Terraform-Week-2/";
this.page.identifier = "/posts/T101 Study - Terraform Week 2";
};
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Sweet Little Bird</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Sweet Little Bird</li>
</ul>
      </div>

      <div class="footer-col footer-col-2">
<ul class="social-media-list"><li><a href="https://github.com/sweetlittlebird"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">sweetlittlebird</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>공부 기록과 개발 이야기를 담은 블로그입니다.</p>
      </div>
    </div>

  </div>

</footer>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-EWGY9N8QXY"></script>
    <script src="/assets/js/main.js"></script>
  </body>

</html>
