<!DOCTYPE html>
<html lang="ko">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>[Cilium] K8S/Cilium Performance | Sweet Little Bird</title>
<meta name="generator" content="Jekyll v4.3.3">
<meta property="og:title" content="[Cilium] K8S/Cilium Performance">
<meta property="og:locale" content="ko">
<meta name="description" content="ì´ë²ˆ í¬ìŠ¤íŠ¸ì—ì„œëŠ” Ciliumì˜ performanceì™€ ê·¸ì˜ ê¸°ë°˜ì´ ë˜ëŠ” K8Sì˜ performanceì— ëŒ€í•´ ì‹¤ìŠµì„ í†µí•˜ì—¬ ì•Œì•„ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.">
<meta property="og:description" content="ì´ë²ˆ í¬ìŠ¤íŠ¸ì—ì„œëŠ” Ciliumì˜ performanceì™€ ê·¸ì˜ ê¸°ë°˜ì´ ë˜ëŠ” K8Sì˜ performanceì— ëŒ€í•´ ì‹¤ìŠµì„ í†µí•˜ì—¬ ì•Œì•„ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.">
<link rel="canonical" href="https://sweetlittlebird.github.io/posts/2025-08-31-Cilium-Week7/">
<meta property="og:url" content="https://sweetlittlebird.github.io/posts/2025-08-31-Cilium-Week7/">
<meta property="og:site_name" content="Sweet Little Bird">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2025-08-31T00:10:18+09:00">
<meta name="twitter:card" content="summary">
<meta property="twitter:title" content="[Cilium] K8S/Cilium Performance">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-08-31T00:10:18+09:00","datePublished":"2025-08-31T00:10:18+09:00","description":"ì´ë²ˆ í¬ìŠ¤íŠ¸ì—ì„œëŠ” Ciliumì˜ performanceì™€ ê·¸ì˜ ê¸°ë°˜ì´ ë˜ëŠ” K8Sì˜ performanceì— ëŒ€í•´ ì‹¤ìŠµì„ í†µí•˜ì—¬ ì•Œì•„ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.","headline":"[Cilium] K8S/Cilium Performance","mainEntityOfPage":{"@type":"WebPage","@id":"https://sweetlittlebird.github.io/posts/2025-08-31-Cilium-Week7/"},"url":"https://sweetlittlebird.github.io/posts/2025-08-31-Cilium-Week7/"}</script>
<!-- End Jekyll SEO tag -->

  <link rel="stylesheet" href="/assets/dist/photoswipe.min.css">
  <link rel="stylesheet" href="/assets/dist/main.min.css">
  <link rel="stylesheet" href="/assets/dist/main_dark.min.css" media="(prefers-color-scheme: dark)">
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pretendard/1.3.9/static/pretendard.css" integrity="sha512-NzqTHTrO48HsIamogmIaVhTXoSgRF24Cn+ynrNYrFuKrY0AdDbmcNieiOHsQARS/r0Gax9VwV3/rVMHs3ipUlg==" crossorigin="anonymous" referrerpolicy="no-referrer">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <!--  <link href="https://fonts.googleapis.com/css2?family=Elsie+Swash+Caps:wght@400;900&display=swap" rel="stylesheet">-->
  <link href="https://fonts.googleapis.com/css2?family=Elsie+Swash+Caps:wght@400;900&amp;family=Milonga&amp;display=swap" rel="stylesheet">

  <link rel="shortcut icon" href="/assets/favicon/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/assets/favicon/favicon.ico" type="image/x-icon">
<link type="application/atom+xml" rel="alternate" href="https://sweetlittlebird.github.io/feed.xml" title="Sweet Little Bird">
</head>
<body class="body--contents">
<header class="site-header" role="banner">

  <div class="wrapper">
<a class="site-title" rel="author" href="/">Sweet Little Bird</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger">
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewbox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"></path>
            </svg>
          </span>
        </label>

        <div class="trigger">
<a class="page-link" href="/about/">ì†Œê°œ</a><a class="page-link" href="/posts/">ê¸€ ëª©ë¡</a>
</div>
      </nav>
</div>
  
  <span id="scroll-indicator"></span>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">[Cilium] K8S/Cilium Performance</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2025-08-31T00:10:18+09:00" itemprop="datePublished">2025ë…„ 08ì›” 31ì¼ì— ì‘ì„±
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <div class="table-of-content">
      <header>ëª©ì°¨</header>
      <ul id="toc" class="section-nav">
<li class="toc-entry toc-h2"><a href="#%EB%93%A4%EC%96%B4%EA%B0%80%EB%A9%B0">ë“¤ì–´ê°€ë©°</a></li>
<li class="toc-entry toc-h2">
<a href="#k8s-performance">K8S Performance</a>
<ul>
<li class="toc-entry toc-h3"><a href="#%EC%8B%A4%EC%8A%B5-%ED%99%98%EA%B2%BD-%EA%B5%AC%EC%84%B1">ì‹¤ìŠµ í™˜ê²½ êµ¬ì„±</a></li>
<li class="toc-entry toc-h3"><a href="#%EC%8B%A4%EC%8A%B5%ED%99%98%EA%B2%BD-%EB%B0%B0%ED%8F%AC">ì‹¤ìŠµí™˜ê²½ ë°°í¬</a></li>
<li class="toc-entry toc-h3">
<a href="#kube-burner">Kube-burner</a>
<ul>
<li class="toc-entry toc-h4"><a href="#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-1--%EB%94%94%ED%94%8C%EB%A1%9C%EC%9D%B4%EB%A8%BC%ED%8A%B8-1%EA%B0%9C%ED%8C%8C%EB%93%9C-1%EA%B0%9C-%EC%83%9D%EC%84%B1--%EC%82%AD%EC%A0%9C-jobiterations-qps-burst-%EC%9D%98%EB%AF%B8-%ED%99%95%EC%9D%B8">ì‹œë‚˜ë¦¬ì˜¤ 1 : ë””í”Œë¡œì´ë¨¼íŠ¸ 1ê°œ(íŒŒë“œ 1ê°œ) ìƒì„± â†’ ì‚­ì œ, jobIterations qps burst ì˜ë¯¸ í™•ì¸</a></li>
<li class="toc-entry toc-h4"><a href="#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-2--%EB%85%B8%EB%93%9C-1%EB%8C%80%EC%97%90-%EC%B5%9C%EB%8C%80-%ED%8C%8C%EB%93%9C150%EA%B0%9C-%EB%B0%B0%ED%8F%AC-%EC%8B%9C%EB%8F%84-1">ì‹œë‚˜ë¦¬ì˜¤ 2 : ë…¸ë“œ 1ëŒ€ì— ìµœëŒ€ íŒŒë“œ(150ê°œ) ë°°í¬ ì‹œë„ 1</a></li>
<li class="toc-entry toc-h4"><a href="#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-3--%EB%85%B8%EB%93%9C-1%EB%8C%80%EC%97%90-%EC%B5%9C%EB%8C%80-%ED%8C%8C%EB%93%9C300%EA%B0%9C-%EB%B0%B0%ED%8F%AC-%EC%8B%9C%EB%8F%84-2">ì‹œë‚˜ë¦¬ì˜¤ 3 : ë…¸ë“œ 1ëŒ€ì— ìµœëŒ€ íŒŒë“œ(300ê°œ) ë°°í¬ ì‹œë„ 2</a></li>
</ul>
</li>
<li class="toc-entry toc-h3">
<a href="#k8s-performance--tuning">K8S Performance &amp; Tuning</a>
<ul>
<li class="toc-entry toc-h4"><a href="#%EB%8C%80%EA%B7%9C%EB%AA%A8-%ED%81%B4%EB%9F%AC%EC%8A%A4%ED%84%B0-%EA%B3%A0%EB%A0%A4%EC%82%AC%ED%95%AD">ëŒ€ê·œëª¨ í´ëŸ¬ìŠ¤í„° ê³ ë ¤ì‚¬í•­</a></li>
<li class="toc-entry toc-h4"><a href="#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-4-api-intensive---%ED%8C%8C%EB%93%9C%EB%A5%BC-%EC%83%9D%EC%84%B1configmap-secret-%ED%9B%84-%EC%82%AD%EC%A0%9C">ì‹œë‚˜ë¦¬ì˜¤ 4. api-intensive - íŒŒë“œë¥¼ ìƒì„±(configmap, secret) í›„ ì‚­ì œ</a></li>
<li class="toc-entry toc-h4"><a href="#kubernetes-api-%EC%84%B1%EB%8A%A5-%EB%A9%94%ED%8A%B8%EB%A6%AD--%EC%98%88%EC%A0%9C%EC%99%80-best-practice---blog">Kubernetes API ì„±ëŠ¥ ë©”íŠ¸ë¦­ : ì˜ˆì œì™€ Best Practice - Blog</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-entry toc-h2">
<a href="#cilium-performance">Cilium Performance</a>
<ul>
<li class="toc-entry toc-h3"><a href="#%EC%8B%A4%EC%8A%B5%ED%99%98%EA%B2%BD-%EC%A4%80%EB%B9%84">ì‹¤ìŠµí™˜ê²½ ì¤€ë¹„</a></li>
<li class="toc-entry toc-h3"><a href="#%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4-%ED%99%98%EA%B2%BD%EC%97%90%EC%84%9C-%EC%86%8D%EB%8F%84-%EC%B8%A1%EC%A0%95-%ED%85%8C%EC%8A%A4%ED%8A%B8">ì¿ ë²„ë„¤í‹°ìŠ¤ í™˜ê²½ì—ì„œ ì†ë„ ì¸¡ì • í…ŒìŠ¤íŠ¸</a></li>
<li class="toc-entry toc-h3"><a href="#cilium-%EC%A0%91%EC%86%8D-%EB%B0%8F-%EC%84%B1%EB%8A%A5-%ED%85%8C%EC%8A%A4%ED%8A%B8">Cilium ì ‘ì† ë° ì„±ëŠ¥ í…ŒìŠ¤íŠ¸</a></li>
<li class="toc-entry toc-h3">
<a href="#cilium-performance--tuning">Cilium Performance &amp; Tuning</a>
<ul>
<li class="toc-entry toc-h4"><a href="#deep-dive-into-cilium-resilient-architecture--apievent-%EC%99%80-cilium-agentstatedb-%EC%99%80-bpf-%EB%8F%99%EC%9E%91">Deep Dive Into Cilium Resilient Architecture : API(Event) ì™€ Cilium-Agent(StateDB) ì™€ BPF ë™ì‘</a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#kubernetes-perf-tests">Kubernetes perf-tests</a></li>
<li class="toc-entry toc-h3"><a href="#cilium-tuning-guide">Cilium Tuning Guide</a></li>
<li class="toc-entry toc-h3"><a href="#kubeshark">Kubeshark</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#%EB%A7%88%EC%B9%98%EB%A9%B0">ë§ˆì¹˜ë©°</a></li>
</ul>
    </div>
    <h2 id="ë“¤ì–´ê°€ë©°">ë“¤ì–´ê°€ë©°</h2>

<p>ì´ë²ˆ í¬ìŠ¤íŠ¸ì—ì„œëŠ” Ciliumì˜ performanceì™€ ê·¸ì˜ ê¸°ë°˜ì´ ë˜ëŠ” K8Sì˜ performanceì— ëŒ€í•´ ì‹¤ìŠµì„ í†µí•˜ì—¬ ì•Œì•„ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.</p>

<hr>

<h2 id="k8s-performance">K8S Performance</h2>

<h3 id="ì‹¤ìŠµ-í™˜ê²½-êµ¬ì„±">ì‹¤ìŠµ í™˜ê²½ êµ¬ì„±</h3>

<ul>
  <li>ì´ë²ˆ ì‹¤ìŠµì—ì„œëŠ” kindë¥¼ ì‚¬ìš©í•´ì„œ Kubernetes í´ëŸ¬ìŠ¤í„°ë¥¼ êµ¬ì„±í•˜ê³  ì„±ëŠ¥ í‰ê°€ë¥¼ ìœ„í•´ ë‹¤ìŒì˜ ìš”ì†Œë“¤ì„ ì„¤ì¹˜í•©ë‹ˆë‹¤.
    <ul>
      <li>
<code class="language-plaintext highlighter-rouge">kube-ops-view</code> : í´ëŸ¬ìŠ¤í„° ìƒíƒœ ì‹œê°í™” ë„êµ¬
<img src="/assets/2025/cilium/w7/20250831_cilium_w7_1.png" alt="img.png" loading="lazy" width="848" height="530">
</li>
      <li>
<code class="language-plaintext highlighter-rouge">metrics-server</code> : í´ëŸ¬ìŠ¤í„° ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ ìˆ˜ì§‘</li>
      <li>
<code class="language-plaintext highlighter-rouge">kube-prometheus-stack</code> : Prometheusì™€ Grafanaë¥¼ í¬í•¨í•œ ëª¨ë‹ˆí„°ë§ ìŠ¤íƒ</li>
    </ul>
  </li>
</ul>

<h3 id="ì‹¤ìŠµí™˜ê²½-ë°°í¬">ì‹¤ìŠµí™˜ê²½ ë°°í¬</h3>

<ul>
  <li>Kindë¥¼ ì‚¬ìš©í•˜ì—¬ í´ëŸ¬ìŠ¤í„°ë¥¼ ì„¤ì¹˜í•˜ê³  metrics-serverë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Prometheus Target connection refused bind-address ì„¤ì • : kube-controller-manager , kube-scheduler , etcd , kube-proxy</span>
<span class="nv">$ </span>kind create cluster <span class="nt">--name</span> myk8s <span class="nt">--image</span> kindest/node:v1.33.2 <span class="nt">--config</span> - <span class="o">&lt;&lt;</span><span class="no">EOF</span><span class="sh">
kind: Cluster
apiVersion: kind.x-k8s.io/v1alpha4
nodes:
- role: control-plane
  extraPortMappings:
  - containerPort: 30000
    hostPort: 30000
  - containerPort: 30001
    hostPort: 30001
  - containerPort: 30002
    hostPort: 30002
  - containerPort: 30003
    hostPort: 30003
  kubeadmConfigPatches: # Prometheus Target connection refused bind-address ì„¤ì •
  - |
    kind: ClusterConfiguration
    controllerManager:
      extraArgs:
        bind-address: 0.0.0.0
    etcd:
      local:
        extraArgs:
          listen-metrics-urls: http://0.0.0.0:2381
    scheduler:
      extraArgs:
        bind-address: 0.0.0.0
  - |
    kind: KubeProxyConfiguration
    metricsBindAddress: 0.0.0.0
</span><span class="no">EOF
</span><span class="c"># =&gt; Creating cluster "myk8s" ...</span>
<span class="c">#     âœ“ Ensuring node image (kindest/node:v1.33.2) ğŸ–¼</span>
<span class="c">#     âœ“ Preparing nodes ğŸ“¦</span>
<span class="c">#     âœ“ Writing configuration ğŸ“œ</span>
<span class="c">#     âœ“ Starting control-plane ğŸ•¹ï¸</span>
<span class="c">#     âœ“ Installing CNI ğŸ”Œ</span>
<span class="c">#     âœ“ Installing StorageClass ğŸ’¾</span>
<span class="c">#    Set kubectl context to "kind-myk8s"</span>
<span class="c">#    You can now use your cluster with:</span>
<span class="c">#    </span>
<span class="c">#    kubectl cluster-info --context kind-myk8s</span>
<span class="c">#    </span>
<span class="c">#    Have a question, bug, or feature request? Let us know! https://kind.sigs.k8s.io/#community ğŸ™‚</span>

<span class="c"># kube-ops-view ì„¤ì¹˜</span>
<span class="nv">$ </span>helm repo add geek-cookbook https://geek-cookbook.github.io/charts/
<span class="nv">$ </span>helm <span class="nb">install </span>kube-ops-view geek-cookbook/kube-ops-view <span class="nt">--version</span> 1.2.2 <span class="nt">--set</span> service.main.type<span class="o">=</span>NodePort,service.main.ports.http.nodePort<span class="o">=</span>30003 <span class="nt">--set</span> env.TZ<span class="o">=</span><span class="s2">"Asia/Seoul"</span> <span class="nt">--namespace</span> kube-system
<span class="c"># =&gt; NAME: kube-ops-view</span>
<span class="c">#    LAST DEPLOYED: Sat Aug 30 00:04:30 2025</span>
<span class="c">#    NAMESPACE: kube-system</span>
<span class="c">#    STATUS: deployed</span>
<span class="c">#    REVISION: 1</span>
<span class="c">#    TEST SUITE: None</span>
<span class="c">#    NOTES:</span>
<span class="c">#    1. Get the application URL by running these commands:</span>
<span class="c">#      export NODE_PORT=$(kubectl get --namespace kube-system -o jsonpath="{.spec.ports[0].nodePort}" services kube-ops-view)</span>
<span class="c">#      export NODE_IP=$(kubectl get nodes --namespace kube-system -o jsonpath="{.items[0].status.addresses[0].address}")</span>
<span class="c">#      echo http://$NODE_IP:$NODE_PORT</span>
<span class="nv">$ </span>open <span class="s2">"http://localhost:30003/#scale=1.5"</span>
<span class="nv">$ </span>open <span class="s2">"http://localhost:30003/#scale=2"</span>

<span class="c"># metrics-server</span>
<span class="nv">$ </span>helm repo add metrics-server https://kubernetes-sigs.github.io/metrics-server/
<span class="nv">$ </span>helm upgrade <span class="nt">--install</span> metrics-server metrics-server/metrics-server <span class="nt">--set</span> <span class="s1">'args[0]=--kubelet-insecure-tls'</span> <span class="nt">-n</span> kube-system
<span class="c"># =&gt; Release "metrics-server" does not exist. Installing it now.</span>
<span class="c">#    NAME: metrics-server</span>
<span class="c">#    ...</span>

<span class="c"># í™•ì¸</span>
<span class="nv">$ </span>kubectl top node
<span class="c"># =&gt; NAME                  CPU(cores)   CPU(%)   MEMORY(bytes)   MEMORY(%)</span>
<span class="c">#    myk8s-control-plane   328m         4%       913Mi           18%</span>
<span class="nv">$ </span>kubectl top pod <span class="nt">-A</span> <span class="nt">--sort-by</span><span class="o">=</span><span class="s1">'cpu'</span>
<span class="c"># =&gt; NAMESPACE            NAME                                          CPU(cores)   MEMORY(bytes)</span>
<span class="c">#    kube-system          kube-apiserver-myk8s-control-plane            78m          194Mi</span>
<span class="c">#    kube-system          etcd-myk8s-control-plane                      45m          28Mi</span>
<span class="c">#    kube-system          kube-ops-view-6658c477d4-vntvq                36m          83Mi</span>
<span class="c">#    kube-system          kube-controller-manager-myk8s-control-plane   33m          48Mi</span>
<span class="c">#    kube-system          kube-scheduler-myk8s-control-plane            16m          20Mi</span>
<span class="c">#    ...</span>
<span class="nv">$ </span>kubectl top pod <span class="nt">-A</span> <span class="nt">--sort-by</span><span class="o">=</span><span class="s1">'memory'</span>
<span class="c"># =&gt; NAMESPACE            NAME                                          CPU(cores)   MEMORY(bytes)</span>
<span class="c">#    kube-system          kube-apiserver-myk8s-control-plane            72m          197Mi</span>
<span class="c">#    kube-system          kube-ops-view-6658c477d4-vntvq                35m          83Mi</span>
<span class="c">#    kube-system          kube-controller-manager-myk8s-control-plane   33m          48Mi</span>
<span class="c">#    kube-system          etcd-myk8s-control-plane                      43m          28Mi</span>
<span class="c">#    kube-system          kube-scheduler-myk8s-control-plane            16m          21Mi</span>
<span class="c">#    ...</span>
</code></pre></div></div>

<ul>
  <li>ì´ì–´ì„œ kube-prometheus-stackë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤. - <a href="https://artifacthub.io/packages/helm/prometheus-community/kube-prometheus-stack">Link</a>
</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># íŒŒë¼ë¯¸í„° íŒŒì¼ ìƒì„±</span>
<span class="nv">$ </span><span class="nb">cat</span> <span class="o">&lt;&lt;</span><span class="no">EOT</span><span class="sh"> &gt; monitor-values.yaml
prometheus:
  prometheusSpec:
    scrapeInterval: "15s"
    evaluationInterval: "15s"
  service:
    type: NodePort
    nodePort: 30001

grafana:
  defaultDashboardsTimezone: Asia/Seoul
  adminPassword: prom-operator
  service:
    type: NodePort
    nodePort: 30002

alertmanager:
  enabled: false
defaultRules:
  create: false
prometheus-windows-exporter:
  prometheus:
    monitor:
      enabled: false
</span><span class="no">EOT
</span><span class="nv">$ </span><span class="nb">cat </span>monitor-values.yaml

<span class="nv">$ </span>helm repo add prometheus-community https://prometheus-community.github.io/helm-charts
<span class="nv">$ </span>helm repo update

<span class="c"># ë°°í¬</span>
<span class="nv">$ </span>helm <span class="nb">install </span>kube-prometheus-stack prometheus-community/kube-prometheus-stack <span class="nt">--version</span> 75.15.1 <span class="se">\</span>
  <span class="nt">-f</span> monitor-values.yaml <span class="nt">--create-namespace</span> <span class="nt">--namespace</span> monitoring
<span class="c"># =&gt; NAME: kube-prometheus-stack</span>
<span class="c">#    ...</span>
<span class="c">#    kube-prometheus-stack has been installed. Check its status by running:</span>
<span class="c">#      kubectl --namespace monitoring get pods -l "release=kube-prometheus-stack"</span>
<span class="c">#    </span>
<span class="c">#    Get Grafana 'admin' user password by running:</span>
<span class="c">#    </span>
<span class="c">#      kubectl --namespace monitoring get secrets kube-prometheus-stack-grafana -o jsonpath="{.data.admin-password}" | base64 -d ; echo</span>
<span class="c">#    </span>
<span class="c">#    Access Grafana local instance:</span>
<span class="c">#    </span>
<span class="c">#      export POD_NAME=$(kubectl --namespace monitoring get pod -l "app.kubernetes.io/name=grafana,app.kubernetes.io/instance=kube-prometheus-stack" -oname)</span>
<span class="c">#      kubectl --namespace monitoring port-forward $POD_NAME 3000</span>

<span class="c"># ì›¹ ì ‘ì† ì‹¤í–‰</span>
<span class="nv">$ </span>open http://127.0.0.1:30001 <span class="c"># macOS prometheus ì›¹ ì ‘ì†</span>
<span class="nv">$ </span>open http://127.0.0.1:30002 <span class="c"># macOS grafana ì›¹ ì ‘ì† ( admin , prom-operator )</span>
</code></pre></div></div>

<ul>
  <li>grafanaì— ì ‘ì† í›„ ëŒ€ì‹œë³´ë“œë¥¼ ì¶”ê°€ í•©ë‹ˆë‹¤.
    <ul>
      <li>K8S new <strong>15661</strong> : JSON ë‹¤ìš´ë¡œë“œ í›„ ì—…ë¡œë“œ - <a href="https://grafana.com/grafana/dashboards/15661-k8s-dashboard-en-20250125/">Link</a>
<img src="/assets/2025/cilium/w7/20250831_cilium_w7_3.png" alt="img.png" loading="lazy" width="1436" height="954">
</li>
      <li>K8S API old <strong>12006</strong> - <a href="https://grafana.com/grafana/dashboards/12006-kubernetes-apiserver/">Link</a>
<img src="/assets/2025/cilium/w7/20250831_cilium_w7_4.png" alt="img_1.png" loading="lazy" width="1436" height="954">
</li>
      <li>ëŒ€ì‹œë³´ë“œ ì¶”ê°€ ë°©ë²•
<img src="/assets/2025/cilium/w7/20250831_cilium_w7_2.png" alt="img.png" loading="lazy" width="760" height="538">
        <ul>
          <li>(1) ìš°ì¸¡ ìƒë‹¨ì˜ <code class="language-plaintext highlighter-rouge">+</code> í´ë¦­</li>
          <li>(2) Import dashboard í´ë¦­</li>
          <li>ì•„ë˜ì˜ ë°©ë²• ì¤‘ í•˜ë‚˜ë¡œ ëŒ€ì‹œë³´ë“œ ì¶”ê°€
            <ul>
              <li>(3) ë‹¤ìš´ë¡œë“œí•œ json íŒŒì¼ì„ ì—…ë¡œë“œ í•˜ê±°ë‚˜</li>
              <li>(4) ëŒ€ì‹œë³´ë“œ ID (15661 ë˜ëŠ” 12006) ì…ë ¥ í›„ Load í´ë¦­ í•˜ê±°ë‚˜</li>
              <li>(5) json íŒŒì¼ ë‚´ìš© ë¶™ì—¬ë„£ê¸°</li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h3 id="kube-burner">Kube-burner</h3>

<ul>
  <li>ì´ë²ˆ ì‹¤ìŠµì—ì„œëŠ” Kube-burner(v1.17.3)ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¶€í•˜ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. - <a href="https://github.com/kube-burner/kube-burner">Github</a> , <a href="https://kube-burner.github.io/kube-burner/v1.17.1/">Home</a> , <a href="https://github.com/kube-burner/kube-burner/tree/main/examples">examples</a>
    <ul>
      <li>Kube-burnerëŠ” ê³µì‹ ë¼ì´ë¸ŒëŸ¬ë¦¬ì¸ <a href="https://github.com/kubernetes/client-go">client-go</a>ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‘ì„±ëœ Golang ê¸°ë°˜ì˜ ë°”ì´ë„ˆë¦¬ ì• í”Œë¦¬ì¼€ì´ì…˜ì…ë‹ˆë‹¤.</li>
      <li>Kube-burnerëŠ” ë‹¤ìŒê³¼ ê°™ì€ ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.
        <ul>
          <li>ëŒ€ëŸ‰ì˜ Kubernetes ë¦¬ì†ŒìŠ¤ ìƒì„± ë° ì‚­ì œ, ì½ê¸°, íŒ¨ì¹˜</li>
          <li>Prometheus ë©”íŠ¸ë¦­ ìˆ˜ì§‘ ë° ì¸ë±ì‹±</li>
          <li>ì„±ëŠ¥ ì¸¡ì •</li>
          <li>ê²½ê³  ì•Œë¦¼</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h5 id="kube-burner-ì„¤ì¹˜">Kube-burner ì„¤ì¹˜</h5>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#</span>
<span class="nv">$ </span>git clone https://github.com/kube-burner/kube-burner.git
<span class="nv">$ </span><span class="nb">cd </span>kube-burner

<span class="c"># ë°”ì´ë„ˆë¦¬ ì„¤ì¹˜(ì¶”ì²œ) : mac M1</span>
<span class="nv">$ </span>curl <span class="nt">-LO</span> https://github.com/kube-burner/kube-burner/releases/download/v1.17.3/kube-burner-V1.17.3-darwin-arm64.tar.gz <span class="c"># mac M</span>
<span class="nv">$ </span><span class="nb">tar</span> <span class="nt">-xvf</span> kube-burner-V1.17.3-darwin-arm64.tar.gz

<span class="nv">$ </span>curl <span class="nt">-LO</span> https://github.com/kube-burner/kube-burner/releases/download/v1.17.3/kube-burner-V1.17.3-linux-x86_64.tar.gz <span class="c"># Windows</span>
<span class="nv">$ </span><span class="nb">tar</span> <span class="nt">-xvf</span> kube-burner-V1.17.3-linux-x86_64.tar.gz

<span class="nv">$ </span><span class="nb">sudo cp </span>kube-burner /usr/local/bin

<span class="nv">$ </span>kube-burner <span class="nt">-h</span>
<span class="c"># =&gt; Kube-burner ğŸ”¥</span>
<span class="c">#    </span>
<span class="c">#    Tool aimed at stressing a kubernetes cluster by creating or deleting lots of objects.</span>
<span class="c">#    </span>
<span class="c">#    Usage:</span>
<span class="c">#      kube-burner [command]</span>
<span class="c">#    </span>
<span class="c">#    Available Commands:</span>
<span class="c">#      check-alerts Evaluate alerts for the given time range</span>
<span class="c">#      completion   Generates completion scripts for bash shell</span>
<span class="c">#      destroy      Destroy old namespaces labeled with the given UUID.</span>
<span class="c">#      health-check Check for Health Status of the cluster</span>
<span class="c">#      help         Help about any command</span>
<span class="c">#      import       Import metrics tarball</span>
<span class="c">#      index        Index kube-burner metrics</span>
<span class="c">#      init         Launch benchmark</span>
<span class="c">#      measure      Take measurements for a given set of resources without running workload</span>
<span class="c">#      version      Print the version number of kube-burner</span>
<span class="c">#    </span>
<span class="c">#    Flags:</span>
<span class="c">#      -h, --help               help for kube-burner</span>
<span class="c">#          --log-level string   Allowed values: debug, info, warn, error, fatal (default &amp;quot;info&amp;quot;)</span>
<span class="c">#    </span>
<span class="c">#    Use &amp;quot;kube-burner [command] --help&amp;quot; for more information about a command.</span>

<span class="c"># ë²„ì „ í™•ì¸ : í˜¹ì€ go run cmd/kube-burner/kube-burner.go -h</span>
<span class="nv">$ </span>kube-burner version
<span class="c"># =&gt; Version: 1.17.3</span>
</code></pre></div></div>

<h4 id="ì‹œë‚˜ë¦¬ì˜¤-1--ë””í”Œë¡œì´ë¨¼íŠ¸-1ê°œíŒŒë“œ-1ê°œ-ìƒì„±--ì‚­ì œ-jobiterations-qps-burst-ì˜ë¯¸-í™•ì¸">ì‹œë‚˜ë¦¬ì˜¤ 1 : ë””í”Œë¡œì´ë¨¼íŠ¸ 1ê°œ(íŒŒë“œ 1ê°œ) ìƒì„± â†’ ì‚­ì œ, jobIterations qps burst ì˜ë¯¸ í™•ì¸</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#</span>
<span class="nv">$ </span><span class="nb">cat</span> <span class="o">&lt;&lt;</span> <span class="no">EOF</span><span class="sh"> &gt; s1-config.yaml
global:
  measurements:
    - name: none

jobs:
  - name: create-deployments
    jobType: create
    jobIterations: 1  # How many times to execute the job , í•´ë‹¹ jobì„ 5ë²ˆ ë°˜ë³µ ì‹¤í–‰
    qps: 1            # Limit object creation queries per second , 	ì´ˆë‹¹ ìµœëŒ€ ìš”ì²­ ìˆ˜ (í‰ê·  ì†ë„ ì œí•œ) - qps: 10ì´ë©´ ì´ˆë‹¹ 10ê°œ ìš”ì²­
    burst: 1          # Maximum burst for throttle , ìˆœê°„ì ìœ¼ë¡œ ì²˜ë¦¬ ê°€ëŠ¥í•œ ìš”ì²­ ìµœëŒ€ì¹˜ (ë²„í¼) - burst: 20ì´ë©´ í•œìˆœê°„ì— ìµœëŒ€ 20ê°œê¹Œì§€ ì²˜ë¦¬ ê°€ëŠ¥
    namespace: kube-burner-test
    namespaceLabels: {kube-burner-job: delete-me}
    waitWhenFinished: true # false
    verifyObjects: false
    preLoadImages: true # false
    preLoadPeriod: 30s # default 1m
    objects:
      - objectTemplate: s1-deployment.yaml
        replicas: 1
</span><span class="no">EOF

</span><span class="c">#</span>
<span class="nv">$ </span><span class="nb">cat</span> <span class="o">&lt;&lt;</span> <span class="no">EOF</span><span class="sh"> &gt; s1-deployment.yaml 
apiVersion: apps/v1
kind: Deployment
metadata:
  name: deployment-{{ .Iteration}}-{{.Replica}}
  labels:
    app: test-{{ .Iteration }}-{{.Replica}}
    kube-burner-job: delete-me
spec:
  replicas: 1
  selector:
    matchLabels:
      app: test-{{ .Iteration}}-{{.Replica}}
  template:
    metadata:
      labels:
        app: test-{{ .Iteration}}-{{.Replica}}
    spec:
      containers:
        - name: nginx
          image: nginx:alpine
          ports:
            - containerPort: 80
</span><span class="no">EOF


</span><span class="c"># ëª¨ë‹ˆí„°ë§ : í„°ë¯¸ë„, kube-ops-view</span>
<span class="nv">$ </span>watch <span class="nt">-d</span> kubectl get ns,pod <span class="nt">-A</span>


<span class="c"># ë¶€í•˜ ë°œìƒ ì‹¤í–‰ Launch benchmark</span>
<span class="nv">$ </span>kube-burner init <span class="nt">-h</span>
<span class="nv">$ </span>kube-burner init <span class="nt">-c</span> s1-config.yaml <span class="nt">--log-level</span> debug
<span class="c"># &lt;span style="color: green;"&gt;ğŸ‘‰ s1-deployment.yamlì„ 1ê°œ ë°°í¬í•˜ì—¬ ì´ˆë‹¹ 1ë²ˆ í˜¸ì¶œí•©ë‹ˆë‹¤.&lt;/span&gt;</span>
<span class="c"># =&gt; time="2025-08-30 10:35:54" level=info msg="ğŸ”¥ Starting kube-burner (1.17.3@917540ff45a89386bb25de45af9b96c9fc360e93) with UUID 8c6382d0-f8b2-4a9d-834b-878f9524a05d" file="job.go:91"</span>
<span class="c">#    time="2025-08-30 10:35:54" level=warning msg="Measurement [none] is not supported" file="factory.go:101"</span>
<span class="c">#    time="2025-08-30 10:35:54" level=debug msg="job.MaxWaitTimeout is zero in create-deployments, override by timeout: 4h0m0s" file="job.go:361"</span>
<span class="c">#    time="2025-08-30 10:35:54" level=info msg="QPS: 1" file="job.go:371"</span>
<span class="c">#    time="2025-08-30 10:35:54" level=info msg="Burst: 1" file="job.go:378"</span>
<span class="c">#    time="2025-08-30 10:35:54" level=debug msg="Preparing create job: create-deployments" file="create.go:46"</span>
<span class="c">#    time="2025-08-30 10:35:54" level=debug msg="Rendering template: s1-deployment.yaml" file="create.go:52"</span>
<span class="c">#    time="2025-08-30 10:35:54" level=info msg="Job create-deployments: 1 iterations with 1 Deployment replicas" file="create.go:84"</span>
<span class="c">#    time="2025-08-30 10:35:54" level=info msg="Pre-load: images from job create-deployments" file="pre_load.go:73"</span>
<span class="c">#    time="2025-08-30 10:35:54" level=debug msg="Created namespace: preload-kube-burner" file="namespaces.go:55"</span>
<span class="c">#    time="2025-08-30 10:35:54" level=info msg="Pre-load: Creating DaemonSet using images [nginx:alpine] in namespace preload-kube-burner" file="pre_load.go:195"</span>
<span class="c">#    time="2025-08-30 10:35:54" level=info msg="Pre-load: Sleeping for 30s" file="pre_load.go:86"</span>
<span class="c">#    time="2025-08-30 10:36:24" level=info msg="Deleting 1 namespaces with label: kube-burner-preload=true" file="namespaces.go:67"</span>
<span class="c">#    time="2025-08-30 10:36:24" level=debug msg="Waiting for 1 namespaces labeled with kube-burner-preload=true to be deleted" file="namespaces.go:90"</span>
<span class="c">#    time="2025-08-30 10:36:25" level=debug msg="Waiting for 1 namespaces labeled with kube-burner-preload=true to be deleted" file="namespaces.go:90"</span>
<span class="c">#    time="2025-08-30 10:36:26" level=debug msg="Waiting for 1 namespaces labeled with kube-burner-preload=true to be deleted" file="namespaces.go:90"</span>
<span class="c">#    time="2025-08-30 10:36:27" level=debug msg="Waiting for 1 namespaces labeled with kube-burner-preload=true to be deleted" file="namespaces.go:90"</span>
<span class="c">#    time="2025-08-30 10:36:28" level=debug msg="Waiting for 1 namespaces labeled with kube-burner-preload=true to be deleted" file="namespaces.go:90"</span>
<span class="c">#    time="2025-08-30 10:36:29" level=debug msg="Waiting for 1 namespaces labeled with kube-burner-preload=true to be deleted" file="namespaces.go:90"</span>
<span class="c">#    time="2025-08-30 10:36:30" level=info msg="Triggering job: create-deployments" file="job.go:122"</span>
<span class="c">#    time="2025-08-30 10:36:30" level=info msg="0/1 iterations completed" file="create.go:119"</span>
<span class="c">#    time="2025-08-30 10:36:30" level=debug msg="Creating object replicas from iteration 0" file="create.go:122"</span>
<span class="c">#    time="2025-08-30 10:36:31" level=info msg="Namespace kube-burner-test-0 already exists" file="namespaces.go:44"</span>
<span class="c">#    time="2025-08-30 10:36:32" level=error msg="Deployment/deployment-0-1 in namespace kube-burner-test-0 already exists" file="create.go:269"</span>
<span class="c">#    time="2025-08-30 10:36:32" level=info msg="Waiting up to 4h0m0s for actions to be completed" file="create.go:169"</span>
<span class="c">#    time="2025-08-30 10:36:33" level=info msg="Actions in namespace kube-burner-test-0 completed" file="waiters.go:74"</span>
<span class="c">#    time="2025-08-30 10:36:33" level=info msg="Job create-deployments took 3s" file="job.go:191"</span>
<span class="c">#    time="2025-08-30 10:36:33" level=info msg="Finished execution with UUID: 8c6382d0-f8b2-4a9d-834b-878f9524a05d" file="job.go:264"</span>
<span class="c">#    time="2025-08-30 10:36:33" level=info msg="ğŸ‘‹ Exiting kube-burner 8c6382d0-f8b2-4a9d-834b-878f9524a05d" file="kube-burner.go:90"</span>

<span class="c">#</span>
<span class="nv">$ </span>kubectl get deploy <span class="nt">-A</span> <span class="nt">-l</span> kube-burner-job<span class="o">=</span>delete-me
<span class="c"># =&gt; NAMESPACE            NAME             READY   UP-TO-DATE   AVAILABLE   AGE</span>
<span class="c">#    kube-burner-test-0   deployment-0-1   1/1     1            1           4m16s</span>
<span class="nv">$ </span>kubectl get pod <span class="nt">-A</span> <span class="nt">-l</span> kube-burner-job<span class="o">=</span>delete-me
<span class="c"># =&gt; NAMESPACE            NAME                              READY   STATUS    RESTARTS   AGE</span>
<span class="c">#    kube-burner-test-0   deployment-0-1-5f748ffd78-mlf64   1/1     Running   0          4m22s</span>
<span class="nv">$ </span>kubectl get ns <span class="nt">-l</span> kube-burner-job<span class="o">=</span>delete-me
<span class="c"># =&gt; NAME                 STATUS   AGE</span>
<span class="c">#    kube-burner-test-0   Active   4m46s</span>

<span class="c">#</span>
<span class="nv">$ </span><span class="nb">ls </span>kube-burner-<span class="k">*</span>.log
<span class="c"># =&gt; kube-burner-8c6382d0-f8b2-4a9d-834b-878f9524a05d.log</span>
<span class="nv">$ </span><span class="nb">cat </span>kube-burner-<span class="k">*</span>.log
<span class="c"># &lt;span style="color: green;"&gt;ğŸ‘‰ ìœ„ì˜ ì‹¤í–‰ì‹œì˜ ë¡œê·¸ê°€ ë˜‘ê°™ì´ ë‚˜ì˜´&lt;/span&gt;</span>

<span class="c"># ì‚­ì œ!</span>
<span class="c">## deployment ëŠ” s1-deployment.yaml ì— metadata.labels ì— ì¶”ê°€í•œ labels ë¡œ ì§€ì •</span>
<span class="c">## namespace ëŠ” config.yaml ì— job.name ê°’ì„ labels ë¡œ ì§€ì •</span>
<span class="nv">$ </span><span class="nb">cat</span> <span class="o">&lt;&lt;</span> <span class="no">EOF</span><span class="sh"> &gt; s1-config-delete.yaml
# global:
#   measurements:
#     - name: none

jobs:
  - name: delete-deployments-namespace
    qps: 500
    burst: 500
    namespace: kube-burner-test
    jobType: delete
    waitWhenFinished: true
    objects:
    - kind: Deployment
      labelSelector: {kube-burner-job: delete-me}
      apiVersion: apps/v1
    - kind: Namespace
      labelSelector: {kube-burner-job: delete-me}
</span><span class="no">EOF

</span><span class="c">#</span>
<span class="nv">$ </span>kube-burner init <span class="nt">-c</span> s1-config-delete.yaml <span class="nt">--log-level</span> debug
<span class="c"># &lt;span style="color: green;"&gt;ğŸ‘‰ kube-burner ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ê´€ë ¨ namespace, deployment ë“±ì´ ì‚­ì œë©ë‹ˆë‹¤.&lt;/span&gt;</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">kube-burner init -c s1-config.yaml --log-level debug</code></li>
  <li>
<code class="language-plaintext highlighter-rouge">kube-burner init -c s1-config-delete.yaml --log-level debug</code>
    <ul>
      <li>
<code class="language-plaintext highlighter-rouge">preLoadImages: false</code> ë³€ê²½ í›„ ì‹¤í–‰ â†’ ì°¨ì´ì  í™•ì¸ í›„ ë¦¬ì†ŒìŠ¤ ì‚­ì œ, ì„¤ì •ê°’ì€ ìœ ì§€
        <ul>
          <li>
<strong>ê²°ê³¼ :</strong> ì´ë¯¸ì§€ë¥¼ ë¡œë”©í•˜ëŠ” ì‹œê°„ì„ 30ì´ˆ ê°€ì§€ê³  ìˆì–´ì„œ ëŒ€ê¸°ê°€ ê±¸ë ¸ì—ˆëŠ”ë°, ë°”ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤.</li>
        </ul>
      </li>
      <li>
<code class="language-plaintext highlighter-rouge">waitWhenFinished: false</code> ë³€ê²½ í›„ ì‹¤í–‰ â†’ ì°¨ì´ì  í™•ì¸ í›„ ë¦¬ì†ŒìŠ¤ ì‚­ì œ, ì„¤ì •ê°’ì€ ìœ ì§€
        <ul>
          <li>
<strong>ê²°ê³¼ :</strong> í…ŒìŠ¤íŠ¸ íŒŒë“œê°€ ì˜ ë°°í¬ ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ì§€ ì•Šê³  ë°”ë¡œ ì¢…ë£Œë©ë‹ˆë‹¤.</li>
        </ul>
      </li>
      <li>
<code class="language-plaintext highlighter-rouge">jobIterations: 5</code> ë³€ê²½ í›„ ì‹¤í–‰ â†’ ì°¨ì´ì  í™•ì¸ í›„ ë¦¬ì†ŒìŠ¤ ì‚­ì œ, ì„¤ì •ê°’ì€ ìœ ì§€ <em>â‡’ s1-deployment.yaml íŒŒì¼ í™•ì¸</em>
        <ul>
          <li>
<strong>ê²°ê³¼ :</strong> í…ŒìŠ¤íŠ¸ íŒŒë“œë¥¼ 5ê°œ ë°°í¬í•©ë‹ˆë‹¤. ì´ë•Œ objects.replicasê°€ 1ì´ë¯€ë¡œ replicasëŠ” 1ê°œë¡œ ê³ ì •ë˜ê³ , deploymentê°€ 5ê°œ ìƒì„±ë©ë‹ˆë‹¤.
            <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kubectl get deploy <span class="nt">-A</span> <span class="nt">-l</span> kube-burner-job<span class="o">=</span>delete-me
<span class="c"># =&gt; NAMESPACE            NAME             READY   UP-TO-DATE   AVAILABLE   AGE</span>
<span class="c">#    kube-burner-test-0   deployment-0-1   1/1     1            1           36s</span>
<span class="c">#    kube-burner-test-1   deployment-1-1   1/1     1            1           35s</span>
<span class="c">#    kube-burner-test-2   deployment-2-1   1/1     1            1           34s</span>
<span class="c">#    kube-burner-test-3   deployment-3-1   1/1     1            1           33s</span>
<span class="c">#    kube-burner-test-4   deployment-4-1   1/1     1            1           32s</span>
</code></pre></div>            </div>
          </li>
        </ul>
      </li>
      <li>
<code class="language-plaintext highlighter-rouge">objects.replicas: 2</code> ë³€ê²½ í›„ ì‹¤í–‰ â†’ ì°¨ì´ì  í™•ì¸ í›„ ë¦¬ì†ŒìŠ¤ ì‚­ì œ, ì„¤ì •ê°’ì€ ìœ ì§€ <em>â‡’ s1-deployment.yaml íŒŒì¼ í™•ì¸</em>
        <ul>
          <li>
<strong>ê²°ê³¼ :</strong> í…ŒìŠ¤íŠ¸ íŒŒë“œë¥¼ 5 x 2 = 10ê°œ ë°°í¬í•©ë‹ˆë‹¤. ì´ë•Œ objects.replicasê°€ 2ì´ì§€ë§Œ s1-deployment.yamlì— replicasê°€ 1ë¡œ ê³ ì •ë˜ì–´ ìˆì–´ì„œ replicasëŠ” 1ê°œë¡œ ê³ ì •ë˜ê³ , deploymentê°€ 10ê°œ ìƒì„±ë©ë‹ˆë‹¤.
            <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kubectl get deploy <span class="nt">-A</span> <span class="nt">-l</span> kube-burner-job<span class="o">=</span>delete-me
<span class="c"># =&gt; NAMESPACE            NAME             READY   UP-TO-DATE   AVAILABLE   AGE</span>
<span class="c">#    kube-burner-test-0   deployment-0-1   1/1     1            1           45s</span>
<span class="c">#    kube-burner-test-0   deployment-0-2   1/1     1            1           46s</span>
<span class="c">#    kube-burner-test-1   deployment-1-1   1/1     1            1           43s</span>
<span class="c">#    kube-burner-test-1   deployment-1-2   1/1     1            1           44s</span>
<span class="c">#    kube-burner-test-2   deployment-2-1   1/1     1            1           41s</span>
<span class="c">#    kube-burner-test-2   deployment-2-2   1/1     1            1           42s</span>
<span class="c">#    kube-burner-test-3   deployment-3-1   1/1     1            1           39s</span>
<span class="c">#    kube-burner-test-3   deployment-3-2   1/1     1            1           40s</span>
<span class="c">#    kube-burner-test-4   deployment-4-1   1/1     1            1           37s</span>
<span class="c">#    kube-burner-test-4   deployment-4-2   1/1     1            1           38s</span>
</code></pre></div>            </div>
          </li>
        </ul>
      </li>
      <li>
<code class="language-plaintext highlighter-rouge">jobIterations: 10</code> ë³€ê²½ í›„ ì‹¤í–‰ â†’ ì°¨ì´ì  í™•ì¸ í›„ ë¦¬ì†ŒìŠ¤ ì‚­ì œ, ì„¤ì •ê°’ì€ ìœ ì§€ <em>â‡’ qps: 1 ì˜ë¯¸ íŒŒì•… í•´ë³´ê¸°</em>
        <ul>
          <li>
<strong>ê²°ê³¼ :</strong> í…ŒìŠ¤íŠ¸ íŒŒë“œë¥¼ 10 x 2 = 20ê°œ ë°°í¬í•©ë‹ˆë‹¤. QPSê°€ 1ì´ë¯€ë¡œ ì´ˆë‹¹ 1ê°œì”© ë°°í¬ë©ë‹ˆë‹¤.</li>
        </ul>
      </li>
      <li>
<code class="language-plaintext highlighter-rouge">qps: 10, burst:10</code> ë³€ê²½ í›„ ì‹¤í–‰ â†’ ì°¨ì´ì  í™•ì¸ í›„ ë¦¬ì†ŒìŠ¤ ì‚­ì œ, ì„¤ì •ê°’ì€ ìœ ì§€ <em>â‡’ qps: 10 ì˜ë¯¸ íŒŒì•… í•´ë³´ê¸°</em>
        <ul>
          <li>
<strong>ê²°ê³¼ :</strong> í…ŒìŠ¤íŠ¸ íŒŒë“œë¥¼ 10 x 2 = 20ê°œ ë°°í¬í•©ë‹ˆë‹¤. QPSê°€ 10ì´ë¯€ë¡œ ì´ˆë‹¹ 10ê°œì”© ë°°í¬ë©ë‹ˆë‹¤.</li>
          <li>
<strong>ê²°ê³¼ :</strong> QPSëŠ” ì´ˆë‹¹ (ìƒì„±) ì¿¼ë¦¬ë¡œ 10ì´ë©´ ì´ˆë‹¹ 10ê°œì˜ ìƒì„± ìš”ì²­ì„ ë³´ë‚¼ ìˆ˜ ìˆëŠ”ê²ƒì…ë‹ˆë‹¤. 20ê°œì´ë©´ 2ì´ˆë§Œì— ë°°í¬ê°€ ì™„ë£Œë©ë‹ˆë‹¤.</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>qps ì™€ burst ë™ì‘ íŒŒì•…í•´ë³´ê¸°
    <ul>
      <li>
<code class="language-plaintext highlighter-rouge">jobIterations: 10, qps: 1, burst:10</code> <code class="language-plaintext highlighter-rouge">objects.replicas: 1</code> ë³€ê²½ í›„ ì‹¤í–‰ â†’ ë™ì‘ í™•ì¸ í›„ ë¦¬ì†ŒìŠ¤ ì‚­ì œ
        <ul>
          <li>
<strong>ê²°ê³¼ :</strong> í…ŒìŠ¤íŠ¸ íŒŒë“œë¥¼ 10ê°œ ë°°í¬í•©ë‹ˆë‹¤. QPSê°€ 1ì´ì§€ë§Œ burstê°€ 10ì´ë¯€ë¡œ ìˆœê°„ì ìœ¼ë¡œ 10ê°œê¹Œì§€ ë°°í¬ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.</li>
        </ul>
      </li>
      <li>
<code class="language-plaintext highlighter-rouge">jobIterations: 100, qps: 1, burst:100</code> <code class="language-plaintext highlighter-rouge">objects.replicas: 1</code> ë³€ê²½ í›„ ì‹¤í–‰ â†’ ë™ì‘ í™•ì¸ í›„ ë¦¬ì†ŒìŠ¤ ì‚­ì œ
        <ul>
          <li>
<strong>ê²°ê³¼ :</strong> í…ŒìŠ¤íŠ¸ íŒŒë“œë¥¼ 100ê°œ ë°°í¬í•©ë‹ˆë‹¤. QPSê°€ 1ì´ì§€ë§Œ burstê°€ 100ì´ë¯€ë¡œ ìˆœê°„ì ìœ¼ë¡œ 100ê°œê¹Œì§€ ë°°í¬ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.</li>
        </ul>
      </li>
      <li>
<code class="language-plaintext highlighter-rouge">jobIterations: 10, qps: 1, burst:20</code> <code class="language-plaintext highlighter-rouge">objects.replicas: 2</code> ë³€ê²½ í›„ ì‹¤í–‰ â†’ ë™ì‘ í™•ì¸ í›„ ë¦¬ì†ŒìŠ¤ ì‚­ì œ</li>
      <li>
<code class="language-plaintext highlighter-rouge">jobIterations: 10, qps: 1, burst:10</code> <code class="language-plaintext highlighter-rouge">objects.replicas: 2</code> ë³€ê²½ í›„ ì‹¤í–‰ â†’ ì°¨ì´ì  í™•ì¸ í›„ ë¦¬ì†ŒìŠ¤ ì‚­ì œ
        <ul>
          <li>
<strong>ê²°ê³¼ :</strong> í…ŒìŠ¤íŠ¸ íŒŒë“œë¥¼ 20ê°œ ë°°í¬í•©ë‹ˆë‹¤. QPSê°€ 1ì´ì§€ë§Œ burstê°€ 10ì´ë¯€ë¡œ ìˆœê°„ì ìœ¼ë¡œ 10ê°œê¹Œì§€ ë°°í¬ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤. 10ê°œê¹Œì§€ëŠ” ë°”ë¡œ ë°°í¬ë˜ì§€ë§Œ 11ê°œ ë¶€í„°ëŠ” ì´ˆë‹¹ 1ê°œì”© ë°°í¬ë©ë‹ˆë‹¤.</li>
        </ul>
      </li>
      <li>
<code class="language-plaintext highlighter-rouge">jobIterations: 20, qps: 2, burst:20</code> <code class="language-plaintext highlighter-rouge">objects.replicas: 2</code> ë³€ê²½ í›„ ì‹¤í–‰ â†’ ì°¨ì´ì  í™•ì¸ í›„ ë¦¬ì†ŒìŠ¤ ì‚­ì œ
        <ul>
          <li>
<strong>ê²°ê³¼ :</strong> í…ŒìŠ¤íŠ¸ íŒŒë“œë¥¼ 40ê°œ ë°°í¬í•©ë‹ˆë‹¤. QPSê°€ 2ì´ì§€ë§Œ burstê°€ 20ì´ë¯€ë¡œ ìˆœê°„ì ìœ¼ë¡œ 20ê°œê¹Œì§€ ë°°í¬ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤. 20ê°œê¹Œì§€ëŠ” ë°”ë¡œ ë°°í¬ë˜ì§€ë§Œ 21ê°œ ë¶€í„°ëŠ” ì´ˆë‹¹ 2ê°œì”© ë°°í¬ë©ë‹ˆë‹¤.</li>
        </ul>
      </li>
      <li>ğŸ‘‰ ì¦‰, qpsëŠ” ì´ˆë‹¹ ëª‡ íšŒì˜ ì¿¼ë¦¬ë¥¼ ë³´ë‚´ëŠëƒ, burstëŠ” ìˆœê°„ì ìœ¼ë¡œ ëª‡ íšŒì˜ ì¿¼ë¦¬ë¥¼ ë³´ë‚¼ ìˆ˜ ìˆëŠëƒ ì…ë‹ˆë‹¤.</li>
    </ul>
  </li>
</ul>

<p><img src="/assets/2025/cilium/w7/20250831_cilium_w7_5.png" alt="img.png" class="image-center" loading="lazy" width="642" height="401">
<em class="image-caption">kube-burnerë¡œ pod ê°€ ë°°í¬ë˜ëŠ” í™”ë©´</em></p>

<h4 id="ì‹œë‚˜ë¦¬ì˜¤-2--ë…¸ë“œ-1ëŒ€ì—-ìµœëŒ€-íŒŒë“œ150ê°œ-ë°°í¬-ì‹œë„-1">ì‹œë‚˜ë¦¬ì˜¤ 2 : ë…¸ë“œ 1ëŒ€ì— ìµœëŒ€ íŒŒë“œ(150ê°œ) ë°°í¬ ì‹œë„ 1</h4>
<ul>
  <li><code class="language-plaintext highlighter-rouge">kube-burner init -c s1-config.yaml --log-level debug</code></li>
  <li>
<code class="language-plaintext highlighter-rouge">jobIterations: 100, qps: 300, burst: 300</code> <code class="language-plaintext highlighter-rouge">objects.replicas: 1</code> ë³€ê²½ í›„ ì‹¤í–‰ <em>â†’ ëª¨ë“  íŒŒë“œê°€ ë°°í¬ ë˜ëŠ”ì§€ í™•ì¸</em>
<img src="/assets/2025/cilium/w7/20250831_cilium_w7_6.png" alt="img.png" class="image-center" loading="lazy" width="686" height="490">
<em class="image-caption">6ê°œì˜ íŒŒë“œê°€ Pending ìƒíƒœë¡œ ë‚¨ì•„ìˆëŠ” í™”ë©´</em>
</li>
  <li>
    <p><strong>ë¬¸ì œ ì›ì¸ íŒŒì•…</strong>
<img src="/assets/2025/cilium/w7/20250831_cilium_w7_7.png" alt="img.png" class="image-center" loading="lazy" width="1003" height="283">
<em class="image-caption">K8S NEW ëŒ€ì‹œë³´ë“œ : Nodes with Pod íŒ¨ë„</em></p>

    <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>  <span class="c">#</span>
  <span class="nv">$ </span>kubectl get pod <span class="nt">-A</span> | <span class="nb">grep</span> <span class="nt">-v</span> <span class="s1">'1/1     Running'</span>
  <span class="c"># =&gt; NAMESPACE             NAME                                                        READY   STATUS    RESTARTS       AGE</span>
  <span class="c">#    kube-burner-test-94   deployment-94-1-66c9bd7f46-llbsr                            0/1     Pending   0              3m46s</span>
  <span class="c">#    kube-burner-test-95   deployment-95-1-6877f5c69b-kzdwj                            0/1     Pending   0              3m46s</span>
  <span class="c">#    kube-burner-test-96   deployment-96-1-65468866f4-2lpcw                            0/1     Pending   0              3m46s</span>
  <span class="c">#    kube-burner-test-97   deployment-97-1-58646bddc6-d5shq                            0/1     Pending   0              3m46s</span>
  <span class="c">#    kube-burner-test-98   deployment-98-1-5c4c86c794-25fzm                            0/1     Pending   0              3m46s</span>
  <span class="c">#    kube-burner-test-99   deployment-99-1-567ddbffb4-6qqwc                            0/1     Pending   0              3m45s</span>
  <span class="c">#    monitoring            kube-prometheus-stack-grafana-7d9c86798d-wcp44              3/3     Running   3 (121m ago)   11h</span>
  <span class="c">#    monitoring            prometheus-kube-prometheus-stack-prometheus-0               2/2     Running   2 (121m ago)   11h</span>
      
  <span class="nv">$ </span>kubectl describe pod <span class="nt">-n</span> kube-burner-test-99 | <span class="nb">grep </span>Events: <span class="nt">-A5</span>
  <span class="c"># =&gt; Events:</span>
  <span class="c">#      Type     Reason            Age    From               Message</span>
  <span class="c">#      ----     ------            ----   ----               -------</span>
  <span class="c">#      Warning  FailedScheduling  4m23s  default-scheduler  0/1 nodes are available: 1 &lt;span style="color: green;"&gt;Too many pods&lt;/span&gt;. preemption: 0/1 nodes are available: 1 No preemption victims found for incoming pod.</span>
  <span class="c"># &lt;span style="color: green;"&gt;ğŸ‘‰ íŒŒë“œê°€ ë„ˆë¬´ ë§ì•„ì„œ ìŠ¤ì¼€ì¤„ë§ì´ ì•ˆëœë‹¤ëŠ” ë©”ì‹œì§€ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/span&gt;</span>
      
  <span class="c">#</span>
  <span class="nv">$ </span>kubectl describe node
  <span class="c"># =&gt; ...</span>
  <span class="c">#    Capacity:</span>
  <span class="c">#      cpu:                7</span>
  <span class="c">#      ephemeral-storage:  61255492Ki</span>
  <span class="c">#      hugepages-1Gi:      0</span>
  <span class="c">#      hugepages-2Mi:      0</span>
  <span class="c">#      hugepages-32Mi:     0</span>
  <span class="c">#      hugepages-64Ki:     0</span>
  <span class="c">#      memory:             5035968Ki</span>
  <span class="c">#      pods:               &lt;span style="color: green;"&gt;110&lt;/span&gt;</span>
  <span class="c">#    Allocatable:</span>
  <span class="c">#      cpu:                7</span>
  <span class="c">#      ephemeral-storage:  61255492Ki</span>
  <span class="c">#      hugepages-1Gi:      0</span>
  <span class="c">#      hugepages-2Mi:      0</span>
  <span class="c">#      hugepages-32Mi:     0</span>
  <span class="c">#      hugepages-64Ki:     0</span>
  <span class="c">#      memory:             5035968Ki</span>
  <span class="c">#      pods:               &lt;span style="color: green;"&gt;110&lt;/span&gt;</span>
  <span class="c"># &lt;span style="color: green;"&gt;ğŸ‘‰ í• ë‹¹í•  ìˆ˜ ìˆëŠ” íŒŒë“œ ìˆ˜ê°€ 110ê°œ ê¹Œì§€ì¸ë° í˜„ì¬ íŒŒë“œìˆ˜ê°€ 116ê°œë¡œ ì´ˆê³¼ë˜ì–´ ì´ˆê³¼ëœ 6ê°œ ë§Œí¼ì˜ íŒŒë“œê°€ Pending ìƒíƒœê°€ ë˜ì—ˆìŒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.&lt;/span&gt;</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>í•´ê²°</p>

    <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>  <span class="c"># maxPods í•­ëª© ì—†ìœ¼ë©´ ê¸°ë³¸ê°’ 110ê°œ</span>
  <span class="nv">$ </span>kubectl get cm <span class="nt">-n</span> kube-system kubelet-config <span class="nt">-o</span> yaml | <span class="nb">grep </span>maxPods
  <span class="c"># =&gt; (ì—†ìŒ)</span>
      
  <span class="c">#</span>
  <span class="nv">$ </span>docker <span class="nb">exec</span> <span class="nt">-it</span> myk8s-control-plane bash
  <span class="nt">----------------------------------------</span>
  <span class="nv">$ </span><span class="nb">cat</span> /var/lib/kubelet/config.yaml
      
  <span class="nv">$ </span>apt update <span class="o">&amp;&amp;</span> apt <span class="nb">install </span>vim <span class="nt">-y</span>
  <span class="nv">$ </span>vim /var/lib/kubelet/config.yaml
  <span class="c"># maxPods: 150 ì¶”ê°€</span>
      
  <span class="nv">$ </span>systemctl restart kubelet
  <span class="nv">$ </span>systemctl status kubelet
  <span class="c"># =&gt; â— kubelet.service - kubelet: The Kubernetes Node Agent                                                                                                                                  Loaded: loaded (/etc/systemd/system/kubelet.service; enabled; preset: enabled)</span>
  <span class="c">#        Drop-In: /etc/systemd/system/kubelet.service.d                                                                                                                                              â””â”€10-kubeadm.conf, 11-kind.conf</span>
  <span class="c">#         Active: active (running) since Sat 2025-08-30 02:28:12 UTC; 7s ago                                                                                                                   Docs: http://kubernetes.io/docs/    </span>
  <span class="nv">$ </span><span class="nb">exit</span>
  <span class="nt">----------------------------------------</span>
      
  <span class="c">#</span>
  <span class="nv">$ </span>kubectl describe node
  <span class="c"># =&gt; ...</span>
  <span class="c">#    Capacity:</span>
  <span class="c">#      cpu:                7</span>
  <span class="c">#      ephemeral-storage:  61255492Ki</span>
  <span class="c">#      hugepages-1Gi:      0</span>
  <span class="c">#      hugepages-2Mi:      0</span>
  <span class="c">#      hugepages-32Mi:     0</span>
  <span class="c">#      hugepages-64Ki:     0</span>
  <span class="c">#      memory:             5035968Ki</span>
  <span class="c">#      pods:               &lt;span style="color: green;"&gt;150&lt;/span&gt;</span>
  <span class="c">#    Allocatable:</span>
  <span class="c">#      cpu:                7</span>
  <span class="c">#      ephemeral-storage:  61255492Ki</span>
  <span class="c">#      hugepages-1Gi:      0</span>
  <span class="c">#      hugepages-2Mi:      0</span>
  <span class="c">#      hugepages-32Mi:     0</span>
  <span class="c">#      hugepages-64Ki:     0</span>
  <span class="c">#      memory:             5035968Ki</span>
  <span class="c">#      pods:               &lt;span style="color: green;"&gt;150&lt;/span&gt;</span>
</code></pre></div>    </div>
    <p><img src="/assets/2025/cilium/w7/20250831_cilium_w7_8.png" alt="img.png" loading="lazy" width="994" height="272"></p>
    <ul>
      <li>íŒŒë“œ í•œë„ê°€ 150ê°œë¡œ ëŠ˜ì—ˆê³  ëª¨ë“  íŒŒë“œê°€ ë°°í¬ë˜ì—ˆìŠµë‹ˆë‹¤.</li>
      <li>
<code class="language-plaintext highlighter-rouge">kube-burner init -c s1-config-delete.yaml --log-level debug</code>ë¡œ ë¦¬ì†ŒìŠ¤ ì‚­ì œ</li>
    </ul>
  </li>
</ul>

<h4 id="ì‹œë‚˜ë¦¬ì˜¤-3--ë…¸ë“œ-1ëŒ€ì—-ìµœëŒ€-íŒŒë“œ300ê°œ-ë°°í¬-ì‹œë„-2">ì‹œë‚˜ë¦¬ì˜¤ 3 : ë…¸ë“œ 1ëŒ€ì— ìµœëŒ€ íŒŒë“œ(300ê°œ) ë°°í¬ ì‹œë„ 2</h4>
<ul>
  <li><strong><code class="language-plaintext highlighter-rouge">kube-burner init -c s1-config.yaml --log-level debug</code></strong></li>
  <li>
<code class="language-plaintext highlighter-rouge">jobIterations: **300**, qps: 300, burst: 300</code> <code class="language-plaintext highlighter-rouge">objects.replicas: 1</code> ë³€ê²½ í›„ ì‹¤í–‰ <em>â†’ ëª¨ë“  íŒŒë“œê°€ ë°°í¬ ë˜ëŠ”ì§€ í™•ì¸</em>
</li>
  <li>
    <p><strong>ë¬¸ì œ ì›ì¸ íŒŒì•…</strong></p>

    <p><img src="/assets/2025/cilium/w7/20250831_cilium_w7_9.png" alt="img.png" class="image-center" loading="lazy" width="722" height="243">
<em class="image-caption">K8S NEW ëŒ€ì‹œë³´ë“œ : Pod Number and nodes íŒ¨ë„</em></p>

    <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="c">#</span>
<span class="nv">$ </span>kubectl get pod <span class="nt">-A</span> | <span class="nb">grep</span> <span class="nt">-v</span> <span class="s1">'1/1     Running'</span>
<span class="c"># =&gt; NAMESPACE              NAME                                                        READY   STATUS    RESTARTS       AGE</span>
<span class="c">#    kube-burner-test-134   deployment-134-1-7b94c5f676-z8ptw                           0/1     Pending   0              4m53s</span>
<span class="c">#    kube-burner-test-135   deployment-135-1-57d5cd6644-xlt7r                           0/1     Pending   0              4m53s</span>
<span class="c">#    kube-burner-test-136   deployment-136-1-7bd85d5684-vhdl6                           0/1     Pending   0              4m53s</span>
<span class="c">#    kube-burner-test-137   deployment-137-1-5f5b964756-jc8tk                           0/1     Pending   0              4m53s</span>
<span class="c">#    ...</span>
<span class="c"># &lt;span style="color: green;"&gt;ğŸ‘‰ 167ê°œ ê°€ëŸ‰ì˜ íŒŒë“œê°€ pending ìƒíƒœì…ë‹ˆë‹¤.&lt;/span&gt;</span>
    
<span class="c"># maxPods: 400 ìƒí–¥</span>
<span class="nv">$ </span>docker <span class="nb">exec</span> <span class="nt">-it</span> myk8s-control-plane bash
<span class="nt">----------------------------------------</span>
<span class="nv">$ </span><span class="nb">cat</span> /var/lib/kubelet/config.yaml
    
<span class="nv">$ </span>apt update <span class="o">&amp;&amp;</span> apt <span class="nb">install </span>vim <span class="nt">-y</span>
<span class="nv">$ </span>vim /var/lib/kubelet/config.yaml
<span class="c"># maxPods: 400 ì¶”ê°€</span>
    
<span class="nv">$ </span>systemctl restart kubelet
<span class="nv">$ </span>systemctl status kubelet
<span class="nv">$ </span><span class="nb">exit</span>
<span class="nt">----------------------------------------</span>
    
<span class="c"># </span>
<span class="nv">$ </span>kubectl describe pod <span class="nt">-n</span> kube-burner-test-250 | <span class="nb">grep </span>Events: <span class="nt">-A5</span>
<span class="c"># =&gt; Events:</span>
<span class="c">#      Type     Reason            Age    From               Message</span>
<span class="c">#      ----     ------            ----   ----               -------</span>
<span class="c">#      Warning  FailedScheduling  6m33s  default-scheduler  0/1 nodes are available: 1 Too many pods. preemption: 0/1 nodes are available: 1 No preemption victims found for incoming pod.</span>
<span class="c">#      Warning  FailedScheduling  72s    default-scheduler  0/1 nodes are available: 1 Too many pods. preemption: 0/1 nodes are available: 1 No preemption victims found for incoming pod.</span>
<span class="c">#      Normal   Scheduled         15s    default-scheduler  Successfully assigned kube-burner-test-250/deployment-250-1-6789d5b4bd-hmhjh to myk8s-control-plane</span>
<span class="c"># &lt;span style="color: green;"&gt;ğŸ‘‰ ë°°í¬ê°€ ì˜ ë˜ì—ˆìŠµë‹ˆë‹¤.&lt;/span&gt;</span>
    
<span class="nv">$ </span>kubectl describe pod <span class="nt">-n</span> kube-burner-test-299 | <span class="nb">grep </span>Events: <span class="nt">-A5</span>
<span class="c"># =&gt; Events:</span>
<span class="c">#      Type     Reason            Age   From               Message</span>
<span class="c">#      ----     ------            ----  ----               -------</span>
<span class="c">#      Warning  FailedScheduling  7m1s  default-scheduler  0/1 nodes are available: 1 Too many pods. preemption: 0/1 nodes are available: 1 No preemption victims found for incoming pod.</span>
<span class="c">#      Warning  FailedScheduling  108s  default-scheduler  0/1 nodes are available: 1 Too many pods. preemption: 0/1 nodes are available: 1 No preemption victims found for incoming pod.</span>
<span class="c">#      Normal   Scheduled         52s   default-scheduler  Successfully assigned kube-burner-test-299/deployment-299-1-b7c8c4d9b-g7gwc to myk8s-control-plane</span>
<span class="c"># &lt;span style="color: green;"&gt;ğŸ‘‰ ëª¨ë“  íŒŒë“œê°€ ë°°í¬ê°€ ì˜ ë˜ì—ˆìŠµë‹ˆë‹¤.&lt;/span&gt; </span>
</code></pre></div>    </div>

    <ul>
      <li><strong><code class="language-plaintext highlighter-rouge">kube-burner init -c s1-config-delete.yaml --log-level debug</code></strong></li>
    </ul>
  </li>
</ul>

<h3 id="k8s-performance--tuning">K8S Performance &amp; Tuning</h3>

<h4 id="ëŒ€ê·œëª¨-í´ëŸ¬ìŠ¤í„°-ê³ ë ¤ì‚¬í•­">ëŒ€ê·œëª¨ í´ëŸ¬ìŠ¤í„° ê³ ë ¤ì‚¬í•­</h4>

<h5 id="ê°œìš”-k8s-ê³µì‹-ë¬¸ì„œ">ê°œìš” (<a href="https://kubernetes.io/docs/setup/best-practices/cluster-large/">K8S ê³µì‹ ë¬¸ì„œ</a>)</h5>
<ul>
  <li>
<strong>ìµœëŒ€ ê·œëª¨ (v1.33 ê¸°ì¤€)</strong>
    <ul>
      <li>ë…¸ë“œ: ìµœëŒ€ 5,000ê°œ</li>
      <li>ë…¸ë“œë‹¹ íŒŒë“œ: 110ê°œ ì´í•˜</li>
      <li>íŒŒë“œ: ìµœëŒ€ 150,000ê°œ</li>
      <li>ì»¨í…Œì´ë„ˆ: ìµœëŒ€ 300,000ê°œ</li>
    </ul>
  </li>
  <li>
<strong>ì»¨íŠ¸ë¡¤ í”Œë ˆì¸ ì„¤ê³„</strong>
    <ul>
      <li>ì¥ì•  ì˜ì—­(failure zone)ë§ˆë‹¤ ë¶„ì‚° ë°°ì¹˜</li>
      <li>ë¡œë“œë°¸ëŸ°ì„œë¥¼ í†µí•´ ì¼ë¶€ ì¥ì• ì—ë„ API í˜¸ì¶œ ì •ìƒ ìœ ì§€
<img src="../../../assets/2025/cilium/w7/20250831_cilium_w7_10.svg" alt="20250831_cilium_w7_10.svg" class="image-center" loading="lazy">
<em class="image-caption"><a href="https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/ha-topology/">https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/ha-topology/</a></em>
</li>
    </ul>
  </li>
  <li>
<strong>etcd ìŠ¤í† ë¦¬ì§€ ë¶„ë¦¬</strong>
    <ul>
      <li>ì´ë²¤íŠ¸ ê°ì²´ ì „ìš© etcd ì‚¬ìš© ê¶Œì¥</li>
      <li>ë©”ì¸ etcd ë¶€í•˜ ì™„í™” ë° ì„±ëŠ¥ í–¥ìƒ
<img src="../../../assets/2025/cilium/w7/20250831_cilium_w7_11.svg" alt="20250831_cilium_w7_11.svg" class="image-center" loading="lazy">
</li>
    </ul>
  </li>
</ul>

<h5 id="control-plane-êµ¬ì„±-ìš”ì†Œì™€-íŠ¹ì§•">Control Plane êµ¬ì„± ìš”ì†Œì™€ íŠ¹ì§•</h5>
<ul>
  <li>ì°¸ê³  : ì“°ê¸°ë§Œ í–ˆë˜ ê°œë°œìê°€ ê¶ê¸ˆí•´ì„œ ì°¾ì•„ë³¸ ì¿ ë²„ë„¤í‹°ìŠ¤ ë‚´ë¶€ 1í¸ - <a href="https://tech.kakaopay.com/post/jack-k8s-internals-part-1/">Link</a>, 2í¸* - <a href="https://tech.kakaopay.com/post/jack-k8s-internals-part-2/">Link</a>
<img src="/assets/2025/cilium/w7/20250831_cilium_w7_12.png" alt="img.png" class="image-center" loading="lazy" width="790" height="525">
<em class="image-caption">ì¶œì²˜ : <a href="https://tech.kakaopay.com/post/jack-k8s-internals-part-2/">ì“°ê¸°ë§Œ í–ˆë˜ ê°œë°œìê°€ ê¶ê¸ˆí•´ì„œ ì°¾ì•„ë³¸ ì¿ ë²„ë„¤í‹°ìŠ¤ ë‚´ë¶€</a></em>
</li>
  <li>ì°¸ê³  : K8S Controlplane ì£½ì´ê¸° ğŸ‘ğŸ» - <a href="https://iwanhae.tistory.com/m/2">Blog</a>
</li>
  <li>K8S í•µì‹¬ êµ¬ì„±ìš”ì†Œ
    <ul>
      <li>
<strong>kube-apiserver</strong>
        <ul>
          <li>RESTful API ì„œë²„</li>
          <li>í´ë¼ì´ì–¸íŠ¸ì™€ í†µì‹  (<code class="language-plaintext highlighter-rouge">kubectl</code>, <code class="language-plaintext highlighter-rouge">kubelet</code> ë“±)</li>
        </ul>
      </li>
      <li>
<strong>etcd</strong>
        <ul>
          <li>ë¶„ì‚° Key-Value DB</li>
          <li>RAFT í•©ì˜ ê¸°ë°˜ìœ¼ë¡œ ì•ˆì •ì  ë™ì‘</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>
<strong>ì¥ì </strong>
    <ul>
      <li>ë°ì´í„° ì†ìƒ/ì¼ê´€ì„± ë¬¸ì œ ê±°ì˜ ì—†ìŒ</li>
      <li>ì•ˆì •ì„± ìš°ì„  ì„¤ê³„</li>
    </ul>
  </li>
  <li>
<strong>ë‹¨ì </strong>
    <ul>
      <li>ëŒ€ê·œëª¨ í™˜ê²½ì—ì„œ ì„±ëŠ¥ ì €í•˜
        <ul>
          <li>íŒŒë“œê°€ 100ê°œì¼ë•Œ íŒŒë“œ ì¡°íšŒì‹œ 0.031ì´ˆ, íŒŒë“œê°€ 10000ê°œì¼ë•Œ 2ì´ˆ ì†Œìš”ë¡œ íŒŒë“œê°€ ë§ì•„ì§ˆ ìˆ˜ë¡ ê¸‰ê²©íˆ ì„±ëŠ¥ì´ ì €í•˜ë©ë‹ˆë‹¤.</li>
          <li>ìš”ì²­ì‹œ ë°›ì•„ì§€ëŠ” ìš©ëŸ‰ë„ 100ê°œì¼ë•Œ 0.45MB, 10000ê°œì¼ë•Œ 44.4MBë¡œ ê¸‰ê²©íˆ ì¦ê°€í•©ë‹ˆë‹¤.</li>
        </ul>
      </li>
      <li>ìš”ì²­ë‹¹ ë©”ëª¨ë¦¬ ì†Œë¹„ëŸ‰ì´ í¼</li>
      <li>íŒŒë“œ ìˆ˜ê°€ ë§ì„ìˆ˜ë¡ ì‘ë‹µ ì§€ì—°, ì‘ë‹µ í¬ê¸° í­ì¦</li>
    </ul>
  </li>
</ul>

<h5 id="ë¬¸ì œ-ë°œìƒ-ì˜ˆì‹œ">ë¬¸ì œ ë°œìƒ ì˜ˆì‹œ</h5>
<ul>
  <li>
<strong>ë¦¬ì†ŒìŠ¤ ê³¼ë‹¤ì‚¬ìš© ì‚¬ë¡€</strong>
    <ul>
      <li>Airflow, Kubeflow ë“± â†’ Podê°€ ìë™ ì‚­ì œë˜ì§€ ì•Šê³  ëˆ„ì </li>
      <li>ìˆ˜ì²œ ê°œ ì´ìƒ ìŒ“ì´ë©´ ì¡°íšŒ ìš”ì²­ ì‹œ ë¶€í•˜ ê¸‰ì¦</li>
    </ul>
  </li>
  <li>
<strong>ë™ì‹œ ìš”ì²­ ê³¼ë‹¤</strong>
    <ul>
      <li>kubelet, kube-proxy, CNI ì—ì´ì „íŠ¸ ë“± ë…¸ë“œ ê¸°ë°˜ ì»¨íŠ¸ë¡¤ëŸ¬</li>
      <li>ë„¤íŠ¸ì›Œí¬ ëŠê¹€/ì¬ì—°ê²° ì‹œ ëŒ€ëŸ‰ì˜ List ìš”ì²­ ë°œìƒ</li>
      <li>
<code class="language-plaintext highlighter-rouge">spec.nodeName</code> ë“±ì— ì¸ë±ìŠ¤ ë¶€ì¬ â†’ etcd ì „ì²´ ìŠ¤ìº” ë°œìƒ</li>
    </ul>
  </li>
</ul>

<h5 id="í•´ê²°-ë°©ë²•">í•´ê²° ë°©ë²•</h5>
<ul>
  <li>
<strong>API ê´€ì </strong>
    <ul>
      <li>
<code class="language-plaintext highlighter-rouge">limit</code> / <code class="language-plaintext highlighter-rouge">continue</code> í™œìš© â†’ í•œë²ˆì— ìµœëŒ€ 500ê°œì”© ì¡°íšŒ</li>
      <li>
<code class="language-plaintext highlighter-rouge">resourceVersion=0</code> í™œìš© â†’ apiserver ìºì‹œ í™œìš©, etcd ë¶€í•˜ ì™„í™”</li>
      <li>API Priority and Fairness(APF) â†’ íŠ¹ì • ìš”ì²­ë§Œ Rate Limit ì ìš©</li>
    </ul>
  </li>
  <li>
<strong>ìš´ì˜ ê´€ì </strong>
    <ul>
      <li>ë¶ˆí•„ìš”í•œ Pod, ì´ë²¤íŠ¸ ë¦¬ì†ŒìŠ¤ ì£¼ê¸°ì  ì •ë¦¬</li>
      <li>CronJob, Job ë“± ë‹¨ë°œì„± ì›Œí¬ë¡œë“œ Pod ìë™ ì‚­ì œ ì„¤ì •</li>
      <li>ì´ë²¤íŠ¸ ì „ìš© etcd ì‚¬ìš©í•˜ì—¬ ë©”ì¸ í´ëŸ¬ìŠ¤í„° ë¶€í•˜ ë¶„ì‚°</li>
    </ul>
  </li>
</ul>

<h5 id="openai-ì‚¬ë¡€">OpenAI ì‚¬ë¡€</h5>
<ul>
  <li>
<strong>2500 ë…¸ë“œ (2018)</strong>
    <ul>
      <li>500ë…¸ë“œ ì´í›„ kubectl timeout ë°œìƒ</li>
      <li>etcd ë„¤íŠ¸ì›Œí¬ ìŠ¤í† ë¦¬ì§€ â†’ ë¡œì»¬ SSDë¡œ ë³€ê²½ â†’ ì§€ì—° 200Âµs ê°ì†Œ</li>
      <li>Fluentd, Datadog ê¸°ë³¸ ì„¤ì • â†’ ê³¼ë„í•œ API í˜¸ì¶œ ì›ì¸ â†’ ìˆ˜ì • í›„ ì•ˆì •í™”</li>
      <li>ì´ë²¤íŠ¸ ì €ì¥ì†Œë¥¼ ë©”ì¸ etcdì™€ ë¶„ë¦¬ â†’ ì„±ëŠ¥ ê°œì„ </li>
    </ul>
  </li>
  <li>
<strong>7500 ë…¸ë“œ (2021)</strong>
    <ul>
      <li>API ì„œë²„, etcd ê°ê° ì „ìš© ì„œë²„(dedicated)ì—ì„œ ì‹¤í–‰</li>
      <li>API ì„œë²„ 5ëŒ€, etcd 5ëŒ€ â†’ ë¶€í•˜ ë¶„ì‚° ë° ì¥ì•  ëŒ€ë¹„</li>
      <li>ë…¸ë“œ ë³€ê²½ ì‹œ Endpoints Watch íŠ¸ë˜í”½ 1GB/s ë°œìƒ</li>
      <li>
<code class="language-plaintext highlighter-rouge">EndpointSlice</code> ê¸°ëŠ¥ìœ¼ë¡œ ë¶€í•˜ 1/1000 ìˆ˜ì¤€ìœ¼ë¡œ ê°ì†Œ</li>
      <li>API ì„œë²„ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰: ì„œë²„ë‹¹ 70GB ì´ìƒ í™ ë©”ëª¨ë¦¬</li>
    </ul>
  </li>
</ul>

<h4 id="ì‹œë‚˜ë¦¬ì˜¤-4-api-intensive---íŒŒë“œë¥¼-ìƒì„±configmap-secret-í›„-ì‚­ì œ">ì‹œë‚˜ë¦¬ì˜¤ 4. api-intensive - íŒŒë“œë¥¼ ìƒì„±(configmap, secret) í›„ ì‚­ì œ</h4>

<ul>
  <li>ì´ë²ˆì—ëŠ” kube-apiserverê°€ íŒŒë“œë¥¼ ìƒì„±í• ë•Œ secretê³¼ configmapì„ ë§ˆìš´íŠ¸í•˜ê³ , ì‚­ì œí•˜ëŠ” ë™ì‘ì˜ ë¶€í•˜ë¥¼ ë°œìƒì‹œì¼œë³´ê² ìŠµë‹ˆë‹¤.</li>
  <li>QPS/Burstë¥¼ í´ëŸ¬ìŠ¤í„° í¬ê¸°ì— ë§ê²Œ ì¡°ì ˆí•  í•„ìš”ê°€ ìˆìŠµë‹ˆë‹¤.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#</span>
<span class="nv">$ </span>tree examples/workloads/api-intensive
<span class="c"># =&gt; examples/workloads/api-intensive</span>
<span class="c">#    â”œâ”€â”€ api-intensive.yml</span>
<span class="c">#    â””â”€â”€ templates</span>
<span class="c">#        â”œâ”€â”€ configmap.yaml</span>
<span class="c">#        â”œâ”€â”€ deployment_patch_add_label.json</span>
<span class="c">#        â”œâ”€â”€ deployment_patch_add_label.yaml</span>
<span class="c">#        â”œâ”€â”€ deployment_patch_add_pod_2.yaml</span>
<span class="c">#        â”œâ”€â”€ deployment.yaml</span>
<span class="c">#        â”œâ”€â”€ secret.yaml</span>
<span class="c">#        â””â”€â”€ service.yaml</span>

<span class="nv">$ </span><span class="nb">cd </span>examples/workloads/api-intensive

<span class="c">#</span>
<span class="nv">$ </span><span class="nb">cat</span> <span class="o">&lt;&lt;</span> <span class="no">EOF</span><span class="sh"> &gt; api-intensive-100.yml
jobs:
  - name: api-intensive
    jobIterations: 100
    qps: 100
    burst: 100
    namespacedIterations: true
    namespace: api-intensive
    podWait: false
    cleanup: true
    waitWhenFinished: true
    preLoadImages: false # true
    objects:
      - objectTemplate: templates/deployment.yaml
        replicas: 1
      - objectTemplate: templates/configmap.yaml
        replicas: 1
      - objectTemplate: templates/secret.yaml
        replicas: 1
      - objectTemplate: templates/service.yaml
        replicas: 1

  - name: api-intensive-patch
    jobType: patch
    jobIterations: 10
    qps: 100
    burst: 100
    objects:
      - kind: Deployment
        objectTemplate: templates/deployment_patch_add_label.json
        labelSelector: {kube-burner-job: api-intensive}
        patchType: "application/json-patch+json"
        apiVersion: apps/v1
      - kind: Deployment
        objectTemplate: templates/deployment_patch_add_pod_2.yaml
        labelSelector: {kube-burner-job: api-intensive}
        patchType: "application/apply-patch+yaml"
        apiVersion: apps/v1
      - kind: Deployment
        objectTemplate: templates/deployment_patch_add_label.yaml
        labelSelector: {kube-burner-job: api-intensive}
        patchType: "application/strategic-merge-patch+json"
        apiVersion: apps/v1

  - name: api-intensive-remove
    qps: 500
    burst: 500
    jobType: delete
    waitForDeletion: true
    objects:
      - kind: Deployment
        labelSelector: {kube-burner-job: api-intensive}
        apiVersion: apps/v1

  - name: ensure-pods-removal
    qps: 100
    burst: 100
    jobType: delete
    waitForDeletion: true
    objects:
      - kind: Pod
        labelSelector: {kube-burner-job: api-intensive}

  - name: remove-services
    qps: 100
    burst: 100
    jobType: delete
    waitForDeletion: true
    objects:
      - kind: Service
        labelSelector: {kube-burner-job: api-intensive}

  - name: remove-configmaps-secrets
    qps: 100
    burst: 100
    jobType: delete
    objects:
      - kind: ConfigMap
        labelSelector: {kube-burner-job: api-intensive}
      - kind: Secret
        labelSelector: {kube-burner-job: api-intensive}

  - name: remove-namespace
    qps: 100
    burst: 100
    jobType: delete
    waitForDeletion: true
    objects:
      - kind: Namespace
        labelSelector: {kube-burner-job: api-intensive}
</span><span class="no">EOF

</span><span class="c"># ìˆ˜í–‰</span>
<span class="nv">$ </span>kube-burner init <span class="nt">-c</span> api-intensive-100.yml <span class="nt">--log-level</span> debug
<span class="c"># =&gt; ...</span>
<span class="c">#    time="2025-08-30 12:29:33" level=debug msg="Removing Pod/api-intensive-1-7f8b8bf658-kbtsg from namespace api-intensive-76" file="delete.go:55"</span>
<span class="c">#    time="2025-08-30 12:29:33" level=debug msg="Removing Pod/api-intensive-1-85bd5f8658-sfvmt from namespace api-intensive-76" file="delete.go:55"</span>
<span class="c">#    time="2025-08-30 12:29:33" level=debug msg="Removing Pod/api-intensive-1-68c7855c5-b7qx9 from namespace api-intensive-66" file="delete.go:55"</span>
<span class="c">#    time="2025-08-30 12:29:34" level=debug msg="Waiting for 206 pods labeled with kube-burner-job=api-intensive to be deleted" file="delete.go:79"</span>
<span class="c">#    time="2025-08-30 12:29:36" level=debug msg="Waiting for 219 pods labeled with kube-burner-job=api-intensive to be deleted" file="delete.go:79"</span>
<span class="c">#    time="2025-08-30 12:29:38" level=debug msg="Waiting for 233 pods labeled with kube-burner-job=api-intensive to be deleted" file="delete.go:79"</span>
<span class="c">#    time="2025-08-30 12:29:40" level=debug msg="Waiting for 251 pods labeled with kube-burner-job=api-intensive to be deleted" file="delete.go:79"</span>
<span class="c">#    ...</span>
<span class="c"># &lt;span style="color: green;"&gt;ğŸ‘‰ kube-apiserverì— ìš”ì²­ì´ ìŒ“ì´ë©´ì„œ êµ‰ì¥íˆ ëŠë ¤ì§‘ë‹ˆë‹¤.&lt;/span&gt;</span>
<span class="c"># &lt;span style="color: green;"&gt;ğŸ‘‰ ì›¨ì´íŒ…ë„ ê±¸ë¦½ë‹ˆë‹¤.&lt;/span&gt;</span>
</code></pre></div></div>

<p><img src="/assets/2025/cilium/w7/20250831_cilium_w7_15.png" alt="img_1.png" class="image-center" loading="lazy" width="1007" height="814">
<em class="image-caption">kube-burnerë¡œ apiserver ìš”ì²­ì´ ê¸‰ì¦í•˜ë©´ì„œ apiserverì™€ etcd ì§€ì—° ê¸‰ê²©íˆ ì¦ê°€</em></p>

<ul>
  <li>ì´ë²ˆì—ëŠ” QPS/Burstë¥¼ 500ìœ¼ë¡œ ëŠ˜ë ¤ì„œ ë‹¤ì‹œ ìˆ˜í–‰í•´ë³´ê² ìŠµë‹ˆë‹¤.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cat</span> <span class="o">&lt;&lt;</span> <span class="no">EOF</span><span class="sh"> &gt; api-intensive-500.yml
jobs:
  - name: api-intensive
    jobIterations: 100
    qps: 500
    burst: 500
    namespacedIterations: true
    namespace: api-intensive
    podWait: false
    cleanup: true
    waitWhenFinished: true
    preLoadImages: false # true
    objects:
      - objectTemplate: templates/deployment.yaml
        replicas: 1
      - objectTemplate: templates/configmap.yaml
        replicas: 1
      - objectTemplate: templates/secret.yaml
        replicas: 1
      - objectTemplate: templates/service.yaml
        replicas: 1

  - name: api-intensive-patch
    jobType: patch
    jobIterations: 10
    qps: 500
    burst: 500
    objects:
      - kind: Deployment
        objectTemplate: templates/deployment_patch_add_label.json
        labelSelector: {kube-burner-job: api-intensive}
        patchType: "application/json-patch+json"
        apiVersion: apps/v1
      - kind: Deployment
        objectTemplate: templates/deployment_patch_add_pod_2.yaml
        labelSelector: {kube-burner-job: api-intensive}
        patchType: "application/apply-patch+yaml"
        apiVersion: apps/v1
      - kind: Deployment
        objectTemplate: templates/deployment_patch_add_label.yaml
        labelSelector: {kube-burner-job: api-intensive}
        patchType: "application/strategic-merge-patch+json"
        apiVersion: apps/v1

  - name: api-intensive-remove
    qps: 500
    burst: 500
    jobType: delete
    waitForDeletion: true
    objects:
      - kind: Deployment
        labelSelector: {kube-burner-job: api-intensive}
        apiVersion: apps/v1

  - name: ensure-pods-removal
    qps: 500
    burst: 500
    jobType: delete
    waitForDeletion: true
    objects:
      - kind: Pod
        labelSelector: {kube-burner-job: api-intensive}

  - name: remove-services
    qps: 500
    burst: 500
    jobType: delete
    waitForDeletion: true
    objects:
      - kind: Service
        labelSelector: {kube-burner-job: api-intensive}

  - name: remove-configmaps-secrets
    qps: 500
    burst: 500
    jobType: delete
    objects:
      - kind: ConfigMap
        labelSelector: {kube-burner-job: api-intensive}
      - kind: Secret
        labelSelector: {kube-burner-job: api-intensive}

  - name: remove-namespace
    qps: 500
    burst: 500
    jobType: delete
    waitForDeletion: true
    objects:
      - kind: Namespace
        labelSelector: {kube-burner-job: api-intensive}
</span><span class="no">EOF

</span><span class="c"># ìˆ˜í–‰</span>
<span class="nv">$ </span>kube-burner init <span class="nt">-c</span> api-intensive-500.yml <span class="nt">--log-level</span> debug
</code></pre></div></div>

<p><img src="/assets/2025/cilium/w7/20250831_cilium_w7_16.png" alt="img.png" loading="lazy" width="1008" height="803"></p>

<h4 id="kubernetes-api-ì„±ëŠ¥-ë©”íŠ¸ë¦­--ì˜ˆì œì™€-best-practice---blog">Kubernetes API ì„±ëŠ¥ ë©”íŠ¸ë¦­ : ì˜ˆì œì™€ Best Practice - <a href="https://www.redhat.com/en/blog/kubernetes-api-performance-metrics-examples-and-best-practices">Blog</a>
</h4>

<ul>
  <li>Kubernetesì—ì„œ ì¼ë°˜ì ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ ì›Œí¬ë¡œë“œ ë°°í¬ ê³¼ì •
<img src="/assets/2025/cilium/w7/20250831_cilium_w7_14.png" alt="img.png" class="image-center" loading="lazy" width="1170" height="593">
    <ul>
      <li>ì‚¬ìš©ìëŠ” REST APIë‚˜ ëª…ë ¹ì¤„ì„ ì‚¬ìš©í•˜ì—¬ ë°°í¬ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.</li>
      <li>API Server (<a href="https://kubernetes.io/docs/reference/generated/kube-apiserver/">kube-apiserver</a>)ê°€ Deployment ëª…ì„¸ì„œë¥¼ etcdì— ê¸°ë¡í•©ë‹ˆë‹¤.</li>
      <li>DeploymentControllerëŠ” ìƒˆë¡œìš´ Deploymentsë¥¼ watchesí•˜ì—¬ ì´ë²¤íŠ¸ë¥¼ ìƒì„±í•˜ê³  Deployment Specì— ë§ì¶° ì¡°ì •í•˜ê³  ReplicaSet ë§¤ë‹ˆí˜ìŠ¤íŠ¸ë¥¼ ìƒì„±í•œ ë‹¤ìŒ ì´ë¥¼ API ì„œë²„ì— ê²Œì‹œí•˜ê³  ReplicaSet ì‚¬ì–‘ì„ etcdì— ê¸°ë¡í•©ë‹ˆë‹¤.</li>
      <li>ReplicaSet ì»¨íŠ¸ë¡¤ëŸ¬ëŠ”Â ReplicaSet ìƒì„±Â ì´ë²¤íŠ¸ë¥¼ ê°ì‹œí•˜ê³  ìƒˆ Pod ë§¤ë‹ˆí˜ìŠ¤íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. ë§¤ë‹ˆí˜ìŠ¤íŠ¸ë¥¼ API ì„œë²„ì— ê²Œì‹œí•˜ê³  Pod ì‚¬ì–‘ì„ etcdì— ê¸°ë¡í•©ë‹ˆë‹¤.</li>
      <li>ìŠ¤ì¼€ì¥´ëŸ¬ëŠ” íŒŒë“œ ìƒì„± ì´ë²¤íŠ¸ë¥¼ ê°ì‹œí•˜ê³  ë°”ì¸ë”©ë˜ì§€ ì•Šì€ íŒŒë“œë¥¼ ê°ì§€í•©ë‹ˆë‹¤. íŒŒë“œë¥¼ ìŠ¤ì¼€ì¤„ë§í•˜ê³  íŒŒë“œì˜ ë…¸ë“œ ë°”ì¸ë”©ì„ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.</li>
      <li>ë…¸ë“œì—ì„œ ì‹¤í–‰ë˜ëŠ” Kubeletì€ ìƒˆë¡œìš´ Pod ìŠ¤ì¼€ì¤„ë§ì„ ê°ì§€í•˜ê³  ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„(ì˜ˆ: cri-o)ì„ ì‚¬ìš©í•˜ì—¬ ì´ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.</li>
      <li>Kubeletì€ ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„ì„ í†µí•´ Pod ìƒíƒœë¥¼ ê²€ìƒ‰í•˜ì—¬ API ì„œë²„ì— ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.</li>
    </ul>
  </li>
  <li>API ì„±ëŠ¥ ê´€ë ¨ ì£¼ìš” ë©”íŠ¸ë¦­
    <ul>
      <li>
<code class="language-plaintext highlighter-rouge">apiserver_request_total</code> : API ì„œë²„ì— ëŒ€í•œ ì´ ìš”ì²­ ìˆ˜</li>
      <li>
<code class="language-plaintext highlighter-rouge">rate(apiserver_request_total{job="apiserver"}[5m])</code> : ì§€ë‚œ 5ë¶„ ë™ì•ˆì˜ API ì„œë²„ ìš”ì²­ ì´ˆë‹¹ í‰ê·  ì¦ê°€ìœ¨</li>
      <li>
<code class="language-plaintext highlighter-rouge">irate(apiserver_request_total{job="apiserver"}[5m])</code> : ì§€ë‚œ 5ë¶„ ë™ì•ˆì˜ API ì„œë²„ ìš”ì²­ ì´ˆë‹¹ ìˆœê°„ ì¦ê°€ìœ¨</li>
      <li>ì‹¤ìŠµ (Prometheusì—ì„œ ì‹¤ìŠµ)
        <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="c"># ì—°ìŠµ1 : ë¼ë²¨(label) ê³¼ ê°’(value) í™•ì¸</span>
apiserver_request_total
rate<span class="o">(</span>apiserver_request_total<span class="o">{</span><span class="nv">job</span><span class="o">=</span><span class="s2">"apiserver"</span><span class="o">}[</span>5m]<span class="o">)</span>
irate<span class="o">(</span>apiserver_request_total<span class="o">{</span><span class="nv">job</span><span class="o">=</span><span class="s2">"apiserver"</span><span class="o">}[</span>5m]<span class="o">)</span>
    
<span class="c"># ì—°ìŠµ2</span>
<span class="nb">sum </span>by<span class="o">(</span>code<span class="o">)</span> <span class="o">(</span>irate<span class="o">(</span>apiserver_request_total<span class="o">{</span><span class="nv">job</span><span class="o">=</span><span class="s2">"apiserver"</span><span class="o">}[</span>5m]<span class="o">))</span> <span class="c"># codeë¡œ grouping</span>
<span class="nb">sum </span>by<span class="o">(</span>verb<span class="o">)</span> <span class="o">(</span>irate<span class="o">(</span>apiserver_request_total<span class="o">{</span><span class="nv">job</span><span class="o">=</span><span class="s2">"apiserver"</span><span class="o">}[</span>5m]<span class="o">))</span> <span class="c"># verbë¡œ grouping</span>
<span class="nb">sum </span>by<span class="o">(</span>resource<span class="o">)</span> <span class="o">(</span>irate<span class="o">(</span>apiserver_request_total<span class="o">{</span><span class="nv">job</span><span class="o">=</span><span class="s2">"apiserver"</span><span class="o">}[</span>5m]<span class="o">))</span> <span class="c"># resourceë¡œ grouping</span>
<span class="nb">sum </span>by<span class="o">(</span>resource, code, verb<span class="o">)</span> <span class="o">(</span>irate<span class="o">(</span>apiserver_request_total<span class="o">{</span><span class="nv">job</span><span class="o">=</span><span class="s2">"apiserver"</span><span class="o">}[</span>5m]<span class="o">))</span> <span class="c"># resource, code, verbë¡œ grouping</span>
    
<span class="c"># ì—°ìŠµ3 : resource ê°’ ì—†ëŠ” ê²ƒ ì œì™¸</span>
topk<span class="o">(</span>3, <span class="nb">sum </span>by<span class="o">(</span>resource<span class="o">)</span> <span class="o">(</span>irate<span class="o">(</span>apiserver_request_total<span class="o">{</span><span class="nv">job</span><span class="o">=</span><span class="s2">"apiserver"</span><span class="o">}[</span>5m]<span class="o">)))</span>
topk<span class="o">(</span>3, <span class="nb">sum </span>by<span class="o">(</span>resource<span class="o">)</span> <span class="o">(</span>irate<span class="o">(</span>apiserver_request_total<span class="o">{</span><span class="nv">resource</span><span class="o">=</span>~<span class="s2">".+"</span><span class="o">}[</span>5m]<span class="o">)))</span>
    
<span class="c"># ì—°ìŠµ3 : 4xx, 5xx ì‘ë‹µ ì½”ë“œë§Œ í•„í„°ë§</span>
<span class="nb">sum </span>by<span class="o">(</span>code<span class="o">)</span> <span class="o">(</span>rate<span class="o">(</span>apiserver_request_total<span class="o">{</span><span class="nv">code</span><span class="o">=</span>~<span class="s2">"[45].."</span><span class="o">}[</span>1m]<span class="o">))</span>
    
<span class="c"># ìµœì¢…</span>
<span class="nb">sum </span>by<span class="o">(</span>resource, code, verb<span class="o">)</span> <span class="o">(</span>rate<span class="o">(</span>apiserver_request_total<span class="o">{</span><span class="nv">resource</span><span class="o">=</span>~<span class="s2">".+"</span><span class="o">}[</span>5m]<span class="o">))</span>
or
<span class="nb">sum </span>by<span class="o">(</span>resource, code, verb<span class="o">)</span> <span class="o">(</span>irate<span class="o">(</span>apiserver_request_total<span class="o">{</span><span class="nv">resource</span><span class="o">=</span>~<span class="s2">".+"</span><span class="o">}[</span>5m]<span class="o">))</span>
</code></pre></div>        </div>
        <p><img src="/assets/2025/cilium/w7/20250831_cilium_w7_17.png" alt="img.png" loading="lazy" width="1392" height="878"></p>
      </li>
    </ul>
  </li>
  <li>
<strong>[Tuning] API ì„œë²„ flag</strong> : max-requests-inflight (ê¸°ë³¸ê°’ 400) , max-mutating-requests-inflight (ê¸°ë³¸ê°’ 200) - <a href="https://aws.github.io/aws-eks-best-practices/ko/scalability/docs/control-plane/">Docs</a>, <a href="https://docs.ocha.ng/kubernetes/apf">APF</a>
    <ul>
      <li>API ì„œë²„ëŠ”Â <code class="language-plaintext highlighter-rouge">--max-requests-inflight</code>Â query-type(get,list,watchâ€¦)ë°Â <code class="language-plaintext highlighter-rouge">--max-mutating-requests-inflight</code>Â mutating-type(create,update,deleteâ€¦) í”Œë˜ê·¸ë¡œ ì§€ì •ëœ ê°’ì„ í•©ì‚°í•˜ì—¬ í—ˆìš©í•  ìˆ˜ ìˆëŠ” ì´ ì§„í–‰ ì¤‘ì¸ ìš”ì²­ ìˆ˜ë¥¼ êµ¬ì„±í•©ë‹ˆë‹¤.</li>
      <li>AWS EKSëŠ” ì´ëŸ¬í•œ í”Œë˜ê·¸ì— ëŒ€í•´ ê¸°ë³¸ê°’ì¸ 400ê°œ ë° 200ê°œ ìš”ì²­ì„ ì‚¬ìš©í•˜ë¯€ë¡œ ì£¼ì–´ì§„ ì‹œê°„ì— ì´ 600ê°œì˜ ìš”ì²­ì„ ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
      <li>APFëŠ” ì´ëŸ¬í•œ 600ê°œì˜ ìš”ì²­ì„ ë‹¤ì–‘í•œ ìš”ì²­ ìœ í˜•ìœ¼ë¡œ ë‚˜ëˆ„ëŠ” ë°©ë²•ì„ ì§€ì •í•©ë‹ˆë‹¤.</li>
      <li>AWS EKS ì»¨íŠ¸ë¡¤ í”Œë ˆì¸ì€ ê° í´ëŸ¬ìŠ¤í„°ì— ìµœì†Œ 2ê°œì˜ API ì„œë²„ê°€ ë“±ë¡ë˜ì–´ ìˆì–´ ê°€ìš©ì„±ì´ ë†’ìŠµë‹ˆë‹¤.</li>
      <li>
        <p>ì´ë ‡ê²Œ í•˜ë©´ í´ëŸ¬ìŠ¤í„° ì „ì²´ì˜ ì´ ì§„í–‰ ì¤‘ì¸ ìš”ì²­ ìˆ˜ê°€ 1200ê°œë¡œ ëŠ˜ì–´ë‚©ë‹ˆë‹¤.</p>

        <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="c">#</span>
<span class="nv">$ </span>kubectl <span class="nb">exec</span> <span class="nt">-it</span> <span class="nt">-n</span> kube-system kube-apiserver-myk8s-control-plane <span class="nt">--</span> kube-apiserver <span class="nt">-h</span>
<span class="c"># =&gt; ...</span>
<span class="c">#          --max-mutating-requests-inflight int                                                                </span>
<span class="c">#                    This and --max-requests-inflight are summed to determine the server's total concurrency limit (which</span>
<span class="c">#                    must be positive) if --enable-priority-and-fairness is true. Otherwise, this flag limits the maximum</span>
<span class="c">#                    number of mutating requests in flight, or a zero value disables the limit completely. (default 200)</span>
<span class="c">#          --max-requests-inflight int                                                                                </span>
<span class="c">#                    This and --max-mutating-requests-inflight are summed to determine the server's total concurrency</span>
<span class="c">#                    limit (which must be positive) if --enable-priority-and-fairness is true. Otherwise, this flag</span>
<span class="c">#                    limits the maximum number of non-mutating requests in flight, or a zero value disables the limit</span>
<span class="c">#                    completely. (default 400)</span>
<span class="c">#          --min-request-timeout int                                                                                  </span>
<span class="c">#                    An optional field indicating the minimum number of seconds a handler must keep a request open before</span>
<span class="c">#                    timing it out. Currently only honored by the watch request handler, which picks a randomized value</span>
<span class="c">#                    above this number as the connection timeout, to spread out load. (default 1800)</span>
<span class="c">#          --request-timeout duration                                                                                 </span>
<span class="c">#                    An optional field indicating the duration a handler must keep a request open before timing it out.</span>
<span class="c">#                    This is the default request timeout for requests but may be overridden by flags such as</span>
<span class="c">#                    --min-request-timeout for specific types of requests. (default 1m0s)</span>
</code></pre></div>        </div>
      </li>
      <li>
<code class="language-plaintext highlighter-rouge">--max-requests-inflight</code>Â <strong>í´ëŸ¬ìŠ¤í„° ìƒíƒœ ì¡°íšŒ</strong>
        <ul>
          <li>ì„¤ëª… : API ì„œë²„ê°€ ë™ì‹œì— ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” non-mutating ìš”ì²­(GET, LIST, WATCH ë“±)ì˜ ìµœëŒ€ ìˆ˜ë¥¼ ì œí•œí•©ë‹ˆë‹¤.</li>
          <li>ë™ì‘ : ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´ íì— ë„£ê³ , í˜„ì¬ inflight ìˆ˜ê°€ ìµœëŒ€ê°’ì„ ë„˜ìœ¼ë©´ 429 Too Many Requestsë¥¼ ë°˜í™˜í•˜ê²Œ ë©ë‹ˆë‹¤.</li>
        </ul>
      </li>
      <li>
<code class="language-plaintext highlighter-rouge">--max-mutating-requests-inflight</code>Â <strong>í´ëŸ¬ìŠ¤í„° ìƒíƒœ ë³€ê²½</strong>
        <ul>
          <li>ì„¤ëª… : API ì„œë²„ê°€ ë™ì‹œì— ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” mutating ìš”ì²­(POST, PUT, PATCH, DELETE)ì˜ ìµœëŒ€ ìˆ˜ë¥¼ ì œí•œí•©ë‹ˆë‹¤.</li>
          <li>ë™ì‘ : Mutating ìš”ì²­ì€ í´ëŸ¬ìŠ¤í„° ìƒíƒœë¥¼ ë³€ê²½í•˜ê¸° ë•Œë¬¸ì—, ë„ˆë¬´ ë§ìœ¼ë©´ <strong>etcd I/Oì™€ API ì„œë²„ ë‚´ë¶€ lock</strong>ì— ë¶€í•˜ â†’ ì„œë²„ ì „ì²´ ì„±ëŠ¥ ì €í•˜ â‡’ ìš”ì²­ì´ ìµœëŒ€ê°’ì„ ë„˜ì–´ê°€ë©´ ì—­ì‹œ 429 ë°˜í™˜í•˜ê²Œ ë©ë‹ˆë‹¤.</li>
        </ul>
      </li>
      <li>
<code class="language-plaintext highlighter-rouge">PriorityAndFairness(P&amp;F)</code> : API ì„œë²„ê°€ ìš”ì²­ì„ PriorityLevelì— ë”°ë¼ íì‰í•˜ë©°, ê° PriorityLevelë³„ í• ë‹¹ í ì¡´ì¬í•©ë‹ˆë‹¤.
<img src="/assets/2025/cilium/w7/20250831_cilium_w7_18.png" alt="img.png" loading="lazy" width="1408" height="1434">
</li>
    </ul>
  </li>
  <li>
<strong>[Tuning] CoreDNS :</strong> Multi Socket Plugin ì†Œê°œ - <a href="https://www.youtube.com/watch?v=W3f5Ks0j2Q8">Youtube</a>
    <ul>
      <li>
<strong>CoreDNS</strong> : DNSì™€ Service Discoveryë¥¼ ë‹´ë‹¹ - <a href="https://coredns.io/">Docs</a>
        <ul>
          <li>Go ì–¸ì–´ë¡œ ì‘ì„±ëœ ìœ ì—°í•œ DNS ì„œë²„ì…ë‹ˆë‹¤.</li>
          <li>ê²½ëŸ‰í™”, ë¹ ë¦„, í™•ì¥ì„± ì¢‹ìœ¼ë©° ì„œë¹„ìŠ¤ ë””ìŠ¤ì»¤ë²„ë¦¬ì— ì¤‘ì ë‘ê³  ê°œë°œë˜ì—ˆìŠµë‹ˆë‹¤.</li>
          <li>í”ŒëŸ¬ê·¸ì¸ ê¸°ë°˜ì˜ ì•„í‚¤í…ì²˜ë¡œ ì‰½ê²Œ í™•ì¥ ê°€ëŠ¥í•©ë‹ˆë‹¤.</li>
          <li>Kubernetesì˜ ê¸°ë³¸ DNS ì„œë²„ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤.</li>
          <li>DNS, DNS over TLS, DNS over gRPCë¥¼ ì§€ì›í•©ë‹ˆë‹¤.</li>
        </ul>
      </li>
      <li>
<strong>MultiSocket</strong> ğŸ‘ğŸ» : ìˆ˜ì§ í™•ì¥ì„±ì„ í–¥ìƒì‹œí‚µë‹ˆë‹¤. - <a href="https://coredns.io/plugins/multisocket/">Docs</a>
        <ul>
          <li>MultiSocketì„ ì‚¬ìš©í•˜ë©´ í•˜ë‚˜ì˜ í¬íŠ¸ì—ì„œ ì—¬ëŸ¬ ì„œë²„ë¥¼ ì‹œì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
          <li>SO_REUSEPORT ì†Œì¼“ ì˜µì…˜ì„ ì‚¬ìš©í•˜ë©´ ë™ì¼í•œ ì£¼ì†Œì™€ í¬íŠ¸ì—ì„œ ì—¬ëŸ¬ ì²­ì·¨ ì†Œì¼“ì„ ì—´ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ê²½ìš° ì»¤ë„ì€ ì†Œì¼“ ê°„ì— ë“¤ì–´ì˜¤ëŠ” ì—°ê²°ì„ ë¶„ì‚°í•©ë‹ˆë‹¤.</li>
          <li>ê¸°ì¡´ CoreDNS ê¸°ë³¸ ì„¤ì • í™˜ê²½ì—ì„œ CPUê°€ ë§ì•„ì ¸ë„ QPSê°€ ëŠ˜ì–´ë‚˜ì§€ ì•ŠìŠµë‹ˆë‹¤.. â†’ <strong>2 CPU ê²½ìš° 40k qps</strong>
</li>
          <li>ì´ ì˜µì…˜ì„ í™œì„±í™”í•˜ë©´ ì—¬ëŸ¬ ì„œë²„ë¥¼ ì‹œì‘í•  ìˆ˜ ìˆì–´ CPU ì½”ì–´ê°€ ë§ì€ í™˜ê²½ì—ì„œ CoreDNSì˜ ì²˜ë¦¬ëŸ‰ì´ ì¦ê°€í•©ë‹ˆë‹¤.
<img src="/assets/2025/cilium/w7/20250831_cilium_w7_19.png" alt="img.png" class="image-center" loading="lazy" width="444" height="306">
<em class="image-caption">ê¸°ì¡´ì˜ CoreDNS ì²˜ë¦¬ êµ¬ì¡°</em>
<img src="/assets/2025/cilium/w7/20250831_cilium_w7_20.png" alt="img_1.png" class="image-center" loading="lazy" width="436" height="296">
<em class="image-caption">Multi Socketì´ ì ìš©ë˜ì–´ ì—¬ëŸ¬ ì„œë²„ê°€ ì‘ë™ ì¤‘ì¸ CoreDNS</em>
<img src="/assets/2025/cilium/w7/20250831_cilium_w7_21.png" alt="img_2.png" class="image-center" loading="lazy" width="733" height="403">
<em class="image-caption">Multi Socket ì ìš© ì „í›„ ë¹„êµ (1 Socketì´ ì ìš©ì „ì„)</em>
</li>
          <li>ìœ„ì˜ ê·¸ë˜í”„ì—ì„œ ë³´ë“¯ì´ Multi Socketì„ CPU ì½”ì–´ìˆ˜ì— ë§ê²Œ ì„¤ì •í•˜ë©´ CPU ì½”ì–´ê°€ ë§ì•„ì§ˆìˆ˜ë¡ QPSê°€ ì¦ê°€í•˜ëŠ” ìˆ˜ì§ í™•ì¥ì„±ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>
<strong>ETCD ì¬ì‹œì‘ìœ¼ë¡œ ì¸í•œ ì¥ì•  ë¶„ì„ Case</strong> : net.ipv4.tcp_timestamps , net.ipv4.tcp_wan_timestamps  - <a href="https://segmentfault.com/a/1190000043406041">Link</a>
<img src="/assets/2025/cilium/w7/20250831_cilium_w7_22.png" alt="img.png" loading="lazy" width="1098" height="616">
<img src="/assets/2025/cilium/w7/20250831_cilium_w7_23.png" alt="img_1.png" loading="lazy" width="1098" height="377">
    <ul>
      <li>í•´ë‹¹ ë¸”ë¡œê·¸ëŠ” ETCD ì¬ì‹œì‘ìœ¼ë¡œ ì¸í•´ K8S í´ëŸ¬ìŠ¤í„°ê°€ ë¶ˆì•ˆì •í•´ì§„ ì›ì¸ì„ ë¶„ì„í•œ ê¸€ì…ë‹ˆë‹¤.</li>
    </ul>
  </li>
  <li>ëŒ€ê·œëª¨ í´ëŸ¬ìŠ¤í„° ìš´ì˜ ê´€ë ¨ ìœ íŠœë¸Œ ë§í¬ ëª¨ìŒì…ë‹ˆë‹¤. ìƒë‹¹í•œ ì–‘ìœ¼ë¡œ ë‚˜ì¤‘ì— í•˜ë‚˜ì”© ì‚´í´ë´ì•¼ í• ê²ƒ ê°™ìŠµë‹ˆë‹¤.
    <ul>
      <li><strong>Building Armada â€“ Running Batch Jobs at Massive Scale on Kubernetes - Jamie Poole, G-Research - <a href="https://www.youtube.com/watch?v=B3WPxw3OUl4">Youtube</a></strong></li>
      <li><strong>Automated Multi-Cloud Large Scale K8s Cluster Lifecycle Management - Sourav Khandelwal, Databricks - <a href="https://www.youtube.com/watch?v=9E7lenP6pFc">Youtube</a></strong></li>
      <li><strong>An Alternative Metadata System for Large Kubernetes Clusters - Yingcai Xue &amp; Yixiang Chen, ByteDance - <a href="https://www.youtube.com/watch?v=MGOa8Nn8_S0">Youtube</a></strong></li>
      <li>Large Scale Automated Storage with Kubernetes - Celina Ward, Software Engineer &amp; Matt Schallert, Site Reliability Engineer, Uber - <a href="https://www.youtube.com/watch?v=aDFm5KaTaOk">Youtube</a>
</li>
      <li><strong>Large-Scale Practice of Persistent Memory in Alibaba Cloud - Junbao Kan &amp; Qingcan Wang, Alibaba - <a href="https://www.youtube.com/watch?v=3MKbk7AS8Jw">Youtube</a></strong></li>
      <li>Managing Large-Scale Kubernetes Clusters Effectively and Reliably - Yong Zhang &amp; Zhixian Lin - <a href="https://www.youtube.com/watch?v=yUL7NKt2hAY">Youtube</a>
</li>
      <li><strong>How to Stabilize a GenAI-First, Modern Data LakeHouse: Provision 20,000 Ephemeral Data Lakes/Year - <a href="https://www.youtube.com/watch?v=L02zdTo7HT0">Youtube</a></strong></li>
      <li><strong>Scaling Kubernetes Networking to 1k, 5k, â€¦ 100k Nodes!? - Marcel ZiÄ™ba, Isovalent &amp; Dorde Lapcevic, Google - <a href="https://www.youtube.com/watch?v=VWGB-NW800Y">Youtube</a></strong></li>
      <li>Collecting Operational Metrics for a Cluster with 5,000 Namespaces - Rob Szumski &amp; Chance Zibolski, Red Hat - <a href="https://www.youtube.com/watch?v=JHmWRBWPKog">Youtube</a>
</li>
      <li>Scaling Kubernetes Networking Beyond 100k Endpoints - Rob Scott &amp; Minhan Xia, Google - <a href="https://www.youtube.com/watch?v=a6SfbeM06Qo">Youtube</a>
</li>
      <li>Per-Node Api-Server Proxy: Expand the Clusterâ€™s Scale and Stability - Weizhou Lan &amp; Iceber Gu - <a href="https://www.youtube.com/watch?v=O7w7e2iA7lA">Youtube</a>
</li>
      <li>Build a High Performance Remote Storage for Prometheus with Unlimited Time Series - Yang Xiang - <a href="https://www.youtube.com/watch?v=7pQZyYEz1l4">Youtube</a>
</li>
      <li><strong>BGP Peering Patterns for Kubernetes Networking at Preferred Networks - Sho Shimizu &amp; Yutaro Hayakawa - <a href="https://www.youtube.com/watch?v=n7_I4zu6f_M">Youtube</a></strong></li>
      <li>Kubernetes Performance Tuning Workshop - Anton Weiss - <a href="https://www.youtube.com/watch?v=7CObA_qY6vo">Youtube</a>
</li>
    </ul>
  </li>
</ul>

<h5 id="kind-í´ëŸ¬ìŠ¤í„°-ì‚­ì œ">Kind í´ëŸ¬ìŠ¤í„° ì‚­ì œ</h5>

<ul>
  <li>ë‹¤ìŒ ì‹¤ìŠµì„ ìœ„í•´ í´ëŸ¬ìŠ¤í„°ë¥¼ ì‚­ì œí•©ë‹ˆë‹¤.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kind delete cluster <span class="nt">--name</span> myk8s
</code></pre></div></div>

<hr>

<h2 id="cilium-performance">Cilium Performance</h2>

<h3 id="ì‹¤ìŠµí™˜ê²½-ì¤€ë¹„">ì‹¤ìŠµí™˜ê²½ ì¤€ë¹„</h3>

<ul>
  <li>Kindì™€ Cilium CNIë¥¼ ì‚¬ìš©í•˜ì—¬ ì‹¤ìŠµí™˜ê²½ì„ ì¤€ë¹„í•©ë‹ˆë‹¤.</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Prometheus Target connection refused bind-address ì„¤ì • : kube-controller-manager , kube-scheduler , etcd , kube-proxy</span>
<span class="nv">$ </span>kind create cluster <span class="nt">--name</span> myk8s <span class="nt">--image</span> kindest/node:v1.33.2 <span class="nt">--config</span> - <span class="o">&lt;&lt;</span><span class="no">EOF</span><span class="sh">
kind: Cluster
apiVersion: kind.x-k8s.io/v1alpha4
nodes:
- role: control-plane
  extraPortMappings:
  - containerPort: 30000
    hostPort: 30000
  - containerPort: 30001
    hostPort: 30001
  - containerPort: 30002
    hostPort: 30002
  - containerPort: 30003
    hostPort: 30003
  kubeadmConfigPatches: # Prometheus Target connection refused bind-address ì„¤ì •
  - |
    kind: ClusterConfiguration
    controllerManager:
      extraArgs:
        bind-address: 0.0.0.0
    etcd:
      local:
        extraArgs:
          listen-metrics-urls: http://0.0.0.0:2381
    scheduler:
      extraArgs:
        bind-address: 0.0.0.0
  - |
    kind: KubeProxyConfiguration
    metricsBindAddress: 0.0.0.0
networking:
  disableDefaultCNI: true
  kubeProxyMode: none
  podSubnet: "10.244.0.0/16"   # cluster-cidr
kubeadmConfigPatches:
- |
  kind: ClusterConfiguration
  controllerManager:
    extraArgs:
      allocate-node-cidrs: "true"
      cluster-cidr: "10.244.0.0/16"
      node-cidr-mask-size: "22"
</span><span class="no">EOF
</span><span class="c"># =&gt; Creating cluster "myk8s" ...</span>
<span class="c">#     âœ“ Ensuring node image (kindest/node:v1.33.2) ğŸ–¼</span>
<span class="c">#     âœ“ Preparing nodes ğŸ“¦</span>
<span class="c">#     âœ“ Writing configuration ğŸ“œ</span>
<span class="c">#     âœ“ Starting control-plane ğŸ•¹ï¸</span>
<span class="c">#     âœ“ Installing StorageClass ğŸ’¾</span>
<span class="c">#    Set kubectl context to "kind-myk8s"</span>
<span class="c">#    You can now use your cluster with:</span>
<span class="c">#    </span>
<span class="c">#    kubectl cluster-info --context kind-myk8s</span>

<span class="c"># node ë³„ PodCIDR í™•ì¸</span>
<span class="nv">$ </span>kubectl get nodes <span class="nt">-o</span> <span class="nv">jsonpath</span><span class="o">=</span><span class="s1">'{.items[*].spec.podCIDR}'</span>
<span class="c"># =&gt; 10.244.0.0/22</span>

<span class="c"># cilium cni ì„¤ì¹˜</span>
<span class="nv">$ </span>cilium <span class="nb">install</span> <span class="nt">--version</span> 1.18.1 <span class="nt">--set</span> ipam.mode<span class="o">=</span>kubernetes <span class="nt">--set</span> <span class="nv">ipv4NativeRoutingCIDR</span><span class="o">=</span>172.20.0.0/16 <span class="se">\</span>
  <span class="nt">--set</span> <span class="nv">routingMode</span><span class="o">=</span>native <span class="nt">--set</span> <span class="nv">autoDirectNodeRoutes</span><span class="o">=</span><span class="nb">true</span> <span class="nt">--set</span> endpointRoutes.enabled<span class="o">=</span><span class="nb">true</span> <span class="nt">--set</span> <span class="nv">directRoutingSkipUnreachable</span><span class="o">=</span><span class="nb">true</span> <span class="se">\</span>
  <span class="nt">--set</span> <span class="nv">kubeProxyReplacement</span><span class="o">=</span><span class="nb">true</span> <span class="nt">--set</span> bpf.masquerade<span class="o">=</span><span class="nb">true</span> <span class="se">\</span>
  <span class="nt">--set</span> endpointHealthChecking.enabled<span class="o">=</span><span class="nb">false</span> <span class="nt">--set</span> <span class="nv">healthChecking</span><span class="o">=</span><span class="nb">false</span> <span class="se">\</span>
  <span class="nt">--set</span> hubble.enabled<span class="o">=</span><span class="nb">true</span> <span class="nt">--set</span> hubble.relay.enabled<span class="o">=</span><span class="nb">true</span> <span class="nt">--set</span> hubble.ui.enabled<span class="o">=</span><span class="nb">true</span> <span class="se">\</span>
  <span class="nt">--set</span> hubble.ui.service.type<span class="o">=</span>NodePort <span class="nt">--set</span> hubble.ui.service.nodePort<span class="o">=</span>30003 <span class="se">\</span>
  <span class="nt">--set</span> prometheus.enabled<span class="o">=</span><span class="nb">true</span> <span class="nt">--set</span> operator.prometheus.enabled<span class="o">=</span><span class="nb">true</span> <span class="nt">--set</span> envoy.prometheus.enabled<span class="o">=</span><span class="nb">true</span> <span class="nt">--set</span> hubble.metrics.enableOpenMetrics<span class="o">=</span><span class="nb">true</span> <span class="se">\</span>
  <span class="nt">--set</span> hubble.metrics.enabled<span class="o">=</span><span class="s2">"{dns,drop,tcp,flow,port-distribution,icmp,httpV2:exemplars=true;labelsContext=source_ip</span><span class="se">\,</span><span class="s2">source_namespace</span><span class="se">\,</span><span class="s2">source_workload</span><span class="se">\,</span><span class="s2">destination_ip</span><span class="se">\,</span><span class="s2">destination_namespace</span><span class="se">\,</span><span class="s2">destination_workload</span><span class="se">\,</span><span class="s2">traffic_direction}"</span> <span class="se">\</span>
  <span class="nt">--set</span> debug.enabled<span class="o">=</span><span class="nb">true</span>  <span class="c"># --dry-run-helm-values</span>
<span class="c"># =&gt; ğŸ”® Auto-detected Kubernetes kind: kind</span>
<span class="c">#    â„¹ï¸   Using Cilium version 1.18.1</span>
<span class="c">#    ğŸ”® Auto-detected cluster name: kind-myk8s</span>
<span class="c">#    â„¹ï¸   Detecting real Kubernetes API server addr and port on Kind</span>
<span class="c">#    ğŸ”® Auto-detected kube-proxy has not been installed</span>
<span class="c">#    â„¹ï¸   Cilium will fully replace all functionalities of kube-proxy</span>

<span class="c"># hubble ui</span>
<span class="nv">$ </span>open http://127.0.0.1:30003

<span class="c"># metrics-server</span>
<span class="nv">$ </span>helm repo add metrics-server https://kubernetes-sigs.github.io/metrics-server/
<span class="nv">$ </span>helm upgrade <span class="nt">--install</span> metrics-server metrics-server/metrics-server <span class="nt">--set</span> <span class="s1">'args[0]=--kubelet-insecure-tls'</span> <span class="nt">-n</span> kube-system
<span class="c"># =&gt; Release "metrics-server" does not exist. Installing it now.</span>
<span class="c">#    NAME: metrics-server</span>
<span class="c">#    LAST DEPLOYED: Sat Aug 30 17:13:42 2025</span>
<span class="c">#    NAMESPACE: kube-system</span>
<span class="c">#    STATUS: deployed</span>
<span class="c">#    REVISION: 1</span>
<span class="c">#    TEST SUITE: None</span>
<span class="c">#    NOTES:</span>
<span class="c">#    ***********************************************************************</span>
<span class="c">#    * Metrics Server                                                      *</span>
<span class="c">#    ***********************************************************************</span>
<span class="c">#      Chart version: 3.13.0</span>
<span class="c">#      App version:   0.8.0</span>
<span class="c">#      Image tag:     registry.k8s.io/metrics-server/metrics-server:v0.8.0</span>
<span class="c">#    ***********************************************************************</span>

<span class="c"># í™•ì¸</span>
<span class="nv">$ </span>kubectl top node
<span class="c"># =&gt; NAME                  CPU(cores)   CPU(%)   MEMORY(bytes)   MEMORY(%)</span>
<span class="c">#    myk8s-control-plane   496m         7%       1132Mi          23%</span>
<span class="nv">$ </span>kubectl top pod <span class="nt">-A</span> <span class="nt">--sort-by</span><span class="o">=</span><span class="s1">'cpu'</span>
<span class="nv">$ </span>kubectl top pod <span class="nt">-A</span> <span class="nt">--sort-by</span><span class="o">=</span><span class="s1">'memory'</span>
</code></pre></div></div>

<h5 id="prometheus--grafana-ì„¤ì¹˜---docs">Prometheus &amp; Grafana ì„¤ì¹˜ - <a href="https://docs.cilium.io/en/stable/observability/grafana/">Docs</a>
</h5>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#</span>
<span class="nv">$ </span>kubectl apply <span class="nt">-f</span> https://raw.githubusercontent.com/cilium/cilium/1.18.1/examples/kubernetes/addons/prometheus/monitoring-example.yaml

<span class="c">#</span>
<span class="nv">$ </span>kubectl get deploy,pod,svc,ep <span class="nt">-n</span> cilium-monitoring
<span class="nv">$ </span>kubectl get cm <span class="nt">-n</span> cilium-monitoring
<span class="nv">$ </span>kc describe cm <span class="nt">-n</span> cilium-monitoring prometheus
<span class="nv">$ </span>kc describe cm <span class="nt">-n</span> cilium-monitoring grafana-config
<span class="nv">$ </span>kubectl get svc <span class="nt">-n</span> cilium-monitoring

<span class="c"># NodePort ì„¤ì •</span>
<span class="nv">$ </span>kubectl patch svc <span class="nt">-n</span> cilium-monitoring prometheus <span class="nt">-p</span> <span class="s1">'{"spec": {"type": "NodePort", "ports": [{"port": 9090, "targetPort": 9090, "nodePort": 30001}]}}'</span>
<span class="c"># =&gt; service/prometheus patched</span>
<span class="nv">$ </span>kubectl patch svc <span class="nt">-n</span> cilium-monitoring grafana <span class="nt">-p</span> <span class="s1">'{"spec": {"type": "NodePort", "ports": [{"port": 3000, "targetPort": 3000, "nodePort": 30002}]}}'</span>
<span class="c"># =&gt; service/grafana patched</span>

<span class="nv">$ </span>kubectl get svc <span class="nt">-n</span> cilium-monitoring
<span class="c"># =&gt; NAME         TYPE       CLUSTER-IP     EXTERNAL-IP   PORT(S)          AGE</span>
<span class="c">#    grafana      NodePort   10.96.85.141   &lt;none&gt;        3000:30002/TCP   37s</span>
<span class="c">#    prometheus   NodePort   10.96.59.105   &lt;none&gt;        9090:30001/TCP   37s</span>

<span class="c"># ì ‘ì† ì£¼ì†Œ í™•ì¸</span>
<span class="nv">$ </span>open <span class="s2">"http://127.0.0.1:30001"</span>  <span class="c"># prometheus</span>
<span class="nv">$ </span>open <span class="s2">"http://127.0.0.1:30002"</span>  <span class="c"># grafana</span>
</code></pre></div></div>

<h3 id="ì¿ ë²„ë„¤í‹°ìŠ¤-í™˜ê²½ì—ì„œ-ì†ë„-ì¸¡ì •-í…ŒìŠ¤íŠ¸">ì¿ ë²„ë„¤í‹°ìŠ¤ í™˜ê²½ì—ì„œ ì†ë„ ì¸¡ì • í…ŒìŠ¤íŠ¸</h3>

<ul>
  <li>ì¼ë°˜ì ìœ¼ë¡œ ì„±ëŠ¥ ì¸¡ì •ì‹œ ë§ì´ ì“°ì´ëŠ” <code class="language-plaintext highlighter-rouge">iperf3</code>ë¥¼ ì‚¬ìš©í•˜ì—¬ TCP/UDP ì†ë„ë¥¼ ì¸¡ì •í•´ë³´ê² ìŠµë‹ˆë‹¤.</li>
  <li>ë°°í¬ ë° í™•ì¸</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># ë°°í¬</span>
<span class="nv">$ </span><span class="nb">cat</span> <span class="o">&lt;&lt;</span><span class="no">EOF</span><span class="sh"> | kubectl apply -f -
apiVersion: apps/v1
kind: Deployment
metadata:
  name: iperf3-server
spec:
  selector:
    matchLabels:
      app: iperf3-server
  replicas: 1
  template:
    metadata:
      labels:
        app: iperf3-server
    spec:
      containers:
      - name: iperf3-server
        image: networkstatic/iperf3
        args: ["-s"]
        ports:
        - containerPort: 5201
---
apiVersion: v1
kind: Service
metadata:
  name: iperf3-server
spec:
  selector:
    app: iperf3-server
  ports:
    - name: tcp-service
      protocol: TCP
      port: 5201
      targetPort: 5201
    - name: udp-service
      protocol: UDP
      port: 5201
      targetPort: 5201
  type: ClusterIP
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: iperf3-client
spec:
  selector:
    matchLabels:
      app: iperf3-client
  replicas: 1
  template:
    metadata:
      labels:
        app: iperf3-client
    spec:
      containers:
      - name: iperf3-client
        image: networkstatic/iperf3
        command: ["sleep"]
        args: ["infinity"]
</span><span class="no">EOF
</span><span class="c"># =&gt; deployment.apps/iperf3-server created</span>
<span class="c">#    service/iperf3-server created</span>
<span class="c">#    deployment.apps/iperf3-client created</span>

<span class="c"># í™•ì¸ : ì„œë²„ì™€ í´ë¼ì´ì–¸íŠ¸ê°€ ì–´ë–¤ ë…¸ë“œì— ë°°í¬ë˜ì—ˆëŠ”ì§€ í™•ì¸</span>
<span class="nv">$ </span>kubectl get deploy,svc,pod <span class="nt">-owide</span>
<span class="c"># =&gt; NAME                            READY   UP-TO-DATE   AVAILABLE   AGE   CONTAINERS      IMAGES                 SELECTOR</span>
<span class="c">#    deployment.apps/iperf3-client   1/1     1            1           28s   iperf3-client   networkstatic/iperf3   app=iperf3-client</span>
<span class="c">#    deployment.apps/iperf3-server   1/1     1            1           28s   iperf3-server   networkstatic/iperf3   app=iperf3-server</span>
<span class="c">#    </span>
<span class="c">#    NAME                    TYPE        CLUSTER-IP    EXTERNAL-IP   PORT(S)             AGE   SELECTOR</span>
<span class="c">#    service/iperf3-server   ClusterIP   10.96.7.124   &lt;none&gt;        5201/TCP,5201/UDP   28s   app=iperf3-server</span>
<span class="c">#    service/kubernetes      ClusterIP   10.96.0.1     &lt;none&gt;        443/TCP             14m   &lt;none&gt;</span>
<span class="c">#    </span>
<span class="c">#    NAME                                 READY   STATUS    RESTARTS   AGE   IP             NODE                  NOMINATED NODE   READINESS GATES</span>
<span class="c">#    pod/iperf3-client-688ff6565d-267sh   1/1     Running   0          28s   10.244.2.248   myk8s-control-plane   &lt;none&gt;           &lt;none&gt;</span>
<span class="c">#    pod/iperf3-server-5d54b669cc-k8gzf   1/1     Running   0          28s   10.244.2.101   myk8s-control-plane   &lt;none&gt;           &lt;none&gt;</span>

<span class="c"># ì„œë²„ íŒŒë“œ ë¡œê·¸ í™•ì¸ : ê¸°ë³¸ 5201 í¬íŠ¸ Listen</span>
<span class="nv">$ </span>kubectl logs <span class="nt">-l</span> <span class="nv">app</span><span class="o">=</span>iperf3-server <span class="nt">-f</span>
</code></pre></div></div>

<ul>
  <li>ì‹¤ìŠµ 1. TCP 5201, ì¸¡ì •ì‹œê°„ 5ì´ˆ</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># í´ë¼ì´ì–¸íŠ¸ íŒŒë“œì—ì„œ ì•„ë˜ ëª…ë ¹ ì‹¤í–‰</span>
<span class="nv">$ </span>kubectl <span class="nb">exec</span> <span class="nt">-it</span> deploy/iperf3-client <span class="nt">--</span> iperf3 <span class="nt">-c</span> iperf3-server <span class="nt">-t</span> 5
<span class="c"># =&gt; Connecting to host iperf3-server, port 5201</span>
<span class="c">#    [  5] local 10.244.2.248 port 42338 connected to 10.96.7.124 port 5201</span>
<span class="c">#    [ ID] Interval           Transfer     Bitrate         Retr  Cwnd</span>
<span class="c">#    [  5]   0.00-1.00   sec  8.86 GBytes  76.1 Gbits/sec  2581    346 KBytes</span>
<span class="c">#    [  5]   1.00-2.00   sec  8.38 GBytes  72.0 Gbits/sec  264    380 KBytes</span>
<span class="c">#    [  5]   2.00-3.00   sec  9.39 GBytes  80.7 Gbits/sec  1054    461 KBytes</span>
<span class="c">#    [  5]   3.00-4.00   sec  8.82 GBytes  75.7 Gbits/sec  533    769 KBytes</span>
<span class="c">#    [  5]   4.00-5.00   sec  8.80 GBytes  75.6 Gbits/sec  199    827 KBytes</span>
<span class="c">#    - - - - - - - - - - - - - - - - - - - - - - - - -</span>
<span class="c">#    [ ID] Interval           Transfer     Bitrate         Retr</span>
<span class="c">#    [  5]   0.00-5.00   sec  44.2 GBytes  76.0 Gbits/sec  4631             sender</span>
<span class="c">#    [  5]   0.00-5.00   sec  44.2 GBytes  76.0 Gbits/sec                  receiver</span>

<span class="c"># ì„œë²„ íŒŒë“œ ë¡œê·¸ í™•ì¸ : ê¸°ë³¸ 5201 í¬íŠ¸ Listen</span>
<span class="nv">$ </span>kubectl logs <span class="nt">-l</span> <span class="nv">app</span><span class="o">=</span>iperf3-server <span class="nt">-f</span>
<span class="c"># =&gt; -----------------------------------------------------------</span>
<span class="c">#    Server listening on 5201 (test #1)</span>
<span class="c">#    -----------------------------------------------------------</span>
<span class="c">#    Accepted connection from 10.244.2.248, port 42336</span>
<span class="c">#    [  5] local 10.244.2.101 port 5201 connected to 10.244.2.248 port 42338</span>
<span class="c">#    [ ID] Interval           Transfer     Bitrate</span>
<span class="c">#    [  5]   0.00-1.00   sec  8.86 GBytes  76.1 Gbits/sec</span>
<span class="c">#    [  5]   1.00-2.00   sec  8.37 GBytes  71.9 Gbits/sec</span>
<span class="c">#    [  5]   2.00-3.00   sec  9.40 GBytes  80.8 Gbits/sec</span>
<span class="c">#    [  5]   3.00-4.00   sec  8.81 GBytes  75.7 Gbits/sec</span>
<span class="c">#    [  5]   4.00-5.00   sec  8.81 GBytes  75.6 Gbits/sec</span>
<span class="c">#    - - - - - - - - - - - - - - - - - - - - - - - - -</span>
<span class="c">#    [ ID] Interval           Transfer     Bitrate</span>
<span class="c">#    [  5]   0.00-5.00   sec  44.2 GBytes  76.0 Gbits/sec                  receiver</span>
<span class="c"># &lt;span style="color: green;"&gt;ğŸ‘‰ ê¸°ë³¸ì ìœ¼ë¡œ í´ë¼ì´ì–¸íŠ¸ì¸¡ ë¡œê·¸ì™€ ì„œë²„ì¸¡ ë¡œê·¸ê°€ ë™ì¼í•˜ê²Œ ë‚˜ì˜µë‹ˆë‹¤.&lt;/span&gt;</span>
</code></pre></div></div>

<ul>
  <li>ì‹¤ìŠµ 2. UDP ì‚¬ìš© (-u)</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># í´ë¼ì´ì–¸íŠ¸ íŒŒë“œì—ì„œ ì•„ë˜ ëª…ë ¹ ì‹¤í–‰</span>
<span class="nv">$ </span>kubectl <span class="nb">exec</span> <span class="nt">-it</span> deploy/iperf3-client <span class="nt">--</span> iperf3 <span class="nt">-c</span> iperf3-server <span class="nt">-u</span> <span class="nt">-b</span> 20G
<span class="c"># =&gt; Connecting to host iperf3-server, port 5201</span>
<span class="c">#    [  5] local 10.244.2.248 port 39637 connected to 10.96.7.124 port 5201</span>
<span class="c">#    [ ID] Interval           Transfer     Bitrate         Total Datagrams</span>
<span class="c">#    [  5]   0.00-1.00   sec   335 MBytes  2.81 Gbits/sec  242388</span>
<span class="c">#    [  5]   1.00-2.00   sec   338 MBytes  2.83 Gbits/sec  244711</span>
<span class="c">#    [  5]   2.00-3.00   sec   325 MBytes  2.73 Gbits/sec  235629</span>
<span class="c">#    [  5]   3.00-4.00   sec   327 MBytes  2.74 Gbits/sec  236618</span>
<span class="c">#    [  5]   4.00-5.00   sec   317 MBytes  2.66 Gbits/sec  229570</span>
<span class="c">#    [  5]   5.00-6.00   sec   330 MBytes  2.77 Gbits/sec  238981</span>
<span class="c">#    [  5]   6.00-7.00   sec   337 MBytes  2.83 Gbits/sec  244238</span>
<span class="c">#    [  5]   7.00-8.00   sec   334 MBytes  2.80 Gbits/sec  241738</span>
<span class="c">#    [  5]   8.00-9.00   sec   336 MBytes  2.82 Gbits/sec  243323</span>
<span class="c">#    [  5]   9.00-10.00  sec   331 MBytes  2.78 Gbits/sec  239984</span>
<span class="c">#    - - - - - - - - - - - - - - - - - - - - - - - - -</span>
<span class="c">#    [ ID] Interval           Transfer     Bitrate         Jitter    Lost/Total Datagrams</span>
<span class="c">#    [  5]   0.00-10.00  sec  3.23 GBytes  2.78 Gbits/sec  0.000 ms  0/2397180 (0%)  sender</span>
<span class="c">#    [  5]   0.00-10.00  sec  3.22 GBytes  2.77 Gbits/sec  0.003 ms  6167/2397180 (0.26%)  receiver</span>

<span class="c"># ì„œë²„ íŒŒë“œ ë¡œê·¸ í™•ì¸ : ê¸°ë³¸ 5201 í¬íŠ¸ Listen</span>
<span class="nv">$ </span>kubectl logs <span class="nt">-l</span> <span class="nv">app</span><span class="o">=</span>iperf3-server <span class="nt">-f</span>
</code></pre></div></div>

<ul>
  <li>ì‹¤ìŠµ 3. TCP, ìŒë°©í–¥ ëª¨ë“œ(-bidir)
    <ul>
      <li>ì†¡ì‹ (TX), ìˆ˜ì‹ (RX) ëª¨ë‘ ì¸¡ì •í•©ë‹ˆë‹¤.</li>
    </ul>
  </li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># í´ë¼ì´ì–¸íŠ¸ íŒŒë“œì—ì„œ ì•„ë˜ ëª…ë ¹ ì‹¤í–‰</span>
<span class="nv">$ </span>kubectl <span class="nb">exec</span> <span class="nt">-it</span> deploy/iperf3-client <span class="nt">--</span> iperf3 <span class="nt">-c</span> iperf3-server <span class="nt">-t</span> 5 <span class="nt">--bidir</span>
<span class="c"># =&gt; Connecting to host iperf3-server, port 5201</span>
<span class="c">#    [  5] local 10.244.2.248 port 49212 connected to 10.96.7.124 port 5201</span>
<span class="c">#    [  7] local 10.244.2.248 port 49214 connected to 10.96.7.124 port 5201</span>
<span class="c">#    [ ID][Role] Interval           Transfer     Bitrate         Retr  Cwnd</span>
<span class="c">#    [  5][TX-C]   0.00-1.00   sec  8.04 GBytes  69.0 Gbits/sec    1   1.25 MBytes</span>
<span class="c">#    [  7][RX-C]   0.00-1.00   sec  1.69 GBytes  14.5 Gbits/sec</span>
<span class="c">#    [  5][TX-C]   1.00-2.00   sec  4.76 GBytes  40.9 Gbits/sec    0   1.25 MBytes</span>
<span class="c">#    [  7][RX-C]   1.00-2.00   sec  5.13 GBytes  44.1 Gbits/sec</span>
<span class="c">#    [  5][TX-C]   2.00-3.00   sec  4.73 GBytes  40.6 Gbits/sec    0   1.25 MBytes</span>
<span class="c">#    [  7][RX-C]   2.00-3.00   sec  4.95 GBytes  42.5 Gbits/sec</span>
<span class="c">#    [  5][TX-C]   3.00-4.00   sec  4.77 GBytes  41.0 Gbits/sec    0   1.25 MBytes</span>
<span class="c">#    [  7][RX-C]   3.00-4.00   sec  5.04 GBytes  43.3 Gbits/sec</span>
<span class="c">#    [  5][TX-C]   4.00-5.00   sec  4.73 GBytes  40.6 Gbits/sec    0   1.25 MBytes</span>
<span class="c">#    [  7][RX-C]   4.00-5.00   sec  4.97 GBytes  42.7 Gbits/sec</span>
<span class="c">#    - - - - - - - - - - - - - - - - - - - - - - - - -</span>
<span class="c">#    [ ID][Role] Interval           Transfer     Bitrate         Retr</span>
<span class="c">#    [  5][TX-C]   0.00-5.00   sec  27.0 GBytes  46.4 Gbits/sec    1             sender</span>
<span class="c">#    [  5][TX-C]   0.00-5.00   sec  27.0 GBytes  46.4 Gbits/sec                  receiver</span>
<span class="c">#    [  7][RX-C]   0.00-5.00   sec  21.8 GBytes  37.4 Gbits/sec    0             sender</span>
<span class="c">#    [  7][RX-C]   0.00-5.00   sec  21.8 GBytes  37.4 Gbits/sec                  receiver</span>
<span class="c"># &gt;&gt; Clientâ†’Server (TX): 46.4 Gbps</span>
<span class="c"># &gt;&gt; Serverâ†’Client (RX): 37.4 Gbps</span>
<span class="c"># &gt;&gt; Retransmit : TX=1, RX=0 â†’ ì¼ë¶€ íŒ¨í‚· ì†ì‹¤ë¡œ ì¸í•œ ì¬ì „ì†¡ì´ ìˆì—ˆìŒ</span>
<span class="c"># &gt;&gt; ì „ì²´ì ìœ¼ë¡œëŠ” 37~46Gbps ìˆ˜ì¤€ì˜ ëŒ€ì—­í­ì´ ì¸¡ì •ë¨</span>

<span class="c"># ì„œë²„ íŒŒë“œ ë¡œê·¸ í™•ì¸ : ê¸°ë³¸ 5201 í¬íŠ¸ Listen</span>
<span class="nv">$ </span>kubectl logs <span class="nt">-l</span> <span class="nv">app</span><span class="o">=</span>iperf3-server <span class="nt">-f</span>
</code></pre></div></div>

<ul>
  <li>ì‹¤ìŠµ 4. TCP ë‹¤ì¤‘ ìŠ¤íŠ¸ë¦¼(30ê°œ), -P(number of parallel client streams to run)</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># í´ë¼ì´ì–¸íŠ¸ íŒŒë“œì—ì„œ ì•„ë˜ ëª…ë ¹ ì‹¤í–‰</span>
<span class="nv">$ </span>kubectl <span class="nb">exec</span> <span class="nt">-it</span> deploy/iperf3-client <span class="nt">--</span> iperf3 <span class="nt">-c</span> iperf3-server <span class="nt">-t</span> 10 <span class="nt">-P</span> 2
<span class="c"># =&gt; ...</span>
<span class="c">#    - - - - - - - - - - - - - - - - - - - - - - - - -</span>
<span class="c">#    [ ID] Interval           Transfer     Bitrate         Retr</span>
<span class="c">#    [  5]   0.00-10.00  sec  58.8 GBytes  50.5 Gbits/sec  444             sender</span>
<span class="c">#    [  5]   0.00-10.00  sec  58.8 GBytes  50.5 Gbits/sec                  receiver</span>
<span class="c">#    [  7]   0.00-10.00  sec  58.8 GBytes  50.5 Gbits/sec  1039             sender</span>
<span class="c">#    [  7]   0.00-10.00  sec  58.8 GBytes  50.5 Gbits/sec                  receiver</span>
<span class="c">#    [SUM]   0.00-10.00  sec   118 GBytes   101 Gbits/sec  1483             sender</span>
<span class="c">#    [SUM]   0.00-10.00  sec   118 GBytes   101 Gbits/sec                  receiver</span>

<span class="c"># ì„œë²„ íŒŒë“œ ë¡œê·¸ í™•ì¸ : ê¸°ë³¸ 5201 í¬íŠ¸ Listen</span>
<span class="nv">$ </span>kubectl logs <span class="nt">-l</span> <span class="nv">app</span><span class="o">=</span>iperf3-server <span class="nt">-f</span>
</code></pre></div></div>

<ul>
  <li>ì‚­ì œ:  <code class="language-plaintext highlighter-rouge">kubectl delete deploy iperf3-server iperf3-client &amp;&amp; kubectl delete svc iperf3-server</code>
</li>
</ul>

<h3 id="cilium-ì ‘ì†-ë°-ì„±ëŠ¥-í…ŒìŠ¤íŠ¸">Cilium ì ‘ì† ë° ì„±ëŠ¥ í…ŒìŠ¤íŠ¸</h3>

<ul>
  <li><a href="https://docs.cilium.io/en/stable/contributing/testing/e2e/">ê´€ë ¨ë¬¸ì„œ</a></li>
  <li>Ciliumì€ <a href="https://github.com/cilium/cilium-cli/#connectivity-check">cilium-cli connectivity tests</a>ë¥¼ í†µí•´ API ë ˆë²¨ì—ì„œ ë°ì´í„° ê²½ë¡œ ê¹Œì§€ 
end-to-end í…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
  <li>
<code class="language-plaintext highlighter-rouge">cilium connectivity test</code> - ê¸°ëŠ¥ ê²€ì¦ ë° ê¸°ëŠ¥ë³„ ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸ (Pass, Fail)</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#</span>
<span class="nv">$ </span>cilium connectivity <span class="nt">-h</span>
<span class="c"># =&gt; Connectivity troubleshooting</span>
<span class="c">#    </span>
<span class="c">#    Usage:</span>
<span class="c">#      cilium connectivity [command]</span>
<span class="c">#    </span>
<span class="c">#    Available Commands:</span>
<span class="c">#      perf        Test network performance</span>
<span class="c">#      test        Validate connectivity in cluster</span>

<span class="c"># ì•„ë˜ test ì‹¤í–‰ í›„ cilium-test-1 ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ì ‘ì†</span>
<span class="nv">$ </span>open http://127.0.0.1:30003/?namespace<span class="o">=</span>cilium-test-1

<span class="c"># test : í…ŒìŠ¤íŠ¸ í•­ëª© 122ê°œ 2:59~</span>
<span class="nv">$ </span>cilium connectivity <span class="nb">test</span> <span class="nt">--debug</span>  
<span class="c"># =&gt; âœ¨ [kind-myk8s] Creating namespace cilium-test-1 for connectivity check...</span>
<span class="c">#    âœ¨ [kind-myk8s] Deploying echo-same-node service...</span>
<span class="c">#    âœ¨ [kind-myk8s] Deploying DNS test server configmap...</span>
<span class="c">#    âœ¨ [kind-myk8s] Deploying same-node deployment...</span>
<span class="c">#    ...í…ŒìŠ¤íŠ¸ í™˜ê²½ ë°°í¬ (ìƒëµ)...</span>
<span class="c">#    ğŸ› [cilium-test-1] Registered connectivity tests</span>
<span class="c">#    ğŸ›   &lt;Test no-policies, 8 scenarios, 0 resources, expectFunc &lt;nil&gt;&gt;</span>
<span class="c">#    ğŸ›   &lt;Test no-policies-from-outside, 1 scenarios, 0 resources, expectFunc &lt;nil&gt;&gt;</span>
<span class="c">#    ğŸ›   &lt;Test no-policies-extra, 2 scenarios, 0 resources, expectFunc &lt;nil&gt;&gt;</span>
<span class="c">#    ğŸ›   &lt;Test allow-all-except-world, 4 scenarios, 1 resources, expectFunc &lt;nil&gt;&gt;</span>
<span class="c">#    ğŸ›   &lt;Test client-ingress, 1 scenarios, 1 resources, expectFunc 0x104e81740&gt;</span>
<span class="c">#    ...</span>

<span class="c"># ì‹¤ìŠµ ë¦¬ì†ŒìŠ¤ ì‚­ì œ</span>
<span class="nv">$ </span>kubectl delete ns cilium-test-1
</code></pre></div></div>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">cilium connectivity perf</code> : ì„±ëŠ¥ ì¸¡ì •(Gbsp, Latency) - Throughput, Retransmit, Latency
    <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>cilium connectivity perf <span class="nt">-h</span>
<span class="c"># =&gt; Usage:</span>
<span class="c">#      cilium connectivity perf [flags]</span>
<span class="c">#    </span>
<span class="c">#    Flags:</span>
<span class="c">#          --bandwidth                        Test pod network bandwidth manage</span>
<span class="c">#          --crr                              Run CRR test</span>
<span class="c">#      -d, --debug                            Show debug messages</span>
<span class="c">#          --duration duration                Duration for the Performance test to run (default 10s)</span>
<span class="c">#      -h, --help                             help for perf</span>
<span class="c">#          --host-net                         Test host network (default true)</span>
<span class="c">#          --host-to-pod                      Test host-to-pod traffic</span>
<span class="c">#          --msg-size int                     Size of message to use in UDP test (default 1024)</span>
<span class="c">#          --namespace-labels map             Add labels to the connectivity test namespace</span>
<span class="c">#          --net-qos                          Test pod network Quality of Service</span>
<span class="c">#          --node-selector-client map         Node selector for the other-node client pod</span>
<span class="c">#          --node-selector-server map         Node selector for the server pod (and client same-node)</span>
<span class="c">#          --other-node                       Run tests in which the client and the server are hosted on difference nodes (default true)</span>
<span class="c">#          --performance-image string         Image path to use for performance (default "quay.io/cilium/network-perf:1751527436-c2462ae@sha256:0c491ed7ca63e6c526593b3a2d478f856410a50fbbce7fe2b64283c3015d752f")</span>
<span class="c">#          --pod-net                          Test pod network (default true)</span>
<span class="c">#          --pod-to-host                      Test pod-to-host traffic</span>
<span class="c">#          --print-image-artifacts            Prints the used image artifacts</span>
<span class="c">#          --report-dir string                Directory to save perf results in json format</span>
<span class="c">#          --rr                               Run RR test (default true)</span>
<span class="c">#          --same-node                        Run tests in which the client and the server are hosted on the same node (default true)</span>
<span class="c">#          --samples int                      Number of Performance samples to capture (how many times to run each test) (default 1)</span>
<span class="c">#          --setup-delay duration             Extra delay before starting the performance tests</span>
<span class="c">#          --streams uint                     The parallelism of tests with multiple streams (default 4)</span>
<span class="c">#          --test-namespace string            Namespace to perform the connectivity in (always suffixed with a sequence number to be compliant with test-concurrency param, e.g.: cilium-test-1) (default "cilium-test")</span>
<span class="c">#          --throughput                       Run throughput test (default true)</span>
<span class="c">#          --throughput-multi                 Run throughput test with multiple streams (default true)</span>
<span class="c">#          --tolerations strings              Extra NoSchedule tolerations added to test pods</span>
<span class="c">#          --udp                              Run UDP tests</span>
<span class="c">#          --unsafe-capture-kernel-profiles   Capture kernel profiles during test execution. Warning: run on disposable nodes only, as it installs additional software and modifies their configuration</span>
<span class="c">#    </span>
<span class="c">#    Global Flags:</span>
<span class="c">#          --as string                  Username to impersonate for the operation. User could be a regular user or a service account in a namespace.</span>
<span class="c">#          --as-group stringArray       Group to impersonate for the operation, this flag can be repeated to specify multiple groups.</span>
<span class="c">#          --context string             Kubernetes configuration context</span>
<span class="c">#          --helm-release-name string   Helm release name (default "cilium")</span>
<span class="c">#          --kubeconfig string          Path to the kubeconfig file</span>
<span class="c">#      -n, --namespace string           Namespace Cilium is running in (default "kube-system")</span>
</code></pre></div>    </div>
  </li>
</ul>

<h3 id="cilium-performance--tuning">Cilium Performance &amp; Tuning</h3>

<ul>
  <li>ë‹¤ìŒì˜ Youtube ì˜ìƒì„ ì°¸ê³ í•˜ì—¬ Ciliumì˜ ì„±ëŠ¥ê³¼ íŠœë‹ì— ëŒ€í•´ì„œ ì•Œì•„ë´…ë‹ˆë‹¤.
    <ul>
      <li>Deep Dive Into Cilium Resilient Architecture : Map Size - Jussi MÃ¤ki &amp; Martynas Pumputis, Isovalent - <a href="https://www.youtube.com/watch?v=YX0sql_3dt8">Youtube</a>
</li>
    </ul>
  </li>
  <li>ì–´ëŠë‚  íŒ¨í‚· Dropì´ ë°œìƒí•˜ë©° Service Backendê°€ ì•ˆ ë³´ì´ëŠ” í˜„ìƒì´ ë°œê²¬ ë˜ì—ˆìŠµë‹ˆë‹¤.
<img src="/assets/2025/cilium/w7/20250831_cilium_w7_24.png" alt="img.png" class="image-center" loading="lazy" width="1158" height="673">
<em class="image-caption">Egress Packetì´ Dropë˜ëŠ” í˜„ìƒ ë°œìƒì‹œì˜ Cilium Drop Metric</em>
</li>
  <li>ë˜í•œ ì¼ë¶€ Cilium-agentê°€ ìƒíƒœì €í•˜ (Degraded) ìƒíƒœê°€ ë˜ëŠ” í˜„ìƒë„ ë°œê²¬ ë˜ì—ˆìŠµë‹ˆë‹¤.
<img src="/assets/2025/cilium/w7/20250831_cilium_w7_25.png" alt="img_1.png" class="image-center" loading="lazy" width="1143" height="519">
<em class="image-caption">ìƒíƒœ ì €í•˜ëœ Cilium Agent</em>
</li>
  <li>BPF Map Pressure ë©”íŠ¸ë¦­ì„ í™•ì¸í•´ë³´ë‹ˆ ì›ì¸ì´ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤. BPF Map Pressureê°€ 144%ë‚˜ ëœ ê²ƒì…ë‹ˆë‹¤!
<img src="/assets/2025/cilium/w7/20250831_cilium_w7_26.png" alt="img_2.png" loading="lazy" width="1151" height="373">
</li>
  <li>ë˜í•œ ì•„ë˜ì˜ ëª…ë ¹ì„ ì‹¤í–‰í•˜ë‹ˆ lb4_service_v2 Map ì—…ë°ì´íŠ¸ë¥¼ ë‹´ë‹¹í•˜ëŠ” ì¡°ì •ì(reconciler)ê°€ ì‹¤íŒ¨í•˜ê³  ìˆìŒì„ ì•Œ ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.
    <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kubectl <span class="nb">exec</span> <span class="nt">-it</span> <span class="nt">-n</span> kube-system ds/cilium <span class="nt">--</span> cilium status <span class="nt">--verbose</span> 
</code></pre></div>    </div>
    <p><img src="/assets/2025/cilium/w7/20250831_cilium_w7_27.png" alt="img.png" loading="lazy" width="818" height="166"></p>
  </li>
  <li>Service Map ìƒíƒœì •ë³´ë¥¼ í™•ì¸í•˜ë‹ˆ <code class="language-plaintext highlighter-rouge">Error: map is full</code> ì—ëŸ¬ë¥¼ í™•ì¸ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="c"># í˜„ì¬ëŠ” ëª…ë ¹ ì…ë ¥ ë°©ì‹ì´ ë³€ê²½ë¨</span>
<span class="c"># $ k exec -it -n kube-system ds/cilium -- cilium statedb service4</span>
  
<span class="c"># í˜„ì¬ëŠ” ì•„ë˜ì˜ ëª…ë ¹ìœ¼ë¡œ í™•ì¸í•  ìˆ˜ ìˆë‹¤ê³  í•˜ëŠ”ë° í™•ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.</span>
<span class="nv">$ </span>kubectl <span class="nb">exec</span> <span class="nt">-n</span> kube-system ds/cilium <span class="nt">-c</span> cilium-agent <span class="nt">--</span> cilium-dbg service list
<span class="c"># =&gt; ID   Frontend                Service Type   Backend</span>
<span class="c">#    1    10.96.88.253:443/TCP    ClusterIP      1 =&gt; 172.20.0.2:4244/TCP (active)</span>
<span class="c">#    2    10.96.205.94:80/TCP     ClusterIP      1 =&gt; 10.244.1.194:4245/TCP (active)</span>
<span class="c">#    3    0.0.0.0:30003/TCP       NodePort       1 =&gt; 10.244.1.179:8081/TCP (active)</span>
<span class="c">#    5    10.96.167.52:80/TCP     ClusterIP      1 =&gt; 10.244.1.179:8081/TCP (active)</span>
<span class="c">#    6    10.96.0.10:53/TCP       ClusterIP      1 =&gt; 10.244.1.48:53/TCP (active)</span>
<span class="c">#                                                2 =&gt; 10.244.2.250:53/TCP (active)</span>
<span class="c">#    7    10.96.0.10:53/UDP       ClusterIP      1 =&gt; 10.244.1.48:53/UDP (active)</span>
<span class="c">#                                                2 =&gt; 10.244.2.250:53/UDP (active)</span>
<span class="c">#    8    10.96.0.10:9153/TCP     ClusterIP      1 =&gt; 10.244.1.48:9153/TCP (active)</span>
<span class="c">#                                                2 =&gt; 10.244.2.250:9153/TCP (active)</span>
<span class="c">#    9    10.96.0.1:443/TCP       ClusterIP      1 =&gt; 172.20.0.2:6443/TCP (active)</span>
<span class="c">#    10   10.96.193.155:443/TCP   ClusterIP      1 =&gt; 10.244.3.24:10250/TCP (active)</span>
<span class="c">#    11   10.96.85.141:3000/TCP   ClusterIP      1 =&gt; 10.244.2.71:3000/TCP (active)</span>
<span class="c">#    12   10.96.59.105:9090/TCP   ClusterIP      1 =&gt; 10.244.1.36:9090/TCP (active)</span>
<span class="c">#    13   0.0.0.0:30001/TCP       NodePort       1 =&gt; 10.244.1.36:9090/TCP (active)</span>
<span class="c">#    15   0.0.0.0:30002/TCP       NodePort       1 =&gt; 10.244.2.71:3000/TCP (active) </span>
</code></pre></div>    </div>
    <p><img src="/assets/2025/cilium/w7/20250831_cilium_w7_28.png" alt="img.png" loading="lazy" width="642" height="566"></p>
  </li>
  <li>í•´ê²° ë°©ì•ˆì€ serivce mapì˜ í¬ê¸°ë¥¼ ëŠ˜ë¦¬ê±°ë‚˜ ë¬¸ì œê°€ ë˜ëŠ” ê¸°ì¡´ serviceë¥¼ ì‚­ì œí•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.</li>
  <li>í•´ë‹¹ ì˜ìƒì—ì„œëŠ” serviceë¥¼ ì‚­ì œí•´ì„œ ë¬¸ì œë¥¼ í•´ê²° í•˜ì˜€ìŠµë‹ˆë‹¤.</li>
  <li>ì´ë ‡ë“¯ ë©”íŠ¸ë¦­ì„ ì˜ ëª¨ë‹ˆí„°ë§í•˜ê³  ìˆë‹¤ë©´ ë¬¸ì œë¥¼ ë¹ ë¥´ê²Œ ë°œê²¬í•˜ê³  í•´ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
</ul>

<h4 id="deep-dive-into-cilium-resilient-architecture--apievent-ì™€-cilium-agentstatedb-ì™€-bpf-ë™ì‘">Deep Dive Into Cilium Resilient Architecture : API(Event) ì™€ Cilium-Agent(StateDB) ì™€ BPF ë™ì‘</h4>

<ul>
  <li>Ciliumì˜ ì¥ì• ë‚˜ ì„±ëŠ¥ ì €í•˜ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ì„œëŠ” Ciliumì˜ ì•„í‚¤í…ì²˜ë¥¼ ì´í•´í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤.
<img src="/assets/2025/cilium/w7/20250831_cilium_w7_29.png" alt="img.png" loading="lazy" width="1171" height="626">
</li>
  <li>Ciliumì€ ì¿ ë²„ë„¤í‹°ìŠ¤ API ì„œë²„ë¡œë¶€í„° Service Endpointì— ëŒ€í•œ ì´ë²¤íŠ¸ë¥¼ ë°›ì•„ì„œ Cilium-Agentê°€ ìƒíƒœë¥¼ ê´€ë¦¬í•˜ê³ , ì´ë¥¼ BPFë¡œ ë°˜ì˜í•˜ëŠ” êµ¬ì¡°ë¡œ ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</li>
  <li>ì´ë¥¼ service mapìœ¼ë¡œ ê´€ë¦¬í•˜ëŠ”ë° service mapì˜ í¬ê¸°ê°€ ë¶€ì¡±í•˜ë©´ ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ ì €ì¥ì†Œ(StateDB)ì™€ BPF Mapì˜ í¬ê¸°ë¥¼ ì ì ˆíˆ ì„¤ì •í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤.</li>
  <li>
<strong>StateDB</strong>ë€?
    <ul>
      <li>In-memory Transactional ë°ì´í„° ë² ì´ìŠ¤ë¡œ, ë¶ˆê°€ë³€ì˜ ë°ì´í„° êµ¬ì¡°(Immutable Data Structure)ë¥¼ ì‚¬ìš©í•˜ì—¬ ë™ì‹œì„± ë¬¸ì œë¥¼ í•´ê²°í•©ë‹ˆë‹¤.</li>
      <li>ì±„ë„ ê¸°ë°˜ ë³€ê²½ ì•Œë¦¼ ë©”ì»¤ë‹ˆì¦˜ì„ ì‚¬ìš©í•˜ì—¬ ì´ë²¤íŠ¸ ê¸°ë°˜ ì•„í‚¤í…ì²˜ë¥¼ êµ¬í˜„í•©ë‹ˆë‹¤.</li>
      <li>Cilium-AgentëŠ” StateDBë¥¼ ì‚¬ìš©í•˜ì—¬ ì¿ ë²„ë„¤í‹°ìŠ¤ API ì„œë²„ë¡œ ë¶€í„° ë°›ì€ ì´ë²¤íŠ¸ë¥¼ ì²˜ë¦¬í•˜ê³ , ìƒíƒœë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤.
<img src="/assets/2025/cilium/w7/20250831_cilium_w7_30.png" alt="img.png" class="image-center w-60" loading="lazy" width="661" height="249">
<em class="image-caption">StateDBì˜ ìë£Œ êµ¬ì¡°</em>
</li>
    </ul>
  </li>
  <li>
<strong>eBPF Maps</strong> ì†Œê°œ - mapDynamicSizeRatio - <a href="https://docs.cilium.io/en/stable/operations/performance/tuning/#ebpf-map-sizing">Docs</a>, <a href="https://docs.cilium.io/en/stable/network/ebpf/maps/#bpf-map-limitations">Maps-Limits</a>
    <ul>
      <li>ëª¨ë“  eBPF Mapë“¤ì€ ìµœëŒ€ í¬ê¸°ê°€ ì •í•´ì ¸ ìˆìŠµë‹ˆë‹¤. ìµœëŒ€ í¬ê¸° ì´ìƒì˜ ë°ì´í„°ë¥¼ ì €ì¥í•˜ë ¤ê³  í•˜ë©´ <code class="language-plaintext highlighter-rouge">map is full</code> ì—ëŸ¬ê°€ ë°œìƒí•˜ê±°ë‚˜ datapathì˜ ì„±ëŠ¥ ì €í•˜ê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
      <li>Ciliumì€ ì‹œìŠ¤í…œ ì „ì²´ ë©”ëª¨ë¦¬ì˜ ì¼ì • ë¹„ìœ¨ì„ eBPF Mapì— í• ë‹¹í•©ë‹ˆë‹¤.</li>
      <li>í•˜ì§€ë§Œ Cilium agentì— ì˜í•´ ì‚¬ìš©ë˜ëŠ” ìµœëŒ€ ìš©ëŸ‰ì€ ê³ ê¸‰ ì„¤ì •ì„ í†µí•´ ì¡°ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. <a href="https://docs.cilium.io/en/stable/network/ebpf/maps/#bpf-map-limitations">eBPF Maps Guide</a> ë¥¼ ì°¸ì¡°í•˜ì„¸ìš”.</li>
    </ul>
  </li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># í˜„ì¬ BPF Maps í¬ê¸° í™•ì¸</span>
<span class="nv">$ </span>kubectl <span class="nb">exec</span> <span class="nt">-it</span> <span class="nt">-n</span> kube-system ds/cilium <span class="nt">--</span> cilium status <span class="nt">--verbose</span>
<span class="c"># =&gt; ...</span>
<span class="c">#    BPF Maps:   dynamic sizing: on (ratio: 0.002500)</span>
<span class="c">#      Name                          Size</span>
<span class="c">#      Auth                          524288</span>
<span class="c">#      Non-TCP connection tracking   65536</span>
<span class="c">#      TCP connection tracking       131072</span>
<span class="c">#      Endpoints                     65535</span>
<span class="c">#      IP cache                      512000</span>
<span class="c">#      IPv4 masquerading agent       16384</span>
<span class="c">#      IPv6 masquerading agent       16384</span>
<span class="c">#      IPv4 fragmentation            8192</span>
<span class="c">#      IPv4 service                  65536</span>
<span class="c">#      IPv6 service                  65536</span>
<span class="c">#      IPv4 service backend          65536</span>
<span class="c">#      IPv6 service backend          65536</span>
<span class="c">#      IPv4 service reverse NAT      65536</span>
<span class="c">#      IPv6 service reverse NAT      65536</span>
<span class="c">#      Metrics                       1024</span>
<span class="c">#      Ratelimit metrics             64</span>
<span class="c">#      NAT                           131072</span>
<span class="c">#      Neighbor table                131072</span>
<span class="c">#      Endpoint policy               16384</span>
<span class="c">#      Policy stats                  65534</span>
<span class="c">#      Session affinity              65536</span>
<span class="c">#      Sock reverse NAT              65536</span>
  
<span class="c"># BPF Maps í¬ê¸°ì˜ ë¹„ì¤‘ ì¡°ì • (0.0025 -&gt; 0.01)</span>
<span class="nv">$ </span>helm upgrade cilium cilium/cilium <span class="nt">--version</span> 1.18.1 <span class="nt">--namespace</span> kube-system <span class="nt">--reuse-values</span> <span class="se">\</span>
  <span class="nt">--set</span> bpf.distributedLRU.enabled<span class="o">=</span><span class="nb">true</span> <span class="nt">--set</span> bpf.mapDynamicSizeRatio<span class="o">=</span>0.01

<span class="c"># Cilium DaemonSet ì¬ì‹œì‘</span>
<span class="nv">$ </span>kubectl <span class="nt">-n</span> kube-system rollout restart ds/cilium

<span class="c"># BPF Maps ì— ë§ì€ ê°’ë“¤ì´ ë…¸ë“œ ì´ ë©”ëª¨ë¦¬ ë¹„ì¤‘ë³„ë¡œ ë°˜ì˜</span>
<span class="nv">$ </span>kubectl <span class="nb">exec</span> <span class="nt">-it</span> <span class="nt">-n</span> kube-system ds/cilium <span class="nt">--</span> cilium status <span class="nt">--verbose</span>
<span class="c"># =&gt; ...</span>
<span class="c">#    BPF Maps:   dynamic sizing: on (ratio: &lt;span style="color: green;"&gt;0.010000)&lt;/span&gt;</span>
<span class="c">#      Name                          Size</span>
<span class="c">#      Auth                          524288</span>
<span class="c">#      Non-TCP connection tracking   &lt;span style="color: green;"&gt;90475&lt;/span&gt;</span>
<span class="c">#      TCP connection tracking       &lt;span style="color: green;"&gt;180943&lt;/span&gt;</span>
<span class="c">#      Endpoints                     65535</span>
<span class="c">#      ...</span>
<span class="c">#      Ratelimit metrics             64</span>
<span class="c">#      NAT                           &lt;span style="color: green;"&gt;180943&lt;/span&gt;</span>
<span class="c">#      Neighbor table                &lt;span style="color: green;"&gt;180943&lt;/span&gt;</span>
<span class="c">#      Endpoint policy               16384</span>
<span class="c">#      Policy stats                  65534</span>
<span class="c">#      Session affinity              65536</span>
<span class="c">#      Sock reverse NAT              &lt;span style="color: green;"&gt;90475&lt;/span&gt;</span>
</code></pre></div></div>

<h5 id="kubernetes-api-server-improvements--v118-ë¶€í„°-cilium_client-ê°€-k8s-api-ì„œë²„-ë¶€í•˜ë¶„ì‚°ha-ì—°ê²°-ê°€ëŠ¥---blog">Kubernetes API server improvements : v1.18 ë¶€í„° Cilium_client ê°€ K8S API ì„œë²„ ë¶€í•˜ë¶„ì‚°/HA ì—°ê²° ê°€ëŠ¥ - <a href="https://isovalent.com/blog/post/cilium-1-18/#operations">Blog</a>
</h5>

<ul>
  <li>Cilium v1.18 ë¶€í„°ëŠ” Cilium-agentê°€ ì¿ ë²„ë„¤í‹°ìŠ¤ API ì„œë²„ì— HAë¡œ ì—°ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. (<code class="language-plaintext highlighter-rouge">--set k8s.apiServerURLs="https://172.21.0.4:6443 https://172.21.0.5:6443 https://172.21.0.6:6443"</code> ë¥¼ í†µí•´ ì§€ì •ê°€ëŠ¥í•©ë‹ˆë‹¤.)</li>
  <li>v1.18 ì´ì „ì—ëŠ” ë‹¨ì¼ API ì„œë²„ì—ë§Œ ì—°ê²°í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.</li>
  <li>Ciliumì€ ë™ì‘ ì¤‘ì¸ API ì„œë²„ì˜ ëª©ë¡ì„ ì´ˆê¸°í™” ì‹œì ì— ê°€ì ¸ì˜¤ê³ , ì´í›„ì—ëŠ” ì£¼ê¸°ì ìœ¼ë¡œ API ì„œë²„ì˜ ìƒíƒœë¥¼ í™•ì¸í•˜ì—¬, Heartbeatë¥¼ í†µí•´ ì—°ê²° ìƒíƒœë¥¼ ì²´í¬í•˜ê³ , ì²´í¬ê°€ ì‹¤íŒ¨í•  ê²½ìš° ë‹¤ë¥¸ API ì„œë²„ë¡œ ì—°ê²°ì„ ì‹œë„í•©ë‹ˆë‹¤.</li>
  <li>ì¼ë¶€ ì‹œë‚˜ë¦¬ì˜¤ì—ì„œëŠ” Kubernetes API ì„œë²„ì—ì„œ ì •ë³´ë¥¼ ê²€ìƒ‰í•˜ë©´ ê³¼ë¶€í•˜ê°€ ê±¸ë¦¬ê±°ë‚˜ API ì„œë²„ì˜ ê°€ìš©ì„±ì— í•´ë¡œìš¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤(íŠ¹íˆ LIST ìš”ì²­).</li>
  <li>API ì„œë²„ì— ìš”ì²­ ì‹œ exponential back-off ì„¤ì • ê°€ëŠ¥.
    <div class="language-yaml highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="na">k8sClientExponentialBackoff</span><span class="pi">:</span>
    <span class="na">enabled</span><span class="pi">:</span> <span class="kc">true</span>
    <span class="na">backoffBaseSeconds</span><span class="pi">:</span> <span class="m">1</span>
    <span class="na">backoffMaxDurationSeconds</span><span class="pi">:</span> <span class="m">120</span>
</code></pre></div>    </div>
  </li>
</ul>

<h3 id="kubernetes-perf-tests">Kubernetes perf-tests</h3>

<ul>
  <li>ì´ë²ˆì—ëŠ” perf-testsë¥¼ ì‚¬ìš©í•˜ì—¬ ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì˜ ì„±ëŠ¥ì„ ì¸¡ì •í•´ë´…ë‹ˆë‹¤.</li>
  <li>Kube-burnerì™€ ê±°ì˜ ë¹„ìŠ·í•©ë‹ˆë‹¤. ì°¨ì´ì ì€ perf-testsëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ì˜ ê³µì‹ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ ë„êµ¬ë¼ëŠ” ê²ƒì…ë‹ˆë‹¤. <a href="https://github.com/kubernetes/perf-tests">GitHub</a>
</li>
  <li>perf-testsì—ëŠ” CL2, DNS ë“± ë‹¤ì–‘í•œ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</li>
  <li>
<strong>ClusterLoader2</strong> (CL2) : Kubernetes ë¶€í•˜ í…ŒìŠ¤íŠ¸ ë„êµ¬ì´ì ê³µì‹ K8s í™•ì¥ì„± ë° ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬ì…ë‹ˆë‹¤. - <a href="https://github.com/kubernetes/perf-tests/tree/master/clusterloader2">Link</a>
    <ul>
      <li>í…ŒìŠ¤íŠ¸ëŠ” í´ëŸ¬ìŠ¤í„°ì˜ ì›í•˜ëŠ” ìƒíƒœ ì§‘í•©(ì˜ˆ: 10,000ê°œì˜ í¬ë“œ, 2,000ê°œì˜ í´ëŸ¬ìŠ¤í„° IP ì„œë¹„ìŠ¤ ë˜ëŠ” 5ê°œì˜ ë°ëª¬ ì„¸íŠ¸ë¥¼ ì‹¤í–‰)ì„ ì •ì˜í•˜ê³  ê° ìƒíƒœì— ë„ë‹¬í•˜ëŠ” ì†ë„(í¬ë“œ ì²˜ë¦¬ëŸ‰)ë¥¼ ì§€ì •í•©ë‹ˆë‹¤.</li>
      <li>CL2ëŠ” ë˜í•œ ì¸¡ì •í•  ì„±ëŠ¥ íŠ¹ì„±ì„ ì •ì˜í•©ë‹ˆë‹¤. ( ìì„¸í•œ ë‚´ìš©ì€Â <a href="https://github.com/kubernetes/perf-tests/tree/master/clusterloader2#Measurement">ì¸¡ì • ëª©ë¡</a>Â ì°¸ì¡° ).</li>
      <li>CL2ëŠ”Â <a href="https://github.com/kubernetes/perf-tests/tree/master/clusterloader2#prometheus-metrics">Prometheusë¥¼</a>Â ì‚¬ìš©í•œ í…ŒìŠ¤íŠ¸ ì¤‘ì— í´ëŸ¬ìŠ¤í„°ì— ëŒ€í•œ ì¶”ê°€ì ì¸ ê´€ì¸¡ì„±ì„ ì œê³µí•©ë‹ˆë‹¤.</li>
      <li>
        <p>ì‚¬ìš© ê°€ëŠ¥í•œ ì¸¡ì •ê°’</p>

        <table>
          <thead>
            <tr>
              <th>ì¸¡ì • í•­ëª©</th>
              <th>ì„¤ëª…</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>APIAvailabilityMeasurement</td>
              <td>
<code class="language-plaintext highlighter-rouge">/readyz</code> API í˜¸ì¶œë¡œ í´ëŸ¬ìŠ¤í„°/í˜¸ìŠ¤íŠ¸ ê°€ìš©ì„± ì¸¡ì •, exec ì„œë¹„ìŠ¤ í•„ìš”</td>
            </tr>
            <tr>
              <td>APIResponsivenessPrometheusSimple</td>
              <td>Prometheus ê¸°ë°˜, API í˜¸ì¶œ ì§€ì—°/íšŸìˆ˜ ë°±ë¶„ìœ„ìˆ˜, SLO ì¶©ì¡± ì—¬ë¶€ í™•ì¸, Prometheus ì—†ìœ¼ë©´ ìƒëµ</td>
            </tr>
            <tr>
              <td>APIResponsivenessPrometheus</td>
              <td>Prometheus ê¸°ë°˜, API í˜¸ì¶œ ì§€ì—°/ê°œìˆ˜ ìš”ì•½, SLO ì¶©ì¡± ì—¬ë¶€ í™•ì¸, Prometheus ì—†ìœ¼ë©´ ìƒëµ</td>
            </tr>
            <tr>
              <td>CPUProfile</td>
              <td>pprofë¡œ íŠ¹ì • ì»´í¬ë„ŒíŠ¸ì˜ CPU ì‚¬ìš© í”„ë¡œí•„ ìˆ˜ì§‘</td>
            </tr>
            <tr>
              <td>EtcdMetrics</td>
              <td>etcd ë©”íŠ¸ë¦­ ë° DB í¬ê¸° ìˆ˜ì§‘</td>
            </tr>
            <tr>
              <td>MemoryProfile</td>
              <td>pprofë¡œ íŠ¹ì • ì»´í¬ë„ŒíŠ¸ì˜ ë©”ëª¨ë¦¬ í”„ë¡œí•„ ìˆ˜ì§‘</td>
            </tr>
            <tr>
              <td>MetricsForE2E</td>
              <td>kube-apiserver, ì»¨íŠ¸ë¡¤ëŸ¬, ìŠ¤ì¼€ì¤„ëŸ¬, kubelet ë©”íŠ¸ë¦­ ìˆ˜ì§‘</td>
            </tr>
            <tr>
              <td>PodPeriodicCommand</td>
              <td>ì§€ì • í¬ë“œì—ì„œ ì£¼ê¸°ì ìœ¼ë¡œ ëª…ë ¹ ì‹¤í–‰, ì¶œë ¥ ìˆ˜ì§‘</td>
            </tr>
            <tr>
              <td>PodStartupLatency</td>
              <td>Pod ì‹œì‘ SLO ì¶©ì¡± ì—¬ë¶€ í™•ì¸</td>
            </tr>
            <tr>
              <td>ResourceUsageSummary</td>
              <td>ì»´í¬ë„ŒíŠ¸ë³„ ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ ìš”ì•½, ì œì•½ ì¡°ê±´ ìœ„ë°˜ ì‹œ ì˜¤ë¥˜</td>
            </tr>
            <tr>
              <td>SchedulingMetrics</td>
              <td>ìŠ¤ì¼€ì¤„ëŸ¬ ë©”íŠ¸ë¦­ ì„¸íŠ¸ ìˆ˜ì§‘</td>
            </tr>
            <tr>
              <td>SchedulingThroughput</td>
              <td>ìŠ¤ì¼€ì¤„ë§ ì²˜ë¦¬ëŸ‰ ìˆ˜ì§‘</td>
            </tr>
            <tr>
              <td>Timer</td>
              <td>í…ŒìŠ¤íŠ¸ íŠ¹ì • ë¶€ë¶„ ëŒ€ê¸° ì‹œê°„ ì¸¡ì •</td>
            </tr>
            <tr>
              <td>WaitForControlledPodsRunning</td>
              <td>ì œì–´ ê°ì²´ì˜ ëª¨ë“  í¬ë“œ ì‹¤í–‰ê¹Œì§€ ëŒ€ê¸°, ì‹œê°„ ì´ˆê³¼ ì‹œ ì˜¤ë¥˜ ê¸°ë¡</td>
            </tr>
            <tr>
              <td>WaitForRunningPods</td>
              <td>í•„ìš”í•œ ìˆ˜ì˜ Pod ì‹¤í–‰ê¹Œì§€ ëŒ€ê¸°, ì‹œê°„ ì´ˆê³¼ ì‹œ ì˜¤ë¥˜ ê¸°ë¡</td>
            </tr>
            <tr>
              <td>Sleep</td>
              <td>ì§€ì • ì‹œê°„ë§Œí¼ ëŒ€ê¸°</td>
            </tr>
            <tr>
              <td>WaitForGenericK8sObjects</td>
              <td>K8s ê°ì²´ê°€ ì¡°ê±´ ì¶©ì¡±í•  ë•Œê¹Œì§€ ëŒ€ê¸°, ì‹œê°„ ì´ˆê³¼ ì‹œ ì˜¤ë¥˜ ê¸°ë¡</td>
            </tr>
          </tbody>
        </table>
      </li>
      <li>kind ì—ì„œ 1ëŒ€ ë…¸ë“œì—ì„œ ê°„ë‹¨ í…ŒìŠ¤íŠ¸ ê°€ì´ë“œ ì†Œê°œ - <a href="https://github.com/kubernetes/perf-tests/blob/master/clusterloader2/docs/GETTING_STARTED.md">Guide</a>
</li>
      <li>100ë…¸ë“œ ê·œëª¨ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ - <a href="https://github.com/kubernetes/perf-tests/blob/master/clusterloader2/docs/GETTING_STARTED.md">Guide</a> , <a href="https://github.com/kubernetes/perf-tests/tree/master/clusterloader2/testing/load">LoadCode</a>
        <ul>
          <li>í…ŒìŠ¤íŠ¸ ë‹¨ê³„ : ê°ì²´ ìƒì„± â†’ ì›ë˜ í¬ê¸°ì˜ 50%, 150% ì‚¬ì´ë¡œ ê°œì²´ í¬ê¸° ì¡°ì • â†’ ê°ì²´ ì‚­ì œ</li>
          <li>
<strong>100ê°œ ë…¸ë“œ</strong>ë¶€í„° <strong>ìµœëŒ€ 5,000ê°œ ë…¸ë“œ</strong>ê¹Œì§€ <strong>í´ëŸ¬ìŠ¤í„°ë¥¼ í…ŒìŠ¤íŠ¸</strong>í•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
          <li>ë¶€í•˜ í…ŒìŠ¤íŠ¸ëŠ” ì•½ <strong>30ê°œì˜ ë…¸ë“œë¡œ êµ¬ì„±ëœ í¬ë“œ ê°ì²´ë¥¼ ìƒì„±í•©</strong>ë‹ˆë‹¤. ë‹¤ìŒê³¼ ê°™ì€ ê°ì²´ê°€ ìƒì„±ë©ë‹ˆë‹¤.
            <ul>
              <li>deployments</li>
              <li>jobs</li>
              <li>statefulsets</li>
              <li>services</li>
              <li>secrets</li>
              <li>configmaps</li>
            </ul>
          </li>
        </ul>
      </li>
      <li>í”„ë¡œë©”í…Œìš°ìŠ¤ ì¸¡ì • ê¸°ì¤€ì— ë”°ë¼ ë‹¤ì–‘í•œ ì¸¡ì •ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´,
        <ul>
          <li>API ì‘ë‹µì„± - kube-apiserverì— ëŒ€í•œ ìš”ì²­ ì§€ì—° ì‹œê°„ì„ ì¸¡ì •í•©ë‹ˆë‹¤.</li>
          <li>ìŠ¤ì¼€ì¤„ë§ ì²˜ë¦¬ëŸ‰</li>
          <li>NodeLocalDNS ëŒ€ê¸° ì‹œê°„</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>
<strong>DNS (CoreDNS, nodeLocal DNSCache)</strong> : DNS ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ - <a href="https://github.com/kubernetes/perf-tests/tree/master/dns">Link</a>
    <ul>
      <li>ë‹¨ì¼ DNS ì„œë²„ ì¸ìŠ¤í„´ìŠ¤ì˜ ì„±ëŠ¥ì„ ì§€ì •ëœ ì¿¼ë¦¬ ì›Œí¬ë¡œë“œë¡œ ë²¤ì¹˜ë§ˆí‚¹í•©ë‹ˆë‹¤.</li>
      <li>Benchmarking the cluster DNS : coredns ì„±ëŠ¥ ì¸¡ì • - <a href="https://perf-dash.k8s.io/#/?jobname=kube-dns%20benchmark&amp;metriccategoryname=dns&amp;metricname=Latency&amp;query_file=all-queries.txt&amp;run_length_seconds=600">ê²°ê³¼</a>
</li>
      <li>Comparing cluster DNS and NodeLocal DNSCache : NodeLocal DNSCache í™œì„±í™” ì‹œ ì„±ëŠ¥ ë¹„êµ - <a href="https://perf-dash.k8s.io/#/?jobname=node-local-dns%20benchmark&amp;metriccategoryname=dns&amp;metricname=Latency&amp;query_file=all-queries.txt&amp;run_length_seconds=600">ê²°ê³¼</a>
</li>
      <li>CoreDNS and kube-dns v1.5+ (imageÂ <code class="language-plaintext highlighter-rouge">registry.k8s.io/kubedns-amd64:1.9</code>) can exportÂ <a href="http://prometheus.io/">Prometheus</a>Â metrics.</li>
    </ul>
  </li>
  <li>
<strong>Benchmarking Kubernetes Networking Performance</strong> : Kubernetes ë„¤íŠ¸ì›Œí‚¹ ì„±ëŠ¥ì„ ì¸¡ì •í•˜ëŠ” í‘œì¤€í™”ëœ ë²¤ì¹˜ë§ˆí¬ - <a href="https://github.com/kubernetes/perf-tests/tree/master/network/benchmarks/netperf">Link</a>
    <ul>
      <li>ë²¤ì¹˜ë§ˆí¬ëŠ” ë‹¨ì¼ Go ë°”ì´ë„ˆë¦¬ í˜¸ì¶œì„ í†µí•´ ì‹¤í–‰í•  ìˆ˜ ìˆìœ¼ë©°, ì•„ë˜ì—ì„œ ë³¼ ìˆ˜ ìˆë“¯ì´ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„° ë° ì›Œì»¤ í¬ë“œì— ìˆëŠ” ëª¨ë“  ìë™í™” í…ŒìŠ¤íŠ¸ë¥¼ íŠ¸ë¦¬ê±°í•©ë‹ˆë‹¤.</li>
      <li>í…ŒìŠ¤íŠ¸ëŠ” go ë°”ì´ë„ˆë¦¬ì™€ iperf3 ë° ê¸°íƒ€ ë„êµ¬ê°€ ë‚´ì¥ëœ ì‚¬ìš©ì ì§€ì • ë„ì»¤ ì»¨í…Œì´ë„ˆë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.</li>
      <li>ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„° í¬ë“œëŠ” ì•„ë˜ ì„¤ëª…ëœ 5ê°€ì§€ ì‹œë‚˜ë¦¬ì˜¤ì— ëŒ€í•´ MTU(TCPì˜ ê²½ìš° MSS íŠœë‹, UDPì˜ ê²½ìš° ì§ì ‘ íŒ¨í‚· í¬ê¸° íŠœë‹)ë¥¼ ì‚¬ìš©í•˜ì—¬ ì§ë ¬ ìˆœì„œë¡œ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ë„ë¡ ì›Œì»¤ í¬ë“œë¥¼ ì¡°ì •í•©ë‹ˆë‹¤.</li>
      <li>ë…¸ë“œ ë ˆì´ë¸”ì„ ì‚¬ìš©í•˜ì—¬ ì›Œì»¤ í¬ë“œ 1ê³¼ 2ëŠ” ë™ì¼í•œ ì¿ ë²„ë„¤í‹°ìŠ¤ ë…¸ë“œì— ë°°ì¹˜ë˜ê³ , ì›Œì»¤ í¬ë“œ 3ì€ ë‹¤ë¥¸ ë…¸ë“œì— ë°°ì¹˜ë©ë‹ˆë‹¤.</li>
      <li>ëª¨ë“  ë…¸ë“œëŠ” ê°„ë‹¨í•œ golang rpcsë¥¼ ì‚¬ìš©í•˜ì—¬ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„° í¬ë“œ ì„œë¹„ìŠ¤ì™€ í†µì‹ í•˜ê³  ì‘ì—… í•­ëª©ì„ ìš”ì²­í•©ë‹ˆë‹¤.</li>
      <li>ì´ í…ŒìŠ¤íŠ¸ì—ëŠ” ìµœì†Œ ë‘ ê°œì˜ ì¿ ë²„ë„¤í‹°ìŠ¤ ì›Œì»¤ ë…¸ë“œê°€ í•„ìš”í•©ë‹ˆë‹¤.</li>
      <li>ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„°ì™€ ì›Œì»¤ íŒŒë“œëŠ” ì´ë‹ˆì‹œì—ì´í„° ìŠ¤í¬ë¦½íŠ¸ì™€ ë…ë¦½ì ìœ¼ë¡œ ì‹¤í–‰ë˜ë©°, ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„° íŒŒë“œëŠ” í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì¼ì •ì´ ì™„ë£Œë  ë•Œê¹Œì§€ ì›Œì»¤ë“¤ì—ê²Œ ì‘ì—… í•­ëª©ì„ ì „ì†¡í•©ë‹ˆë‹¤.</li>
      <li>ëª¨ë“  ì›Œì»¤ ë…¸ë“œì˜ <strong>iperf</strong> ì¶œë ¥(TCP ë° UDP ëª¨ë“œ ëª¨ë‘)ê³¼ <strong>netperf TCP</strong> ì¶œë ¥ì€ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„° íŒŒë“œì— ì—…ë¡œë“œë˜ì–´ í•„í„°ë§ë˜ê³  ê·¸ ê²°ê³¼ëŠ” netperf.csvì— ê¸°ë¡ë©ë‹ˆë‹¤.</li>
      <li>ê·¸ëŸ° ë‹¤ìŒ ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸ëŠ” netperf.csv íŒŒì¼ì„ ì¶”ì¶œí•˜ì—¬ ë¡œì»¬ ë””ìŠ¤í¬ì— ê¸°ë¡í•©ë‹ˆë‹¤. csv íŒŒì¼ì˜ ëª¨ë“  ë‹¨ìœ„ëŠ” Mbit/ì´ˆì…ë‹ˆë‹¤.</li>
      <li>ëª¨ë“  ì¿ ë²„ë„¤í‹°ìŠ¤ ì—”í‹°í‹°ëŠ” â€œnetperfâ€ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ì•„ë˜ì— ìƒì„±ë©ë‹ˆë‹¤.</li>
      <li>
        <p>CSV ë°ì´í„° ì¶œë ¥</p>

        <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>  MSS                                          , Maximum, 96, 352, 608, 864, 1120, 1376,
  1 iperf TCP. Same VM using Pod IP            ,35507.000000,33835,33430,35372,35220,35373,35507,
  2 iperf TCP. Same VM using Virtual IP        ,32997.000000,32689,32997,32256,31995,31904,31830,
  3 iperf TCP. Remote VM using Pod IP          ,10652.000000,8793,9836,10602,9959,9941,10652,
  4 iperf TCP. Remote VM using Virtual IP      ,11046.000000,10429,11046,10064,10622,10528,10246,
  5 iperf TCP. Hairpin Pod to own Virtual IP   ,32400.000000,31473,30253,32075,32058,32400,31734,
  6 iperf UDP. Same VM using Pod IP            ,10642.000000,10642,
  7 iperf UDP. Same VM using Virtual IP        ,8983.000000,8983,
  8 iperf UDP. Remote VM using Pod IP          ,11143.000000,11143,
  9 iperf UDP. Remote VM using Virtual IP      ,10836.000000,10836,
  10 netperf. Same VM using Pod IP             ,11675.380000,11675.38,
  11 netperf. Same VM using Virtual IP         ,0.000000,0.00,
  12 netperf. Remote VM using Pod IP           ,6646.820000,6646.82,
  13 netperf. Remote VM using Virtual IP       ,0.000000,0.00,
</code></pre></div>        </div>
      </li>
      <li>CSV ë°ì´í„° ê·¸ë˜í”„í™”
        <ul>
          <li>
<strong>matplotlib</strong>ì„ ì‚¬ìš©í•˜ì—¬ csv ë°ì´í„°(ë° í˜¸í™˜ì„±ì„ ìœ„í•´ PNG ë° JPG íŒŒì¼)ì—ì„œ ê·¸ë˜í”„ SVG íŒŒì¼ì„ ìƒì„±í•©ë‹ˆë‹¤.
            <ul>
              <li>íŒŒì´ì¬ Matplotlib ë¼ì¸ ì°¨íŠ¸</li>
              <li>ë§‰ëŒ€ ì°¨íŠ¸</li>
            </ul>
          </li>
          <li>MSSë¥¼ ë¬´ì‹œí•˜ê³  ìµœëŒ€ ëŒ€ì—­í­ ìˆ˜ì¹˜ë¥¼ ì‚¬ìš©í•˜ë©´ ë§‰ëŒ€í˜• ì°¨íŠ¸ê°€ ì„±ëŠ¥ì„ ë¹„êµí•˜ëŠ” ë° ë” ë‚˜ì€ ë„êµ¬ê°€ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
          <li>CSV ë°ì´í„°ë¥¼ <strong>Google ì‹œíŠ¸</strong>ë¡œ ê°€ì ¸ì™€ì„œ <strong>ê·¸ë˜í”„</strong>ë¡œ í‘œí˜„í•˜ëŠ” ê²ƒë„ ê°€ëŠ¥í•©ë‹ˆë‹¤.</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>
<strong>Network policy enforcement latency</strong> : Pod ë° ë„¤íŠ¸ì›Œí¬ ì •ì±… ë³€ê²½ì— ëŒ€í•œ ë„¤íŠ¸ì›Œí¬ ì •ì±… ì ìš© ì§€ì—° ì‹œê°„ì„ ì¸¡ì • - <a href="https://github.com/kubernetes/perf-tests/tree/master/network/tools/network-policy-enforcement-latency">Link</a>
</li>
  <li>
<strong>Kubernetes Perfdash</strong> : ì„±ëŠ¥ ì§€í‘œë¥¼ ìˆ˜ì§‘í•˜ê³  í‘œì‹œí•˜ëŠ” ì›¹ UI - <a href="https://github.com/kubernetes/perf-tests/tree/master/perfdash">Link</a> , <a href="https://perf-dash.k8s.io/#/?jobname=aws-100Nodes&amp;metriccategoryname=APIServer&amp;metricname=LoadInitEventsCount&amp;resource=configmaps&amp;group=">Demo</a>
    <ul>
      <li>ì„±ëŠ¥ ì§€í‘œëŠ” ë‹¤ì–‘í•œ ë…¸ë“œ ìˆ˜, í”Œë«í¼ ìœ í˜• ë° í”Œë«í¼ ë²„ì „ì— ëŒ€í•œ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ ê²°ê³¼ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤.</li>
      <li>ì§€ì›ë˜ëŠ” ë©”íŠ¸ë¦­
        <ul>
          <li>Responsiveness</li>
          <li>Resources</li>
          <li>PodStartup</li>
          <li>TestPhaseTimer</li>
          <li>RequestCount</li>
          <li>RequestCountByClient</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>
<strong>Kubernetes Performance SLO monitor</strong> : api ì„œë²„ë¡œ ìˆ˜ì§‘í•  ìˆ˜ ì—†ëŠ” ì„±ëŠ¥ SLO()sÂ ë¥¼ ëª¨ë‹ˆí„°ë§ ë° ë©”íŠ¸ë¦­ ë…¸ì¶œ - <a href="https://github.com/kubernetes/perf-tests/tree/master/slo-monitor">Link</a>
    <ul>
      <li>SLO ëª¨ë‹ˆí„°ëŠ” ê°„ë‹¨í•œ Podë¡œ, Podë“¤ ë° ì´ë²¤íŠ¸ë¥¼ ì½ì„ ìˆ˜ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.</li>
      <li>SLO ëª¨ë‹ˆí„°ëŠ” ë‹¤ìŒê³¼ ê°™ì€ SLOë¥¼ ì¸¡ì •í•©ë‹ˆë‹¤.
        <ul>
          <li>Pod startup latency</li>
          <li>Pod scheduling latency</li>
          <li>API server availability</li>
          <li>Event processing latency</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<blockquote>
  <p><img class="emoji" title=":bulb:" alt=":bulb:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f4a1.png" height="20" width="20" loading="lazy"> <strong>SLO(ì„œë¹„ìŠ¤ ìˆ˜ì¤€ ëª©í‘œ, Service Level Objectives)</strong>ëŠ” ê³ ê°ì—ê°€ ê°€ìš©ì„±ì„ ë³´ì¥í•˜ëŠ” SLAë¥¼ ë§Œì¡±í•˜ê¸° ìœ„í•´ ë‚´ë¶€ì ìœ¼ë¡œ ì„¤ì •í•˜ëŠ” ëª©í‘œì¹˜ë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤.</p>
</blockquote>

<h3 id="cilium-tuning-guide">Cilium Tuning Guide</h3>

<h5 id="cilium-endpoint-slices-ces-beta---youtube">Cilium Endpoint Slices (CES) beta - <a href="https://www.youtube.com/watch?v=yKPNmhckJHY">Youtube</a>
</h5>

<ul>
  <li>Ciliumì´ Endpointê°€ ë§ì€ ê²½ìš° watch updateë¥¼ í•˜ë©´ ì—„ì²­ë‚˜ê²Œ ë§ì€ ì´ë²¤íŠ¸ê°€ ë°œìƒí•˜ê¸° ë•Œë¬¸ì— ì„±ëŠ¥ ì €í•˜ê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
  <li>CESëŠ” K8Sì˜ EndpointSlice ì²˜ëŸ¼ Endpointë“¤ì„ Slice ë‹¨ìœ„ë¡œ ë¬¶ì–´ì„œ ê´€ë¦¬í•˜ì—¬, Slice ë‹¨ìœ„ë¡œ watch updateë¥¼ í•  ìˆ˜ ìˆë„ë¡ í•˜ì—¬ ì„±ëŠ¥ì„ ê°œì„ í•©ë‹ˆë‹¤.</li>
</ul>

<p><img src="/assets/2025/cilium/w7/20250831_cilium_w7_31.png" alt="img.png" class="image-center" loading="lazy" width="1225" height="665">
<em class="image-caption">ì´ì „ ë°©ì‹ê³¼ Cilium Endpoint Slice ë„ì… í›„ ë¹„êµ</em></p>

<ul>
  <li>ìœ„ì˜ ê·¸ë¦¼ê³¼ ê°™ì´ ì´ì „ì—ëŠ” ëª¨ë“  ì—”ë“œí¬ì¸íŠ¸ê°€ í•œêº¼ë²ˆì— ê´€ë¦¬ë˜ê³  ì—…ë°ì´íŠ¸ ë˜ì—ˆì§€ë§Œ, CESë¥¼ ì‚¬ìš©í•˜ë©´ ì—”ë“œí¬ì¸íŠ¸ê°€ ì—¬ëŸ¬ ìŠ¬ë¼ì´ìŠ¤ë¡œ ë‚˜ëˆ„ì–´ì ¸ ê° ìŠ¬ë¼ì´ìŠ¤ê°€ ë…ë¦½ì ìœ¼ë¡œ ê´€ë¦¬ë˜ê³  ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤.</li>
  <li>
<strong>ì‚¬ì „ì¡°ê±´</strong>
    <ul>
      <li>CEPê°€ í™œì„±í™” ë˜ì–´ì•¼ í•©ë‹ˆë‹¤. (<code class="language-plaintext highlighter-rouge">-disable-endpoint-crd</code>ê°€ <code class="language-plaintext highlighter-rouge">true</code>ê°€ ì•„ë‹ˆì–´ì•¼ í•©ë‹ˆë‹¤.)</li>
      <li>Egress GatewayëŠ” CESì™€ í˜¸í™˜ë˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ì‚¬ìš©ë˜ì§€ ì•Šì•„ì•¼ í•©ë‹ˆë‹¤.</li>
    </ul>
  </li>
  <li><strong>CES ì„¤ì •</strong></li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># CiliumEndpoint (CEP) per pod : All agents watch for all CEPs, Maps IP to Identity for policy.</span>
<span class="nv">$ </span>kubectl get ciliumendpoints.cilium.io <span class="nt">-A</span>
<span class="c"># =&gt; NAMESPACE            NAME                                      SECURITY IDENTITY   ENDPOINT STATE   IPV4           IPV6</span>
<span class="c">#    cilium-monitoring    grafana-5c69859d9-x2r9v                   48524               ready            10.244.2.71</span>
<span class="c">#    cilium-monitoring    prometheus-6fc896bc5d-zwlkf               46171               ready            10.244.1.36</span>
<span class="c">#    kube-system          coredns-674b8bbfcf-dt7dv                  32751               ready            10.244.2.250</span>
<span class="c">#    kube-system          coredns-674b8bbfcf-khb4w                  32751               ready            10.244.1.48</span>
<span class="c">#    kube-system          hubble-relay-fdd49b976-8mcq9              32342               ready            10.244.1.194</span>
<span class="c">#    kube-system          hubble-ui-655f947f96-ccbxk                7784                ready            10.244.1.179</span>
<span class="c">#    kube-system          metrics-server-5dd7b49d79-gx8jd           24994               ready            10.244.3.24</span>
<span class="c">#    local-path-storage   local-path-provisioner-7dc846544d-phnjz   31623               ready            10.244.2.23</span>
<span class="nv">$ </span>kubectl get ciliumendpoints.cilium.io <span class="nt">-A</span> | <span class="nb">wc</span> <span class="nt">-l</span>
<span class="c"># =&gt;        9</span>
<span class="nv">$ </span>kubectl get crd
<span class="c"># =&gt; ciliumcidrgroups.cilium.io                   2025-08-30T08:12:26Z</span>
<span class="c">#    ciliumclusterwidenetworkpolicies.cilium.io   2025-08-30T08:12:25Z</span>
<span class="c">#    ciliumendpoints.cilium.io                    2025-08-30T08:12:22Z</span>
<span class="c">#    ciliumidentities.cilium.io                   2025-08-30T08:12:20Z</span>
<span class="c">#    ...</span>

<span class="c">#</span>
<span class="nv">$ </span>helm upgrade cilium cilium/cilium <span class="nt">--version</span> 1.18.1 <span class="nt">--namespace</span> kube-system <span class="nt">--reuse-values</span> <span class="se">\</span>
  <span class="nt">--set</span> ciliumEndpointSlice.enabled<span class="o">=</span><span class="nb">true</span>

<span class="nv">$ </span>kubectl rollout restart <span class="nt">-n</span> kube-system deployment cilium-operator
<span class="c"># =&gt; deployment.apps/cilium-operator restarted</span>
<span class="nv">$ </span>kubectl rollout restart <span class="nt">-n</span> kube-system ds/cilium 
<span class="c"># =&gt; daemonset.apps/cilium restarted</span>

<span class="c"># Bactches CEPs into CiliumEndpointSlice CRDs : Significantly fewer watch events.</span>
<span class="nv">$ </span>kubectl get crd
<span class="c"># =&gt; NAME                                         CREATED AT</span>
<span class="c">#    ciliumcidrgroups.cilium.io                   2025-08-30T08:12:26Z</span>
<span class="c">#    ciliumclusterwidenetworkpolicies.cilium.io   2025-08-30T08:12:25Z</span>
<span class="c">#    ciliumendpoints.cilium.io                    2025-08-30T08:12:22Z</span>
<span class="c">#    &lt;span style="color: green;"&gt;ciliumendpointslices.cilium.io               2025-08-30T15:03:31Z&lt;/span&gt; # ì¶”ê°€ë¨</span>
<span class="c">#    ciliumidentities.cilium.io                   2025-08-30T08:12:20Z</span>
<span class="c">#    ...</span>
<span class="nv">$ </span>kubectl get ciliumendpointslices.cilium.io <span class="nt">-A</span> | <span class="nb">wc</span> <span class="nt">-l</span>
<span class="c"># =&gt; 4</span>
<span class="nv">$ </span>kubectl get ciliumendpointslices.cilium.io <span class="nt">-A</span>
<span class="c"># =&gt; NAME                  AGE</span>
<span class="c">#    ces-5vfjvlfnz-kt5mm   70s</span>
<span class="c">#    ces-ltcdg4zdx-zmfrl   70s</span>
<span class="c">#    ces-nzbjpdccd-bryjt   70s</span>
</code></pre></div></div>

<ul>
  <li>ì ìš© í›„ íš¨ê³¼ : 1000ê°œ ë…¸ë“œ ë“±ì´ ìˆì„ë•Œ API Latencyê°€ 87% ê°ì†Œí•˜ì˜€ìŠµë‹ˆë‹¤.</li>
</ul>

<p><img src="/assets/2025/cilium/w7/20250831_cilium_w7_32.png" alt="img.png" loading="lazy" width="1219" height="674"></p>

<h5 id="ebpf-host-routing--netkit---youtube--youtube2">eBPF Host Routing , Netkit - <a href="https://www.youtube.com/watch?v=yKPNmhckJHY">Youtube</a> , <a href="https://www.youtube.com/watch?v=cKPW67D7X10">Youtube</a>2</h5>

<ul>
  <li>ê¸°ì¡´ì— ë„¤íŠ¸ì›Œí¬ íŠ¸ë˜í”½ì´ íŒŒë“œì˜ ë„¤íŠ¸ì›Œí¬ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì—ì„œ í˜¸ìŠ¤íŠ¸ ë„¤íŠ¸ì›Œí¬ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¡œ ì´ë™í•  ë•Œ IP, netfilter, routing ë“±ì˜ IP ìŠ¤íƒì„ ê±¸ì³ì„œ veth í˜ì–´ë¥¼ í†µí•´ ì „ë‹¬ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ ê³¼ì •ì—ì„œ ingressì™€ egress íì— íŒ¨í‚·ì´ ëŒ€ê¸°í•˜ê²Œ ë˜ì–´ ì§€ì—°ì´ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
  <li>
<strong>eBPF Host Routing</strong> : bpf_redirect_peer í•¨ìˆ˜ë¥¼ í†µí•´ í˜¸ìŠ¤íŠ¸ NET NS ë„ì°© ì‹œ â†’ ë°”ë¡œ íŒŒë“œì˜ NET NS ë¡œ ì „ë‹¬í•˜ì—¬ ë¶ˆí•„ìš”í•œ IP ìŠ¤íƒì„ ê±°ì¹˜ì§€ ì•Šë„ë¡ í•˜ê³  ì„±ëŠ¥ì„ í–¥ìƒì‹œí‚µë‹ˆë‹¤. ë˜í•œ CPU íì‰ ê³¼ì •ì„ ê±°ì¹˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
<img src="/assets/2025/cilium/w7/20250831_cilium_w7_33.png" alt="img.png" class="image-center" loading="lazy" width="1177" height="662">
<em class="image-caption">ê¸°ì¡´ íŒŒë“œ ë„¤íŠ¸ì›Œí¬ vs veth + BPF host routing vs host (base)</em>
    <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="c">#</span>
<span class="nv">$ </span>kubectl <span class="nb">exec</span> <span class="nt">-it</span> <span class="nt">-n</span> kube-system ds/cilium <span class="nt">--</span> cilium status | <span class="nb">grep </span>Routing
<span class="c"># =&gt; KubeProxyReplacement:    True   [eth0    172.20.0.2 fc00:f853:ccd:e793::2 fe80::42:acff:fe14:2 (Direct Routing)]</span>
<span class="c">#    Routing:                 Network: Native   Host: BPF</span>
</code></pre></div>    </div>
    <ul>
      <li>eBPF Host Routing ë§Œìœ¼ë¡œëŠ” egressì‹œ í˜¸ìŠ¤íŠ¸ ë„¤íŠ¸ì›Œí¬ ìŠ¤íƒì„ ê±°ì¹˜ê¸° ë•Œë¬¸ì— ì™„ì „í•œ ì„±ëŠ¥ í–¥ìƒì„ ê¸°ëŒ€í•˜ê¸° ì–´ë µìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ ì•„ë˜ì˜ Netkit ë°©ì‹ì„ ì‚¬ìš©í•˜ë©´ ë” ì¢‹ì€ ì„±ëŠ¥ì„ ê¸°ëŒ€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
    </ul>
  </li>
  <li>
<strong>Netkit devices</strong> : veth ì™€ ìœ ì‚¬(ìŒ), ingress + egress í(CPU) ëŒ€ê¸° ì—†ì´ ëª¨ë‘ ë¹ ë¥´ê²Œ ì „ë‹¬ ê°€ëŠ¥.
<img src="/assets/2025/cilium/w7/20250831_cilium_w7_34.png" alt="img.png" class="image-center" loading="lazy" width="1229" height="619">
<em class="image-caption">eBPF Host Routingì— Netkitê¹Œì§€ ì‚¬ìš©í•˜ë©´ hostì™€ ê±°ì˜ ë™ì¼í•œ ì„±ëŠ¥ì„ ë°œíœ˜</em>
    <ul>
      <li>netkit ì„¤ì • ì‹œë„ : ì»¤ë„ 6.8 ì´ìƒ , eBPF host-routingì´ í•„ìš”í•©ë‹ˆë‹¤.
        <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code>  <span class="c">#</span>
  <span class="nv">$ </span>docker <span class="nb">exec</span> <span class="nt">-it</span> myk8s-control-plane <span class="nb">uname</span> <span class="nt">-r</span>
  <span class="c"># =&gt; 6.10.14-linuxkit</span>
      
  <span class="c">#</span>
  <span class="nv">$ </span>helm upgrade cilium cilium/cilium <span class="nt">--version</span> 1.18.1 <span class="nt">--namespace</span> kube-system <span class="nt">--reuse-values</span> <span class="se">\</span>
    <span class="nt">--set</span> bpf.datapathMode<span class="o">=</span>netkit
      
  <span class="nv">$ </span>kubectl rollout restart <span class="nt">-n</span> kube-system deployment cilium-operator
  <span class="nv">$ </span>kubectl rollout restart <span class="nt">-n</span> kube-system ds/cilium 
      
  <span class="c">#</span>
  <span class="nv">$ </span>kubectl logs <span class="nt">-n</span> kube-system cilium-k84hl
  <span class="c"># =&gt; time=2025-08-24T09:33:36.486143842Z level=fatal source=/go/src/github.com/cilium/cilium/pkg/logging/slog.go:159 </span>
  <span class="c">#    .. msg="netkit devices need kernel 6.7.0 or newer and CONFIG_NETKIT"</span>
      
  <span class="c">#</span>
  <span class="nv">$ </span>helm upgrade cilium cilium/cilium <span class="nt">--version</span> 1.18.1 <span class="nt">--namespace</span> kube-system <span class="nt">--reuse-values</span> <span class="se">\</span>
    <span class="nt">--set</span> bpf.datapathMode<span class="o">=</span>veth
      
  <span class="nv">$ </span>kubectl <span class="nb">exec</span> <span class="nt">-it</span> <span class="nt">-n</span> kube-system ds/cilium <span class="nt">--</span> cilium status | <span class="nb">grep</span> <span class="s1">'Device Mode'</span>
  <span class="c"># =&gt; Device Mode:             veth      </span>
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
</ul>

<h3 id="kubeshark">Kubeshark</h3>

<ul>
  <li>Kubernetes ë‚´ë¶€/ì™¸ë¶€ì˜ API í˜¸ì¶œ, ì´ë™ì¤‘ì¸ ë°ì´í„° ë“± ëª¨ë“  í†µì‹ ì„ ëª¨ë‹ˆí„°ë§í•˜ê³  ë¶„ì„í•  ìˆ˜ ìˆëŠ” ë„êµ¬ì…ë‹ˆë‹¤. - <a href="https://www.kubeshark.co/">Home</a>, <a href="https://docs.kubeshark.co/en/introduction">Docs</a>, <a href="https://www.kubeshark.co/blog">Blog</a>, <a href="https://demo.kubeshark.co/">demo</a>
<img src="/assets/2025/cilium/w7/20250831_cilium_w7_35.png" alt="img.png" loading="lazy" width="2048" height="1898">
<img src="/assets/2025/cilium/w7/20250831_cilium_w7_36.png" alt="img_1.png" loading="lazy" width="1275" height="700">
</li>
  <li>ì„¤ì¹˜ - <a href="https://docs.kubeshark.co/en/install">Docs</a>
</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># mac</span>
<span class="nv">$ </span>brew <span class="nb">install </span>kubeshark
<span class="c"># =&gt; ==&gt; Fetching downloads for: kubeshark</span>
<span class="c">#    ==&gt; Downloading https://ghcr.io/v2/homebrew/core/kubeshark/manifests/52.8.1</span>
<span class="c">#    ############################################################################################################################################################################ 100.0%</span>
<span class="c">#    ==&gt; Fetching kubeshark</span>
<span class="c">#    ==&gt; Downloading https://ghcr.io/v2/homebrew/core/kubeshark/blobs/sha256:d65e38045ff18f7fc6fc83df77cc9da945ec7e99033d43f91994f0768c2c2e99</span>
<span class="c">#    ############################################################################################################################################################################ 100.0%</span>
<span class="c">#    ==&gt; Pouring kubeshark--52.8.1.arm64_sequoia.bottle.tar.gz</span>
<span class="c">#    ğŸº  /opt/homebrew/Cellar/kubeshark/52.8.1: 9 files, 65MB</span>
<span class="c">#    ==&gt; Running `brew cleanup kubeshark`...</span>

<span class="c"># í™•ì¸</span>
<span class="nv">$ </span>kubeshark version
<span class="c"># =&gt; v52.8.1</span>

<span class="nv">$ </span>kubeshark <span class="nt">-h</span>
<span class="c"># =&gt; Available Commands:</span>
<span class="c">#      clean       Removes all Kubeshark resources</span>
<span class="c">#      completion  Generate the autocompletion script for the specified shell</span>
<span class="c">#      config      Generate Kubeshark config with default values</span>
<span class="c">#      console     Stream the scripting console logs into shell</span>
<span class="c">#      help        Help about any command</span>
<span class="c">#      license     Print the license loaded string</span>
<span class="c">#      logs        Create a ZIP file with logs for GitHub issues or troubleshooting</span>
<span class="c">#      pcapdump    Store all captured traffic (including decrypted TLS) in a PCAP file.</span>
<span class="c">#      pprof       Select a Kubeshark container and open the pprof web UI in the browser</span>
<span class="c">#      proxy       Open the web UI (front-end) in the browser via proxy/port-forward</span>
<span class="c">#      scripts     Watch the `scripting.source` and/or `scripting.sources` folders for changes and update the scripts</span>
<span class="c">#      tap         Capture the network traffic in your Kubernetes cluster</span>
<span class="c">#      version     Print version info</span>
 
<span class="c"># Capture the network traffic in your Kubernetes cluster</span>
<span class="nv">$ </span>kubeshark tap
<span class="c"># =&gt; 2025-08-31T00:37:22+09:00 INF tapRunner.go:47 &gt; Using Docker: registry=docker.io/kubeshark tag=</span>
<span class="c">#    2025-08-31T00:37:22+09:00 INF tapRunner.go:51 &gt; Kubeshark will store the traffic up to a limit (per node). Oldest TCP/UDP streams will be removed once the limit is reached. limit=5Gi</span>
<span class="c">#    2025-08-31T00:37:22+09:00 INF versionCheck.go:23 &gt; Checking for a newer version...</span>
<span class="c">#    2025-08-31T00:37:22+09:00 INF common.go:69 &gt; Using kubeconfig: path=/Users/anonym/.kube/config</span>
<span class="c">#    2025-08-31T00:37:22+09:00 INF tapRunner.go:67 &gt; Telemetry enabled=true notice="Telemetry can be disabled by setting the flag: --telemetry-enabled=false"</span>
<span class="c">#    2025-08-31T00:37:22+09:00 INF tapRunner.go:69 &gt; Targeting pods in: namespaces=["cilium-monitoring","cilium-secrets","default","kube-node-lease","kube-public","kube-system","local-path-storage"]</span>
<span class="c">#    2025-08-31T00:37:22+09:00 INF tapRunner.go:136 &gt; Targeted pod: grafana-5c69859d9-x2r9v</span>
<span class="c">#    2025-08-31T00:37:22+09:00 INF tapRunner.go:136 &gt; Targeted pod: prometheus-6fc896bc5d-zwlkf</span>
<span class="c">#    2025-08-31T00:37:22+09:00 INF tapRunner.go:136 &gt; Targeted pod: cilium-9qfx8</span>
<span class="c">#    2025-08-31T00:37:22+09:00 INF tapRunner.go:136 &gt; Targeted pod: cilium-envoy-bwd6b</span>
<span class="c">#    2025-08-31T00:37:22+09:00 INF tapRunner.go:136 &gt; Targeted pod: cilium-operator-6d667fff-krg69</span>
<span class="c">#    2025-08-31T00:37:22+09:00 INF tapRunner.go:136 &gt; Targeted pod: coredns-674b8bbfcf-dt7dv</span>
<span class="c">#    2025-08-31T00:37:22+09:00 INF tapRunner.go:136 &gt; Targeted pod: coredns-674b8bbfcf-khb4w</span>
<span class="c">#    2025-08-31T00:37:22+09:00 INF tapRunner.go:136 &gt; Targeted pod: etcd-myk8s-control-plane</span>
<span class="c">#    2025-08-31T00:37:22+09:00 INF tapRunner.go:136 &gt; Targeted pod: hubble-relay-fdd49b976-8mcq9</span>
<span class="c">#    2025-08-31T00:37:22+09:00 INF tapRunner.go:136 &gt; Targeted pod: hubble-ui-655f947f96-ccbxk</span>
<span class="c">#    2025-08-31T00:37:22+09:00 INF tapRunner.go:136 &gt; Targeted pod: kube-apiserver-myk8s-control-plane</span>
<span class="c">#    2025-08-31T00:37:22+09:00 INF tapRunner.go:136 &gt; Targeted pod: kube-controller-manager-myk8s-control-plane</span>
<span class="c">#    2025-08-31T00:37:22+09:00 INF tapRunner.go:136 &gt; Targeted pod: kube-scheduler-myk8s-control-plane</span>
<span class="c">#    2025-08-31T00:37:22+09:00 INF tapRunner.go:136 &gt; Targeted pod: metrics-server-5dd7b49d79-gx8jd</span>
<span class="c">#    2025-08-31T00:37:22+09:00 INF tapRunner.go:136 &gt; Targeted pod: local-path-provisioner-7dc846544d-phnjz</span>
<span class="c">#    2025-08-31T00:37:22+09:00 INF tapRunner.go:79 &gt; Waiting for the creation of Kubeshark resources...</span>
<span class="c">#    2025-08-31T00:37:24+09:00 INF helm.go:128 &gt; Downloading Helm chart: repo-path=/Users/anonym/Library/Caches/helm/repository url=https://github.com/kubeshark/kubeshark.github.io/releases/download/kubeshark-52.8.1/kubeshark-52.8.1.tgz</span>
<span class="c">#    2025-08-31T00:37:25+09:00 INF helm.go:147 &gt; Installing using Helm: kube-version="&gt;= 1.16.0-0" release=kubeshark source=["https://github.com/kubeshark/kubeshark/tree/master/helm-chart"] version=52.8.1</span>
<span class="c">#    2025-08-31T00:37:25+09:00 INF helm.go:61 &gt; creating 21 resource(s)</span>
<span class="c">#    2025-08-31T00:37:26+09:00 INF tapRunner.go:96 &gt; Installed the Helm release: kubeshark</span>
<span class="c">#    2025-08-31T00:37:26+09:00 INF tapRunner.go:258 &gt; Added: pod=kubeshark-front</span>
<span class="c">#    2025-08-31T00:37:26+09:00 INF tapRunner.go:167 &gt; Added: pod=kubeshark-hub</span>
<span class="c">#    2025-08-31T00:37:52+09:00 INF tapRunner.go:192 &gt; Ready. pod=kubeshark-hub</span>
<span class="c">#    2025-08-31T00:38:08+09:00 INF tapRunner.go:282 &gt; Ready. pod=kubeshark-front</span>
<span class="c">#    2025-08-31T00:38:08+09:00 INF proxy.go:31 &gt; Starting proxy... namespace=default proxy-host=127.0.0.1 service=kubeshark-front src-port=8899</span>
<span class="c">#    2025-08-31T00:38:13+09:00 INF tapRunner.go:417 &gt; Kubeshark is available at: url=&lt;span style="color: green;"&gt;http://127.0.0.1:8899&lt;/span&gt; # ğŸ‘ˆ Web UI </span>
<span class="c">#    2025-08-31T00:38:13+09:00 INF console.go:45 &gt; Starting scripting console ...</span>
<span class="c">#    E0831 00:38:15.481130    2419 proxy_server.go:147] Error while proxying request: error dialing backend: context canceled</span>
<span class="c">#    2025-08-31T00:38:18+09:00 INF console.go:61 &gt; Connecting to: host=127.0.0.1 url=http://127.0.0.1:8899/api</span>
</code></pre></div></div>

<p><img src="/assets/2025/cilium/w7/20250831_cilium_w7_37.png" alt="img.png" class="image-center" loading="lazy" width="1392" height="1122">
<em class="image-caption">API Flow ë·°</em>
<img src="/assets/2025/cilium/w7/20250831_cilium_w7_38.png" alt="img.png" class="image-center" loading="lazy" width="1392" height="1122">
<em class="image-caption">Service Map ë·°</em></p>

<ul>
  <li>ë¬´ë£Œ ë²„ì „ì—ì„œëŠ” 3ê°œ ë…¸ë“œ, 60ê°œ íŒŒë“œì˜ ì œí•œì´ ìˆì–´ì„œ ê°„ë‹¨í•œ í…ŒìŠ¤íŠ¸ë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.</li>
  <li>(ì˜µì…˜) íì‡„ë§ Air-Gapped í™˜ê²½ : Enterprise Tier(Plan)ì—ì„œë§Œ ê°€ëŠ¥ - <a href="https://www.kubeshark.co/pricing">Docs</a>
    <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="c"># Make sure to disable internet connectivity:</span>
<span class="nv">$ </span>internetConnectivity: <span class="nb">false</span>
</code></pre></div>    </div>
  </li>
  <li>(ì°¸ê³ ) ì‚­ì œ
    <div class="language-bash highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="c"># cleanup  </span>
<span class="nv">$ </span>kubeshark clean  
</code></pre></div>    </div>
  </li>
</ul>

<hr>

<h2 id="ë§ˆì¹˜ë©°">ë§ˆì¹˜ë©°</h2>

<p>ì´ë²ˆ í¬ìŠ¤íŠ¸ì—ì„œëŠ” Kubernetesì˜ ì„±ëŠ¥ ì¸¡ì • ë° ëª¨ë‹ˆí„°ë§ ë°©ë²•ê³¼ íŠœë‹ë°©ë²•, Ciliumì˜ ì„±ëŠ¥ ì¸¡ì • ë° íŠœë‹ ë°©ë²•ì— ëŒ€í•´ì„œ ì•Œì•„ë³´ì•˜ìŠµë‹ˆë‹¤. 
ì‘ì€ ê·œëª¨ì˜ í´ëŸ¬ìŠ¤í„°ë§Œ ì‚¬ìš©í•´ì„œ ê°„ê³¼í•˜ê³  ìˆì—ˆëŠ”ë°, ê·œëª¨ê°€ ì»¤ì§€ë©´ ë‹¤ì–‘í•œ ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆìŒì„ ì•Œê²Œ ë˜ì–´ ìœ ìµí•œ ì‹œê°„ì´ì—ˆìŠµë‹ˆë‹¤.
ì •ë§ ë°°ìš°ê³  ìµí˜€ì•¼ í•˜ëŠ”ê²ƒì´ ëì´ ì—†ë‹¤ëŠ” ìƒê°ì´ ë“­ë‹ˆë‹¤. <img class="emoji" title=":sweat_smile:" alt=":sweat_smile:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f605.png" height="20" width="20" loading="lazy"></p>

<p>ëª¨ë“ ê²ƒì„ ë‹¤ ì•Œ ìˆ˜ëŠ” ì—†ì§€ë§Œ, ìŠ¤í„°ë””ë¥¼ í†µí•´ ë§ì€ ê²ƒì„ ì•Œê²Œë˜ê³  ê²½í—˜í•˜ê²Œ ë˜ì–´ ë„ˆë¬´ ì¢‹ìŠµë‹ˆë‹¤.
ê¸°ì¡´ ìŠ¤í„°ë””ë„ ë¸”ë¡œê·¸ë¡œ ì •ë¦¬í•œ ê¸€ì„ ì‹¤ë¬´ì—ì„œ ì˜ í™œìš©í•˜ê³  ìˆëŠ”ë°,
ì´ë²ˆ ìŠ¤í„°ë””ë„ í° ë„ì›€ì´ ë ê²ƒ ê°™ìŠµë‹ˆë‹¤.
ìŠ¤í„°ë””ë¥¼ ì§„í–‰í•´ì£¼ì‹œëŠ” ê°€ì‹œë‹¤ ë‹˜ê»˜ ë‹¤ì‹œ í•œë²ˆ ê°ì‚¬ë“œë¦½ë‹ˆë‹¤. <img class="emoji" title=":bow:" alt=":bow:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f647.png" height="20" width="20" loading="lazy"></p>

  </div>

  <div id="toc-minimap" class="toc-minimap collapsed">
    <ul id="toc" class="section-nav">
<li class="toc-entry toc-h2"><a href="#%EB%93%A4%EC%96%B4%EA%B0%80%EB%A9%B0">ë“¤ì–´ê°€ë©°</a></li>
<li class="toc-entry toc-h2">
<a href="#k8s-performance">K8S Performance</a>
<ul>
<li class="toc-entry toc-h3"><a href="#%EC%8B%A4%EC%8A%B5-%ED%99%98%EA%B2%BD-%EA%B5%AC%EC%84%B1">ì‹¤ìŠµ í™˜ê²½ êµ¬ì„±</a></li>
<li class="toc-entry toc-h3"><a href="#%EC%8B%A4%EC%8A%B5%ED%99%98%EA%B2%BD-%EB%B0%B0%ED%8F%AC">ì‹¤ìŠµí™˜ê²½ ë°°í¬</a></li>
<li class="toc-entry toc-h3">
<a href="#kube-burner">Kube-burner</a>
<ul>
<li class="toc-entry toc-h4"><a href="#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-1--%EB%94%94%ED%94%8C%EB%A1%9C%EC%9D%B4%EB%A8%BC%ED%8A%B8-1%EA%B0%9C%ED%8C%8C%EB%93%9C-1%EA%B0%9C-%EC%83%9D%EC%84%B1--%EC%82%AD%EC%A0%9C-jobiterations-qps-burst-%EC%9D%98%EB%AF%B8-%ED%99%95%EC%9D%B8">ì‹œë‚˜ë¦¬ì˜¤ 1 : ë””í”Œë¡œì´ë¨¼íŠ¸ 1ê°œ(íŒŒë“œ 1ê°œ) ìƒì„± â†’ ì‚­ì œ, jobIterations qps burst ì˜ë¯¸ í™•ì¸</a></li>
<li class="toc-entry toc-h4"><a href="#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-2--%EB%85%B8%EB%93%9C-1%EB%8C%80%EC%97%90-%EC%B5%9C%EB%8C%80-%ED%8C%8C%EB%93%9C150%EA%B0%9C-%EB%B0%B0%ED%8F%AC-%EC%8B%9C%EB%8F%84-1">ì‹œë‚˜ë¦¬ì˜¤ 2 : ë…¸ë“œ 1ëŒ€ì— ìµœëŒ€ íŒŒë“œ(150ê°œ) ë°°í¬ ì‹œë„ 1</a></li>
<li class="toc-entry toc-h4"><a href="#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-3--%EB%85%B8%EB%93%9C-1%EB%8C%80%EC%97%90-%EC%B5%9C%EB%8C%80-%ED%8C%8C%EB%93%9C300%EA%B0%9C-%EB%B0%B0%ED%8F%AC-%EC%8B%9C%EB%8F%84-2">ì‹œë‚˜ë¦¬ì˜¤ 3 : ë…¸ë“œ 1ëŒ€ì— ìµœëŒ€ íŒŒë“œ(300ê°œ) ë°°í¬ ì‹œë„ 2</a></li>
</ul>
</li>
<li class="toc-entry toc-h3">
<a href="#k8s-performance--tuning">K8S Performance &amp; Tuning</a>
<ul>
<li class="toc-entry toc-h4"><a href="#%EB%8C%80%EA%B7%9C%EB%AA%A8-%ED%81%B4%EB%9F%AC%EC%8A%A4%ED%84%B0-%EA%B3%A0%EB%A0%A4%EC%82%AC%ED%95%AD">ëŒ€ê·œëª¨ í´ëŸ¬ìŠ¤í„° ê³ ë ¤ì‚¬í•­</a></li>
<li class="toc-entry toc-h4"><a href="#%EC%8B%9C%EB%82%98%EB%A6%AC%EC%98%A4-4-api-intensive---%ED%8C%8C%EB%93%9C%EB%A5%BC-%EC%83%9D%EC%84%B1configmap-secret-%ED%9B%84-%EC%82%AD%EC%A0%9C">ì‹œë‚˜ë¦¬ì˜¤ 4. api-intensive - íŒŒë“œë¥¼ ìƒì„±(configmap, secret) í›„ ì‚­ì œ</a></li>
<li class="toc-entry toc-h4"><a href="#kubernetes-api-%EC%84%B1%EB%8A%A5-%EB%A9%94%ED%8A%B8%EB%A6%AD--%EC%98%88%EC%A0%9C%EC%99%80-best-practice---blog">Kubernetes API ì„±ëŠ¥ ë©”íŠ¸ë¦­ : ì˜ˆì œì™€ Best Practice - Blog</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-entry toc-h2">
<a href="#cilium-performance">Cilium Performance</a>
<ul>
<li class="toc-entry toc-h3"><a href="#%EC%8B%A4%EC%8A%B5%ED%99%98%EA%B2%BD-%EC%A4%80%EB%B9%84">ì‹¤ìŠµí™˜ê²½ ì¤€ë¹„</a></li>
<li class="toc-entry toc-h3"><a href="#%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4-%ED%99%98%EA%B2%BD%EC%97%90%EC%84%9C-%EC%86%8D%EB%8F%84-%EC%B8%A1%EC%A0%95-%ED%85%8C%EC%8A%A4%ED%8A%B8">ì¿ ë²„ë„¤í‹°ìŠ¤ í™˜ê²½ì—ì„œ ì†ë„ ì¸¡ì • í…ŒìŠ¤íŠ¸</a></li>
<li class="toc-entry toc-h3"><a href="#cilium-%EC%A0%91%EC%86%8D-%EB%B0%8F-%EC%84%B1%EB%8A%A5-%ED%85%8C%EC%8A%A4%ED%8A%B8">Cilium ì ‘ì† ë° ì„±ëŠ¥ í…ŒìŠ¤íŠ¸</a></li>
<li class="toc-entry toc-h3">
<a href="#cilium-performance--tuning">Cilium Performance &amp; Tuning</a>
<ul>
<li class="toc-entry toc-h4"><a href="#deep-dive-into-cilium-resilient-architecture--apievent-%EC%99%80-cilium-agentstatedb-%EC%99%80-bpf-%EB%8F%99%EC%9E%91">Deep Dive Into Cilium Resilient Architecture : API(Event) ì™€ Cilium-Agent(StateDB) ì™€ BPF ë™ì‘</a></li>
</ul>
</li>
<li class="toc-entry toc-h3"><a href="#kubernetes-perf-tests">Kubernetes perf-tests</a></li>
<li class="toc-entry toc-h3"><a href="#cilium-tuning-guide">Cilium Tuning Guide</a></li>
<li class="toc-entry toc-h3"><a href="#kubeshark">Kubeshark</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#%EB%A7%88%EC%B9%98%EB%A9%B0">ë§ˆì¹˜ë©°</a></li>
</ul>
  </div>
<a class="u-url" href="/posts/2025-08-31-Cilium-Week7/" hidden></a>
</article>



<div class="PageNavigation">
  
  <a class="prev" href="/posts/2025-08-24-Cilium-Week6/">Â« [Cilium] Cilium ServiceMesh</a>
  
  
  <a class="next" href="/posts/2025-09-07-Cilium-Week8/">[Cilium] Cilium Security &amp; Tetragon Â»</a>
  
</div>

<div id="disqus_thread"></div>
<script>
var disqus_config = function () {
this.page.url = "https://sweetlittlebird.github.io/posts/2025-08-31-Cilium-Week7/";
this.page.identifier = "/posts/Cilium - Week7";
};
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
      </div>

<!--      <div class="adsbygoogle-side">-->
<!--        &lt;!&ndash; ad_side &ndash;&gt;-->
<!--        <ins class="adsbygoogle "-->
<!--             style="display: block"-->
<!--             data-ad-client="ca-pub-6564723532026864"-->
<!--             data-ad-slot="1339398797"-->
<!--             data-ad-format="auto"-->
<!--             data-full-width-responsive="true"></ins>-->
<!--      </div>-->
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Sweet Little Bird</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Sweet Little Bird</li>
</ul>
      </div>

      <div class="footer-col footer-col-2">
<ul class="social-media-list"><li><a href="https://github.com/sweetlittlebird"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">sweetlittlebird</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>ê³µë¶€ ê¸°ë¡ê³¼ ê°œë°œ ì´ì•¼ê¸°ë¥¼ ë‹´ì€ ë¸”ë¡œê·¸ì…ë‹ˆë‹¤.</p>
      </div>
    </div>

  </div>

</footer>
<!-- Root element of PhotoSwipe. Must have class pswp. -->
    <div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
      <!-- Background of PhotoSwipe. 
           It's a separate element as animating opacity is faster than rgba(). -->
      <div class="pswp__bg"></div>
      <!-- Slides wrapper with overflow:hidden. -->
      <div class="pswp__scroll-wrap">
        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
          <div class="pswp__item"></div>
          <div class="pswp__item"></div>
          <div class="pswp__item"></div>
        </div>
        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
          <div class="pswp__top-bar">
            <!--  Controls are self-explanatory. Order can be changed. -->
            <div class="pswp__counter"></div>
            <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
            <button class="pswp__button pswp__button--share" title="Share"></button>
            <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
            <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
            <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
            <!-- element will get class pswp__preloader--active when preloader is running -->
            <div class="pswp__preloader">
              <div class="pswp__preloader__icn">
                <div class="pswp__preloader__cut">
                  <div class="pswp__preloader__donut"></div>
                </div>
              </div>
            </div>
          </div>
          <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
            <div class="pswp__share-tooltip"></div>
          </div>
          <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
          </button>
          <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
          </button>
          <div class="pswp__caption">
            <div class="pswp__caption__center"></div>
          </div>
        </div>
      </div>
    </div>

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-EWGY9N8QXY"></script>

    
    <script async src="/assets/dist/app.min.js"></script>
    
  
    <a href="#" id="back-to-top"><span>Back to Top</span></a>

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6564723532026864" crossorigin="anonymous"></script>
    <!--<script>
    (adsbygoogle = window.adsbygoogle || []).push({});
    </script>-->
  </body>

</html>
